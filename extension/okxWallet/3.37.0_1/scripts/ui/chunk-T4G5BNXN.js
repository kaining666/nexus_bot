import{a as cc}from"./chunk-Y4W36EYJ.js";import{h as wo}from"./chunk-4FP4CS66.js";import{a as qt}from"./chunk-N5PE2NEH.js";import{a as fa,b as G}from"./chunk-JJBV375X.js";import{A as Qs,C as Xa,L as br,M as tc,a as v,b as A,c as bo,d as at,e as Fa,j as Ae,k as Ua,l as ct,n as qa,o as Va,p as Wa,r as Qa,s as Rr,u as Ha,v as ja,w as Ut,x as Ka,y as Ya,z as $a}from"./chunk-6G5SGP4W.js";import{a as Na,b as Gs,c as re,f as ec,i as vo,j as Lo,n as vr,o as Lr,p as wr,s as Or,t as se}from"./chunk-2NRFLUUO.js";import{a as ka,b as yr,c as $,d as Tt,e as C,g as xa,h as so,i as Da,j as Ma,l as za,m as Ja,n as Za}from"./chunk-SAG4ZEZI.js";import{a as to,b as mt,c as gt,d as ha}from"./chunk-E4DPTHXM.js";import{a as Ga}from"./chunk-BGYKLFZE.js";import{b as W}from"./chunk-WAUW7WG4.js";import{a as Ar}from"./chunk-OG5JWNZH.js";import{a as D,b as jt,c as ya,e as no}from"./chunk-PF2X6IYY.js";import{D as ba,E as va,F as ro,K as Er,M as La,N as wa,O as Oa,P as Pa,a as _a,h as Ws,k as kr,l as Ea,o as oo,p as _r,q as Ra}from"./chunk-67OZVYSW.js";import{a as oc,b as Pr,c as rc,d as sc,e as nc,f as xr,g as ic,h as ac}from"./chunk-5J5TSFC4.js";import{a as B,b as Zn,c as st}from"./chunk-Z6RMGQXT.js";import{a as Ca,e as Aa}from"./chunk-BLEQOMHN.js";import{a as Kt,b as eo,d as ga,e as Bt,h as Sa,i as Ta,k as H,l as Ia,n as Vs}from"./chunk-SEXC6U4O.js";import{a as pa,b as f,d as Ba}from"./chunk-IV5YQZMD.js";import{a as Xn,b as zt,c as So,d as zn,e as ht,f as Et,g as Jt,h as Jn,i as q,j as Rt,k as L,l as rt}from"./chunk-BNWEXJ7R.js";import{a as I,b as qs,c as oe,d as St,f as Z,g as Ce}from"./chunk-RCQMEJEP.js";import{$ as z,$b as Fi,A as ar,B as ii,Cb as Us,Cc as na,D as U,Db as Ti,Dc as ia,E as je,Eb as gr,F as Ke,Fb as Ii,G as ai,Ga as pi,Gb as Ci,Gc as aa,H as Ye,Hb as Ai,Hc as ca,I as ge,Ib as yi,Ic as ua,J as ws,Ja as Ms,Jb as ki,Jc as la,K as yo,Ka as Fs,Kb as _i,Kc as da,L as ci,La as hi,Lb as Ei,Lc as ma,M as Se,Ma as yt,Mb as Sr,Na as J,Nb as Ri,Ob as bi,P as X,Pb as vi,Q as Mt,Qb as Li,R as Ht,Rb as wi,S as Zt,Sb as Oi,T as $e,Tb as Pi,U as cr,Ub as Tr,V as bt,W as ur,Wa as Ro,Wb as xi,X as ui,Xa as V,Xb as Ni,Ya as k,Yb as Di,_ as Os,_a as fi,_b as Mi,a as or,aa as vt,ac as Bi,b as rr,ba as li,bc as Ir,c as To,cc as Ui,d as Io,da as Ps,dc as qi,e as sr,ea as lr,ec as Vi,f as Co,fa as dr,fb as kt,fc as Wi,g as Ls,ga as ko,gb as ft,gc as Gi,h as nr,hb as te,hc as Qi,i as He,ib as Bs,ic as Hi,j as ti,jb as gi,jc as ji,k as Ao,kb as Si,kc as Cr,l as ei,lc as Ki,mc as Yi,nc as $i,o as dt,oa as et,ob as fr,oc as Xi,p as nt,pa as Pt,pb as E,pc as zi,q as it,qa as Xe,qc as Ji,rb as ee,s as oi,sa as xs,sc as Zi,t as ri,ta as _o,tc as ta,u as Q,v as ir,va as Ns,w as si,wa as Ds,wc as ea,x as ni,xa as di,xc as oa,ya as mi,yc as ra,zc as sa}from"./chunk-WTBIP24L.js";import{a as Te,b as Eo,c as Ft,d as ze,e as Ie,f as Je,g as mr,h as pr,i as hr,j as Ze,k as b}from"./chunk-HWYDZOOB.js";import{a as Sl}from"./chunk-MDLQ46WE.js";import{a as Ot}from"./chunk-F7IOPQEO.js";import{F as $n,G as Qt,H as N,k as Yn}from"./chunk-PLHFXPVU.js";import{A as On,B as tr,D as Pn,F as Y,I as xn,J as me,K as go,N as Nn,Q as _s,S as Dn,T as Mn,V as Fn,Y as pe,aa as Bn,c as tt,f as vn,ga as he,h as wt,ha as Es,i as $t,ia as Un,j as S,ka as Xt,la as Rs,ma as bs,oa as qn,p as Ln,pa as P,r as Qe,u as wn,v as fo,x as Jo,y as Zo}from"./chunk-5BQQ5BTM.js";import{A as Gn,D as _,F as Qn,J as Hn,K as jn,L as er,N as F,a as Vn,f as Wn,l as Gt,z as vs}from"./chunk-4IQZG47E.js";import{ca as fe,d as Kn}from"./chunk-X62Q7VCJ.js";import{a as x}from"./chunk-WQYVBC56.js";import{f as R,h as s,m as u,o as l}from"./chunk-CS4SUKWE.js";u();l();var Ge=R(x()),gl=R(Ot());u();l();var lc=R(x());u();l();var Nr=R(x());var uc=({children:a,rootStore:t})=>{let e=Zn(t),o=(0,Nr.useMemo)(()=>(t.commonStore.rootStore=t,t.accountStore.rootStore=t,t),[t]);return Nr.default.createElement(e.Provider,{value:o},a)};var dc=rt(({swapRootStore:a,bridgeRootStore:t,children:e,initTab:o})=>{let{commonStore:{currentTab:r}}=a.getInstance(),n=o||r,i=a.getInstance();return n===E.BRIDGE&&(i=t.getInstance()),lc.default.createElement(uc,{rootStore:i},e)});u();l();var mc=R(x());F();function Dr({children:a,...t}){return mc.default.createElement(Gn,{fetchConfig:pa.fetchConfig,...t},a)}u();l();u();l();u();l();u();l();var Gr=R(x());u();l();var Fr=R(x());u();l();var Mr=R(Sl());async function Tl(a,t){let{devid:e}=await a.get("devid");return(o,r)=>{Mr.setDeviceId(e);let n=Mr.newInstance({site:"okex",product:o});return n.setApiEndpoint(`${t}/amplitude`),n.setCommonParams(yr()),r(n),n}}async function Hs(a,t){(await Tl(a,t))("web3_trade",_a)}var Il=()=>{let[a,t]=(0,Fr.useState)(!1);return(0,Fr.useEffect)(()=>{let{getApiHostname:e}=b.global;Hs(b.localStore,e()).then(()=>t(!0)).catch(()=>{})},[]),{initialized:a}},Br=Il;u();l();u();l();var Oo=R(x());var pc=a=>{let{params:t,replace:e}=so(),{autoSwitch:o,from:r}=t,[n,i]=(0,Oo.useState)(""),[c,d]=(0,Oo.useState)(!0),m=D.get(pi)||to;return o===Gs.BRIDGE&&!r.tokenContractAddress&&e({pathname:m,params:{...t,autoSwitch:void 0}}),(0,Oo.useEffect)(()=>{a&&(async()=>{if(a===E.SWAP&&o===Gs.BRIDGE){let g=await re.judgeTabTypeByParams(t?.from,t?.to);g===E.BRIDGE&&e({pathname:gt,params:{...t,autoSwitch:void 0}}),i(g),d(!1)}else i(a),d(!1)})().catch(()=>{})},[a]),{tabType:n,autoSwitching:c}};u();l();var Ur=R(x()),hc=R(Ot());var fc=()=>{let{pathname:a}=(0,hc.useLocation)(),[t,e]=(0,Ur.useState)("");return(0,Ur.useEffect)(()=>{switch(a){case to:case mt:e(E.SWAP);break;case gt:e(E.BRIDGE);break;default:break}},[a]),t};u();l();var js=R(x());var gc=(a,t)=>{let{accountStore:e}=st(),{params:o}=so(),{btcAddressType:r}=o;(0,js.useEffect)(()=>{e.setBtcAddressType(r)},[]);let n=Da();(0,js.useEffect)(()=>{async function i(){let c=new re(a,o),{from:d,to:m,tab:p,inputAmount:g,error:T}=await c.initTokenPair(t);T||n(d,m,g,p)}a&&i().catch(()=>{})},[a])};u();l();var Sc=R(x()),Tc=R(Ot());var Ic=a=>{let{fromToStore:t}=st(),{from:e,to:o}=t,{params:r,replace:n}=so(),{pathname:i}=(0,Tc.useLocation)(),c=Ma();(0,Sc.useEffect)(()=>{let d=c(e,o);d&&a&&[mt,gt].includes(i)&&(new re(a).writeTabInfoToLocalStorage(d),n({params:{...d,feeConfig:r.feeConfig}}))},[e?.chainId,e?.tokenContractAddress,o?.chainId,o?.tokenContractAddress,a,i])};var Cl=a=>{let t=fc(),{tabType:e}=pc(t);gc(e,a),Ic(e)},Cc=Cl;u();l();var yc=R(x());u();l();function Al(a){return new Promise(t=>setTimeout(t,a))}async function io(a,t=3,e=0){let o;for(let r=0;r<t;r++)try{return await a()}catch(n){o=n,e&&r<t-1&&await Al(e)}throw o}function yl(a,t,e){let o=$();return{promise:a(t,{...e,signal:o.signal}),cancel:()=>o.abort()}}function kl(a,t,e){if(J())return yl(a,t,e);let o=new AbortController,r=o.signal;return{promise:a(t,{...e,signal:r}),cancel:()=>o.abort()}}function Ac(a,t){return kl(C.get,a,t)}function kc(){let{accountStore:a,receiveAddressStore:t}=st(),{address:e,setUserForbiddenBridge:o}=a,{receiveAddrObj:r,computedSwapHighLight:n}=t,{specifiedAddress:i}=r||{};(0,yc.useEffect)(()=>{let c=()=>{};if(e&&n){let{promise:d,cancel:m}=Ac(Ji,{params:{userWalletAddress:e,receiveWalletAddress:i}});c=m,d.then(p=>{o(p?.data.blackListTypes||Se)}).catch(()=>{o(Se)})}else o(Se);return c},[e,o,i,n])}u();l();var _c=R(x());function Ks(){let{accountStore:{address:a}}=st();(0,_c.useEffect)(()=>{A.setTags({address:a})},[a])}u();l();var Ec=R(x());var _l=()=>{let{accountStore:a,fromToStore:t,approveStore:e,recentTransactionStore:o,tokenModalStore:r}=st();(0,Ec.useEffect)(()=>{let{computedAccountWalletAddresses:n}=a;return n&&(at.addListen("error",()=>{e.onSocketError(),o.onSocketError(),t.setNeedBalanceLoading(!1),t.getSwapTokenBalance(),r.reloadTokenList()}),at.addListen(bo.DEX_PUSH_ENGINE,i=>{o.onSocket(i),e.onSocket(i)}),at.addListen(bo.WALLET_ASSET,i=>{i&&(r.updateAllTokenList(i),t.updateFromBalancePush(i))}),at.init(n)),()=>{at.removeAll(),at.wsInstance&&n&&at.logout(n)}},[a.computedAccountWalletAddresses,o.onSocket,r.updateAllTokenList,t.updateFromBalancePush,a,o,r])},Rc=_l;u();l();var ne=R(x()),bc=R(Ot());var El=({currency:a,currentWallet:t,walletInfo:e,keyringIdentityTypeEnum:o,addressBookList:r,walletList:n,t:i,dispatch:c,currentTab:d,onBack:m})=>{let{commonStore:p,accountStore:g,recentTransactionStore:T,reset:y}=st(),w=(0,bc.useHistory)();(0,ne.useEffect)(()=>{b.setRuntimeContext({history:w,toLocale:i,dispatch:c,walletInfo:e,onBack:m})},[i,w,c,e,m]),(0,ne.useEffect)(()=>{t&&g.setWalletConfig(t)},[t]),(0,ne.useEffect)(()=>(p.getUserUnit(a),p.fetchChainList({businessLine:1,currentTab:d}).catch(()=>{p.setChainListLoadError(!0)}),()=>{y()}),[]),(0,ne.useEffect)(()=>{g.setAddressBookList(r)},[r]),(0,ne.useEffect)(()=>{g.setWalletList(n)},[n]),(0,ne.useEffect)(()=>{g.setKeyringIdentityTypeEnum(o)},[o]),(0,ne.useEffect)(()=>{t.walletId?T.updatePendingOrders(t.walletId):T.setPendingOrders([])},[t.walletId,d]),Fa()},vc=El;u();l();var pt=R(x()),ie=R(Ot());u();l();var ao=R(x()),Wr=R(Ot()),Wc=R(Ba());u();l();var wc=R(x());u();l();var Lc=R(x());var Rl=({visible:a,onBack:t=()=>{},params:e})=>{let{useCoin:o}=b.hooks,{coinId:r,receiveOnly:n,chainId:i,tokenContractAddress:c}=e,d=o(i,c);return a&&Lc.default.createElement(b.components.SupplyGas,{visible:a,closeCallback:t,coinId:r||d?.coinId,receiveOnly:n})},qr=Rl;var bl=()=>{let{fromToStore:a}=st(),{visibleAddFunds:t,addFundsParams:e,closeAddFunds:o}=a;return wc.default.createElement(qr,{visible:t,params:e,onBack:()=>{o()}})},Oc=rt(bl);u();l();var Pc=R(x());var xc=()=>{let{fromToStore:a}=st(),{closeAddFunds:t}=a;(0,Pc.useEffect)(()=>{t()},[])};u();l();var Nc=R(x());u();l();var Vt={wrapper:"_wrapper_1bvuq_1","extension-container":"_extension-container_1bvuq_5",extensionContainer:"_extension-container_1bvuq_5","telegram-container":"_telegram-container_1bvuq_9",telegramContainer:"_telegram-container_1bvuq_9","meme-telegram-container":"_meme-telegram-container_1bvuq_13",memeTelegramContainer:"_meme-telegram-container_1bvuq_13","right-icon":"_right-icon_1bvuq_17",rightIcon:"_right-icon_1bvuq_17"};function Dc(){return Nc.default.createElement(qa,{iconStyle:{fontSize:24},tooltipProps:{show:!1},iconClassName:Vt.rightIcon})}u();l();var Fc=R(x()),Bc=R(Ot());var Mc={[mt]:"swaptrade_card_swap_title_swap",[gt]:"swaptrade_card_swap_title_swap",[Ft]:"swaptrade_extension_cinteraction_contract_interaction",[Eo]:"swaptrade_recent_transaction_detail_dialog_title",[Ie]:"swaptrade_card_swap_title_swap",[Je]:"swaptrade_card_swap_title_swap",[mr]:"swaptrade_modal_select_crypto_title",[hr]:"swaptrade_select_token_header_third_token_reminder",[pr]:"swaptrade_trading_mode_header_settings"},vl=[ze,Ze],Ll=a=>a.startsWith(Te)?f(Mc[Eo]):f(Mc[a]),wl=()=>{let a=(0,Bc.useLocation)();return(0,Fc.useMemo)(()=>({showNavigator:!vl.includes(a.pathname),title:Ll(a.pathname)}),[a.pathname])},Vr=wl;u();l();var Uc=R(x()),qc=R(Ot());function Vc(){let a=(0,qc.useLocation)(),t=Va(),{isTelegramMiniApp:e}=b.global,o=a.pathname;return(0,Uc.useMemo)(()=>!e&&o===mt&&t,[e,o,t])}var Ol=[mt,gt],Pl=({children:a,onBack:t})=>{let{showNavigator:e,title:o}=Vr(),r=(0,Wr.useLocation)(),n=(0,Wr.useHistory)(),{isTelegramMiniApp:i}=b.global,{Navigator:c}=b.components,d=r.pathname.includes(Ft),m=Vc();xc();let p=()=>{d&&oo({...ct(),button_name:"back"}),t?t(n.goBack,Ol.includes(r.pathname)):n.goBack()};return ao.default.createElement("div",{className:(0,Wc.default)("universe-swap background-base-primary",Vt.wrapper)},e?ao.default.createElement(c,{title:o,onBack:p,closeable:m?{children:ao.default.createElement(Dc,null)}:!1}):null,ao.default.createElement("div",{className:i?Vt.telegramContainer:Vt.extensionContainer},a),ao.default.createElement(Oc,null))},Gc=rt(Pl);var xl=(0,pt.lazy)(()=>import("./Swap-IHKUDW74.js")),Nl=(0,pt.lazy)(()=>import("./Bridge-BD43GRF5.js")),Dl=(0,pt.lazy)(()=>import("./OrderDetail-QAHENJBG.js")),Ml=(0,pt.lazy)(()=>import("./Contract-75GOY66X.js")),Fl=(0,pt.lazy)(()=>import("./Approve-7MXG7XEU.js")),Bl=(0,pt.lazy)(()=>import("./Solana-HC2WEUBV.js")),Ul=({onBack:a})=>{let t=(0,ie.useLocation)();return pt.default.createElement(Gc,{onBack:a},pt.default.createElement(pt.Suspense,null,pt.default.createElement(ie.Switch,null,[{path:mt,component:xl,exact:!0},{path:gt,component:Nl,exact:!0},{path:Eo,component:Dl,exact:!0},{path:Ft,component:Ml,exact:!0},{path:ze,component:Fl,exact:!0},{path:Ze,component:Bl,exact:!0}].map((o,r)=>pt.default.createElement(ie.Route,{key:r,path:o.path,component:o.component,exact:o.exact})),pt.default.createElement(ie.Redirect,{from:to,to:{pathname:mt,search:t.search},strict:!0,exact:!0}))))},Qc=Ul;var ql=({currency:a,currentWallet:t,keyringIdentityTypeEnum:e,addressBookList:o,walletList:r,walletInfo:n,onBack:i,t:c,dispatch:d,currentTab:m=E.SWAP})=>{Cc(n.chainId),vc({currency:a,currentWallet:t,walletInfo:n,keyringIdentityTypeEnum:e,addressBookList:o,walletList:r,t:c,dispatch:d,currentTab:m,onBack:i}),kc(),Rc(),Ks();let{initialized:p}=Br();return p?Gr.default.createElement(Qc,{onBack:i}):null},Hc=(0,Gr.memo)(rt(ql));u();l();var jc=R(x());F();var Vl=()=>{let a=jn.hash.split("?")[1],t=new er(a),e=t.get("pageSource"),o=t.get("bot");(0,jc.useEffect)(()=>{let r;e&&(r=e),o&&(r="bot"),r&&jt.set("pageSource",r)},[e,o])},Kc=Vl;u();l();u();l();u();l();u();l();P();u();l();var Yc=(a,t)=>{let e=a.split(".").map(Number),o=t.split(".").map(Number),r=Math.max(e.length,o.length);for(let n=0;n<r;n++){let i=e[n]||0,c=o[n]||0;if(i>c)return 1;if(i<c)return-1}return 0};var Po=class{constructor(){s(this,"btcAddressType","");s(this,"setBtcAddressType",t=>{this.btcAddressType=t});s(this,"commonStore",null);s(this,"userForbiddenWithBridge",Se);s(this,"setUserForbiddenBridge",t=>{this.userForbiddenWithBridge=t});s(this,"defaultWalletConfig",Si);s(this,"walletConfig",this.defaultWalletConfig);s(this,"hasInitWalletInfo",!1);s(this,"chainId",se);s(this,"setChainId",t=>{this.chainId=t});s(this,"fromChainId",se);s(this,"setFromChainId",t=>{this.fromChainId=t});s(this,"walletSupportMev",!1);s(this,"setWalletSupportMev",t=>{this.walletSupportMev=t});s(this,"checkOkxVersion",async()=>{let t="2.82.31",e=this.walletConfig.isOkxWallet;if(this.isConnectedWallet&&e&&window?.okxwallet?.getVersion){let o=await window.okxwallet.getVersion(),n=Yc(o,t)>=0;this.setWalletSupportMev(n)}else this.setWalletSupportMev(!1)})}getDeviceId(){}getChainId(){}get scanAppType(){throw new Error("scanAppType is not defined")}get walletType(){throw new Error("walletType is not defined")}get address(){return se}get computedForbiddenBridge(){let{computedIsCrossChain:t}=S(this.rootStore,"fromToStore",{});return t?this.userForbiddenWithBridge:Se}get computedAccountId(){let{walletConfig:t}=this;return t.walletId}setWalletConfig(t={}){this.walletConfig=t}getAddressByChainId(){}get isConnectedWallet(){return!!this.walletConfig.walletId}get computedNonsupportChain(){return!this.isConnectedWallet||!H(this.fromChainId)?!1:!this.address}get computedAccountWalletAddresses(){return Xt(S(this,"walletConfig.address",[])).join(",")||this.address}get computedAccountWalletAddressesArray(){return Xt(S(this,"walletConfig.address",[]))||[this.address]}get computedSpecialWalletAddress(){return this.getAddressByChainId(V.BTC_MAINNET)}};u();l();u();l();function xt(a=[],t=[]){let e={};a.forEach(r=>{e[r]=So});let o={};return t.forEach(r=>{o[r]=zn}),{...e,...o}}var $c=xt(["walletConfig","chainId","hasInitWalletInfo","fromChainId","btcAddressType"],["computedAccountId","isConnectedWallet","computedNonsupportChain","computedAccountWalletAddresses","computedAccountWalletAddressesArray","address","computedSpecialWalletAddress"]);var Ys=class extends Po{constructor(e){super();s(this,"formatWalletType",()=>{let{walletInfo:e}=b,{isHARDWARE:o,isMNEMONIC:r,isMPC:n,isPRIVATE:i}=e?.walletType||{};return o?Zt.HARDWARE:r?Zt.MNEMONIC:n?Zt.MPC:i?Zt.PRIVATE_KEY:null});s(this,"formatWalletAccount",e=>{let o=Object.values(e.account);return{...e,OKXWalletType:this.formatWalletType(),address:o}});s(this,"keyringIdentityTypeEnum",{});s(this,"walletList",[]);s(this,"addressBookList",[]);s(this,"hasInitWalletInfo",!1);s(this,"getAddressByChainId",e=>{if(!H(e))return se;let o=this.getWalletChainName(e);return this.walletConfig.account?.[o]||se});this.rootStore=e,this.commonStore=e.commonStore,Rt(this,$c)}async getDeviceId(){let{devid:e}=await b.localStore.get("devid");return e}getCurrentChainAddress(e){let o=this.rootStore?.fromToStore.from.chainId;if(!H(o))return se;let r=this.getWalletChainName(o);return e.account[r]}getWalletChainName(e){return b.getNetWorkName(e)}replaceBtcAddressByType(e){if(this.btcAddressType){let o=this.getWalletChainName(V.BTC_MAINNET);if(e.account?.[o]){let n=e.accountsMap?.bitcoin?.[this.btcAddressType]?.address;if(n)return{...e,account:{...e.account,[o]:n}}}}return e}setWalletConfig(e){this.walletConfig=this.formatWalletAccount(this.replaceBtcAddressByType(e)),this.hasInitWalletInfo=!0}webSwapHistoryDetailViewMore(){}setAddressBookList(e){this.addressBookList=e}setWalletList(e){this.walletList=e.map(o=>o.walletId===this.computedAccountId?this.replaceBtcAddressByType(o):o)}setKeyringIdentityTypeEnum(e){this.keyringIdentityTypeEnum=e}get address(){return this.getAddressByChainId(this.fromChainId)}},Qr=Ys;u();l();u();l();P();F();u();l();var ye={FROM:"FROM",TO:"TO"},$s={COMMON:"COMMON",COLLECTION:"COLLECTION"},It={COLLECT_LIST:"COLLECT_LIST",ALL_NETWORK:"ALL_NETWORK",CHAIN_LIST:"CHAIN_LIST",SEARCH:"SEARCH",ALL_TOKENS:"ALL_TOKENS"},Wl={[It.COLLECT_LIST]:{[E.SWAP]:qi,[E.LIMIT_ORDER]:Ui,[E.BRIDGE]:Vi},[It.ALL_NETWORK]:{[E.SWAP]:Fi,[E.LIMIT_ORDER]:Mi,[E.BRIDGE]:Bi},[It.SEARCH]:{[E.SWAP]:Gi,[E.LIMIT_ORDER]:Wi,[E.BRIDGE]:Qi},[It.CHAIN_LIST]:{[E.SWAP]:vi,[E.LIMIT_ORDER]:wi,[E.BRIDGE]:Li},[It.ALL_TOKENS]:{[E.SWAP]:Us,[E.LIMIT_ORDER]:Us,[E.BRIDGE]:Ti}},Yt=(a,t)=>Wl[a]?.[t]??"";var xo=class{constructor(t){s(this,"rootStore",null);s(this,"userUniqueId",xa());s(this,"chainListFreshCount",0);s(this,"chainList",[]);s(this,"setChainList",t=>{this.chainList=t,this.chainListFreshCount+=1});s(this,"transactionLoading",!1);s(this,"setTransactionLoading",t=>{this.transactionLoading=t});s(this,"nowCurrencyUnit",{});s(this,"tokenModalVisible",!1);s(this,"safemoonSlippage",0);s(this,"fetchChainList",async({businessLine:t=1,isLimit:e=!1,isHistory:o=!1,currentTab:r,chainIdConfig:n={}})=>{if(Vn())return[];let i=Yt(It.CHAIN_LIST,this.currentTab||r),c=await C.get(i,{params:{businessLine:e?ee.LIMIT_ORDER:t,...n}});return!o&&this.setChainList(c?.data),this.setCurrentTabChainList({[e?E.LIMIT_ORDER:E.SWAP]:c?.data}),c?.data});s(this,"currentTabChainList",{});s(this,"setCurrentTabChainList",t=>{this.currentTabChainList={...this.currentTabChainList,...t}});s(this,"getTradeType",()=>this.rootStore?.fromToStore?.computedIsCrossChain?Bs.MULTI:Bs.SINGLE);s(this,"globalMessages",null);s(this,"setGlobalMessage",t=>{this.globalMessages=t});s(this,"cleanGlobalMessage",()=>{this.globalMessages=null});s(this,"socketStatus",!1);s(this,"balancePushSocketStatus",!1);s(this,"resetFromToByTabChange",!1);s(this,"setResetFromToByTabChange",t=>{this.resetFromToByTabChange=t});s(this,"portal",yt.DEX);s(this,"setPortal",t=>{this.portal=t});s(this,"currencyConversion",t=>{let{usdToThisRate:e}=this.nowCurrencyUnit,o=I.BigNumber(t);return!e||o.isNaN()?"":o.multipliedBy(e)});s(this,"currencyReConversion",t=>{let{usdToThisRate:e}=this.nowCurrencyUnit,o=I.BigNumber(t);return!e||o.isNaN()?"":o.dividedBy(e).toString()});s(this,"isSensitiveChain",t=>this.computedSensitiveChainIds.some(e=>String(e)===String(t)));s(this,"getTokenAddress",t=>Ha(t,this.isSensitiveChain(t?.chainId)));s(this,"equalsChainId",(t,e)=>ja(t,e));s(this,"equalsToken",(t,e)=>{let o=this.isSensitiveChain(t?.chainId);return Ut(t,e,o)});s(this,"fromFillToken",!1);s(this,"currentTab","");s(this,"setCurrentTab",(t,e)=>{this.currentTab!==t&&(this.setResetFromToByTabChange(!0),this.rootStore?.fromToStore?.clearFromTo()),this.currentTab=t,this.fromFillToken=!!e});s(this,"marketWsIsConnected",!1);s(this,"setMarketWsIsConnected",t=>{this.marketWsIsConnected=t});s(this,"forceUpdateFromToByHash",0);s(this,"forceUpdateFromTo",()=>{this.forceUpdateFromToByHash+=1});s(this,"isFirstInit",!0);s(this,"visibleAddFunds",!1);s(this,"setAddFundsVisible",t=>{this.visibleAddFunds=t});this.rootStore=t,no&&this.setPortal(yt.LEDGER)}setChainType(){}get computedReserveGas(){let{chainList:t}=this,e=S(this.rootStore,"fromToStore.from.chainId");return t.find(r=>Number(r.chainId)===Number(e))?.reserveGas||""}getChainByID(t){return this.chainList.find(e=>(this.computedCurrentTabIsLimit||e.chainUsed)&&e.chainId===Number(t))}getUserUnit(){}get computedRealSlippageValue(){return S(this,"rootStore.slippageStore",{}).computedRealSlippageValue||0}setSocketStatus(t){this.socketStatus=t}setBalanceSocketStatus(t){this.balancePushSocketStatus=t}get computedIsWalletEnv(){return this.portal===yt.OKX_WALLET_EXTENSION}get computedIsWalletDashBoard(){return this.portal===yt.WALLET_DASHBOARD}get computedIsMarket(){return this.portal===yt.MARKET}get computedNotThirdBiz(){return this.portal===yt.OKX_WALLET_EXTENSION||this.portal===yt.DEX||this.portal===yt.MARKET}get computedNowCurrencySymbol(){return this.nowCurrencyUnit.symbol||""}get computedSensitiveChainIds(){return this.chainList.map(t=>Number(t.isSensitive)===ii.YES?t.chainId:null).filter(Boolean)}get computedCurrentTabIsLimit(){return this.currentTab===E.LIMIT_ORDER}get computedIsUrlFillSwap(){return this.computedIsWalletDashBoard||this.computedIsWalletEnv}setIsFirstInit(t){this.isFirstInit=t}};u();l();var Xc=xt(["userUniqueId","chainList","transactionLoading","nowCurrencyUnit","tokenModalVisible","safemoonSlippage","globalMessages","socketStatus","balancePushSocketStatus","portal","currentTab","currentTabChainList","forceUpdateFromToByHash","marketWsIsConnected","isFirstInit","visibleAddFunds"],["computedReserveGas","computedNowCurrencySymbol","computedSensitiveChainIds","computedIsWalletEnv","computedCurrentTabIsLimit"]);var ke=class extends xo{constructor(e){super(e);s(this,"swapCollapse",!1);s(this,"setSwapCollapse",e=>{this.swapCollapse=e});s(this,"chainListLoadError",!1);s(this,"setChainListLoadError",e=>{this.chainListLoadError=e});Rt(this,{...Xc,swapCollapse:So,chainListLoadError:So}),this.setPortal(hi)}getUserUnit(e){this.nowCurrencyUnit=e}};u();l();P();F();var No=class{constructor(t){s(this,"checkTokenValid",async t=>{if(!Ia(t))return!1;let[e,o]=await _(C.get(na,{params:pe(t,["chainId","tokenContractAddress"])}));return e?!1:o.data.supportMarket});this.rootStore=t,this.accountStore=t.accountStore,L(this,{},{autoBind:!0})}};u();l();P();F();var Do=class{constructor(t){s(this,"showLimitDialog",!1);s(this,"setShowLimitDialog",t=>{this.showLimitDialog=t});s(this,"cancelRef",null);s(this,"callbackList",[]);s(this,"addToCallbackList",t=>{this.callbackList.push(t)});s(this,"removeFromCallbackList",t=>{this.callbackList=this.callbackList.filter(e=>e!==t)});s(this,"updateTokenCollectStatus",async({tokenInfo:t,callBack:e})=>{let{isConnectedWallet:o}=this.accountStore;if(!o){this.walletWarnInterceptor();return}this.cancelRef&&this.cancelRef.abort(),this.cancelRef=$();let r={tokenContractAddress:t?.tokenContractAddress,chainId:Number(t?.chainId),symbol:t?.tokenSymbol,decimal:t?.decimals,userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,isCustomToken:t?.isCustomToken||t?.isSubscribe},[n,i]=await _(C.post(Ir,r,{signal:this.cancelRef.signal}));this.handleResult({error:n,res:i,callBack:e,tokenInfo:t})});s(this,"debounceUpdateTokenCollectStatus",Qe(this.updateTokenCollectStatus,500));s(this,"walletWarnInterceptor",()=>{N.error({title:f("swaptrade_selecttoken_toast_connect_wallet"),duration:Pt})});this.rootStore=t,this.commonStore=t.commonStore,this.accountStore=t.accountStore,L(this,{},{autoBind:!0})}handleResult({error:t,res:e,callBack:o,tokenInfo:r}){if(!Tt(t)&&t)t?.code===10023?N.error(f("swaptrade_selecttoken_modal_favorite_limitreached")):N.error(f("swaptrade_pricechart_no_connection_desc"));else if(e){if(e?.data===0)N.success({title:f("swaptrade_selecttoken_toast_removed_from_favorite"),duration:Pt}),o({selected:!1,tokenInfo:r}),this.callbackList.forEach(n=>{n({selected:!1,tokenInfo:r})});else if(e?.data===1){let n=La(),{isMarketHomeUrl:i}=wa();!i&&_r({business_type:n?xs.LIMIT_ORDER:xs.SWAP}),N.success({title:f("swaptrade_selecttoken_toast_added_to_favorite"),duration:Pt}),o({selected:!0,tokenInfo:r}),this.callbackList.forEach(c=>{c({selected:!0,tokenInfo:r})})}}}};var ae=class{constructor(){ae.instance?(this.commonStore=ae.instance.commonStore,this.accountStore=ae.instance.accountStore,this.updateCollectionStore=ae.instance.updateCollectionStore,this.checkTokenStore=ae.instance.checkTokenStore):(this.commonStore=new ke(this),this.accountStore=new Qr(this),this.updateCollectionStore=new Do(this),this.checkTokenStore=new No(this),ae.instance=this)}},_e=ae;s(_e,"instance",null);u();l();u();l();P();F();u();l();function Mo(a){return[te.USER_DENIED,te.WC2Denied,te.USER_DENIED_WC_RAINBOW,te.WC_QR_DENIED].includes(a?.code)}var Xs=class{constructor(t){this.approveTokenDefaultConfig={status:U.Unknown,approvedAmount:"0"};this.approveTokensConfig={};this.getApproveTokenMapKey=(t,e)=>{let o=this.commonStore.getTokenAddress(t);return`${t.chainId}_${o}_${e}`};this.registerApproveToken=(t,e)=>{let o=this.getApproveTokenMapKey(t,e),r=S(this.approveTokensConfig,o);Y(r)&&(this.approveTokensConfig[o]={...this.approveTokenDefaultConfig})};this.registerCurrentApproveToken=()=>{let{token:t,tradeModeCode:e}=this.computedTokenAndTradeModeCode;this.registerApproveToken(t,e)};this.updateApproveTokenConfig=(t,e,o)=>{let r=this.getApproveTokenMapKey(t,e),n=S(this.approveTokensConfig,r),i=Y(n),c=n||this.approveTokenDefaultConfig;this.approveTokensConfig[r]={...c,...o},i&&A.stuff("if you want to update approve token config, you should register it first.")};this.removeApproveTokenConfig=(t,e)=>{let o=this.getApproveTokenMapKey(t,e);delete this.approveTokensConfig[o]};this.updateCurrentApproveTokenConfig=t=>{let{token:e,tradeModeCode:o}=this.computedTokenAndTradeModeCode;this.updateApproveTokenConfig(e,o,t)};this.getApproveTokenConfig=(t,e)=>{let o=this.getApproveTokenMapKey(t,e);return S(this.approveTokensConfig,o,this.approveTokenDefaultConfig)};this.clearNonApprovingTokensConfig=()=>{let t=Mn(this.approveTokensConfig,e=>[U.Approving,U.CancelApproving].includes(e.status));this.approveTokensConfig={...t}};this.isApprovalCheckRequired=()=>{let{computedIsSolanaChain:t,computedIsAptosChain:e}=this.fromToStore,{quote:{bestRoute:o}}=this.rootStore.quoteStore,r=this.commonStore.computedCurrentTabIsLimit,{token:n}=this.computedTokenAndTradeModeCode,{isNativeToken:i}=n;return(r?!0:o?.needApprove==="1")&&!i&&!t&&!e};this.validApproveAmountLessSwapAmount=t=>{let{token:e}=this.computedTokenAndTradeModeCode;return I.BigNumber(t).isLessThan(e.amount||"0")};this.isValidApprovalStatus=(t,e)=>{let o=oe(t),r=this.validApproveAmountLessSwapAmount(t);return o?U.UnApproved:r&&e?U.CancelApprove:r?U.UnApproved:U.Approved};this.generateApproveRequestParams=t=>{let{address:e}=this.accountStore,{token:o}=this.computedTokenAndTradeModeCode,{tokenContractAddress:r,chainId:n}=o;return{userWalletAddress:e,tokenContractAddress:r,chainId:n,cancelApproveTag:t}};this.fetchApproveAllowance=()=>{let t=this.getDefiPlatformIds();return C.get(xi,{params:{...this.generateApproveRequestParams(),defiPlatformIds:t}}).then(e=>e?.data)};this.fetchApproveData=t=>{let e=this.fromToStore.computedIsCrossChain?this.getBridgeDefiPlatformId():S(this,"rootStore.quoteStore.quote.bestRoute.defiPlatformId",z),o={...this.generateApproveRequestParams(t),defiPlatformId:e};return C.get(Ni,{params:o}).then(r=>{let{id:n,data:i,from:c,to:d,unsignedTx:m}=r?.data||{},p={data:i,from:c,to:d};return A.info(v.APPROVE_DATA,{id:n,data:i,from:c,to:d,unsignedTx:m,cancelApproveTag:t}),Pr(o.chainId)&&(p=JSON.parse(m)),{transactionPayload:p,id:n}})};this.getBridgeDefiPlatformId=()=>{let e=this.rootStore.quoteStore.quote?.bestRoute,o=Number(e?.bridge?.bridgeType),r=e?.bridge?.defiPlatformId;return o===li?r:z};this.approveStatusIsPending=()=>[U.Approving,U.CancelApproving].includes(this.computedApprovalStatus);this.isPendingNeedCheck=async()=>{this.approveStatusIsPending()&&this.checkApprove().catch(()=>{})};this.isPendingNotCheck=async()=>{this.approveStatusIsPending()||this.checkApprove().catch(()=>{})};this.getDefiPlatformIds=()=>{let{computedIsCrossChain:t}=this.fromToStore;if(t){let e=S(this,"rootStore.quoteStore.pathSelectionRouterList");return Array.isArray(e)?Xt(e.map(o=>o.bridge?.defiPlatformId).filter(o=>o!==void 0)):[z]}return S(this,"rootStore.quoteStore.quote.bestRoute.defiPlatformInfoList",[{defiPlatformId:z}]).map(e=>e.defiPlatformId)};this.checkApprove=async()=>{let{token:t,tradeModeCode:e}=this.computedTokenAndTradeModeCode;if(!this.isApprovalCheckRequired()){this.getDefiPlatformIds().forEach(i=>{this.registerApproveToken(t,i),this.updateApproveTokenConfig(t,i,{status:U.Approved,tagStatus:U.UnApproved})});return}let{tokenContractAddress:o}=t,{address:r}=this.accountStore;if(o&&r){let[,n]=await _(this.fetchApproveAllowance());if(!n){this.updateApproveTokenConfig(t,e,{status:U.Unknown});return}Object.keys(n).forEach(i=>{let c=n[i];this.calcApproveState({approveInfo:c,token:t,tradeModeCode:Number(i)})})}};this.calcApproveState=({approveInfo:t,token:e,tradeModeCode:o})=>{let{decimals:r}=e,n=Number(t.status)===U.Approved?t.amount:"0",i=eo(n,r)||"0",c=t?.needCancelApproveToken,d=this.isValidApprovalStatus(i,c);this.registerApproveToken(e,o),this.updateApproveTokenConfig(e,o,{status:d,tagStatus:d,approvedAmount:i})};this.fetchApproveDataErrorTips=(t,e)=>{this.updateCurrentApproveTokenConfig({status:U.UnApproved});let o=W(t?.tokenSymbol);Lr({title:e?f("swaptrade_transfer_notification_title_ccy_unrevoked",{ccy:o}):f("swaptrade_toast_approve_fail",{tokenSymbol:o})})};this.approveErrorTips=({error:t,chainId:e,transactionPayload:o,token:r,tradeModeCode:n,cancelApproveTag:i})=>{A.error(v.APPROVE_TOKEN_ERROR,{chainId:e,transactionPayload:o,error:t,token:r,tradeModeCode:n}),Mo(t)||Qt.error({title:f("swaptrade_home_toast_broadcast_failed")}),this.updateApproveTokenConfig(r,n,{status:this.isCancelApprove(i)?U.CancelApprove:U.UnApproved})};this.isCancelApprove=t=>t===je.CANCEL_APPROVE;this.setApprove=async t=>{let{token:e,tradeModeCode:o}=this.computedTokenAndTradeModeCode,{chainId:r}=e;this.updateApproveTokenConfig(e,o,{status:this.isCancelApprove(t)?U.CancelApproving:U.Approving});try{let{id:n,transactionPayload:i}=await this.fetchApproveData(t);await this.approveToken({chainId:r,transactionPayload:i}).then(({result:c})=>this.saveApprove({id:n,chainId:r,transactionHash:c,cancelApproveTag:t})).catch(c=>{this.approveErrorTips({error:c,chainId:r,transactionPayload:i,token:e,tradeModeCode:o,cancelApproveTag:t})})}catch{this.fetchApproveDataErrorTips(e,t)}};this.saveApprove=async({id:t,chainId:e,transactionHash:o,cancelApproveTag:r})=>{if(!o)return;let{address:n}=this.accountStore,i=S(this,"rootStore.quoteStore.quote.bestRoute.defiPlatformId",z);A.info(v.SAVE_APPROVE,{id:t,transactionHash:o,chainId:e,userWalletAddress:n,cancelApproveTag:r,defiPlatformId:i});try{await C.post(Di,{id:t,transactionHash:o,chainId:e,userWalletAddress:n,cancelApproveTag:r,defiPlatformId:i})}catch(c){A.info(v.SAVE_APPROVE_ERROR,{error:c?.message,id:t,transactionHash:o,chainId:e,userWalletAddress:n,cancelApproveTag:r,defiPlatformId:i})}};this.onSocket=async t=>{if(t?.type==="1"&&t?.dexData&&t.dexData.type==="approve"){let e=t.dexData,{status:o,transactionHash:r,fromTokenSymbol:n,fromTokenAddress:i,exploreUrl:c,solanaToast:d,platformId:m}=e,p=J();if(d==="1"){if(p)return;let O=o===Ke.CANCEL_APPROVE_SUBMITTED?"swaptrade_transfer_toast_ccy_unrevoke_submit":"swaptrade_transfer_notification_approval_submit";vr({title:f(O,{ccy:W(n)})});return}let{token:g,tradeModeCode:T}=this.computedTokenAndTradeModeCode,y={chainId:e.chainId,tokenContractAddress:i},w=this.commonStore.equalsToken(g,y),M=String(T)===String(m);if(w&&M&&await this.isPendingNeedCheck(),(!w||w&&!M)&&this.removeApproveTokenConfig(y,m),o===Ke.APPROVE_SUCCESS){let O=f("swaptrade_toast_approve_success",{tokenSymbol:W(n)});!p&&vr({title:O,exploreUrl:c}),Lo.emit(vo.APPROVE,{data:r,status:0,message:O})}else if(o===Ke.APPROVE_FAILED&&!p){let O=f("swaptrade_toast_approve_fail",{tokenSymbol:W(n)});Lr({title:O,exploreUrl:c})}else if(o===Ke.CANCEL_APPROVE_SUCCESS&&!p){let O=f("swaptrade_transfer_notification_title_ccy_revoked",{ccy:W(n)});vr({title:O,exploreUrl:c})}else if(o===Ke.CANCEL_APPROVE_FAILED&&!p){let O=f("swaptrade_transfer_notification_title_ccy_unrevoked",{ccy:W(n)});Lr({title:O,exploreUrl:c})}}};this.onSocketError=()=>{this.isPendingNeedCheck().catch(()=>{})};this.rootStore=t,this.accountStore=t.accountStore,this.commonStore=t.commonStore,this.fromToStore=t.fromToStore}get computedApprovalStatus(){let{token:t,tradeModeCode:e}=this.computedTokenAndTradeModeCode;return this.getApproveTokenConfig(t,e).status}get computedTokenAndTradeModeCode(){let{from:t,computedIsCrossChain:e}=this.fromToStore,o=this.rootStore.quoteStore,r=z;if(e)r=this.getBridgeDefiPlatformId();else{let{aggregateSelectId:n}=o;r=n===vt?z:n}return{token:t,tradeModeCode:r}}get computedIsCancelApproveStatus(){return[U.CancelApprove,U.CancelApproving].includes(this.computedApprovalStatus)}approveToken(t){return Promise.resolve(t)}},zc=Xs;u();l();var Jc=Symbol(),Zc=Object.prototype,Gl=(a,t,e)=>{if(Jn(a))throw new Error("Target must not be observable");let o=a[Jc];if(o){let r={};for(let n in a)o[n]&&(r[n]=o[n]);o=r}else{o={};let r=a;for(;r&&r!==Zc;)Reflect.ownKeys(r).forEach(i=>{i===Xn||i==="constructor"||(o[i]=t&&i in t?t[i]:!0)}),r=Object.getPrototypeOf(r);let n=Object.getPrototypeOf(a);n&&n!==Zc&&Object.defineProperty(n,Jc,{value:o})}return Rt(a,o,e)},ut=Gl;var Ee=class extends zc{constructor(e){super(e);s(this,"approveInfo",{});s(this,"setApproveInfo",e=>{this.approveInfo=e});s(this,"setApprove",async(e=je.APPROVE)=>{let{token:o,tradeModeCode:r}=this.computedTokenAndTradeModeCode,{chainId:n}=o;this.updateApproveTokenConfig(o,r,{status:this.isCancelApprove(e)?U.CancelApproving:U.Approving});try{let{id:i,transactionPayload:c}=await this.fetchApproveData(e);this.setApproveInfo({chainId:n,id:i,transactionPayload:c,token:o,tradeModeCode:r,cancelApproveTag:e}),b.history?.push({pathname:ze})}catch{this.fetchApproveDataErrorTips(o,e)}});s(this,"approveCancel",()=>{let e=this.approveInfo.cancelApproveTag;this.setApproveInfo({}),b.history?.goBack?.(),this.updateCurrentApproveTokenConfig({status:this.isCancelApprove(e)?U.CancelApprove:U.UnApproved})});s(this,"approveConfirm",async({txHash:e,error:o})=>{if(o){this.approveErrorTips({error:o,...this.approveInfo}),this.approveCancel();return}let{id:r,chainId:n,cancelApproveTag:i}=this.approveInfo;await this.saveApprove({id:r,chainId:n,transactionHash:e,cancelApproveTag:i}),b.history?.goBack?.(),this.setApproveInfo({})});ut(this)}};u();l();F();u();l();var Nt=()=>{let{fromToStore:a,gasDropStore:t,receiveAddressStore:e,outerStore:o,quoteStore:r,accountStore:n,liquidityChooseStore:i}=B(),{from:c,to:d}=a,{receiveAddrObj:m}=e,{computedForbiddenBridge:p,address:g}=n,T=I.BigNumber(a.computedTypedValue).toString(10),w={...{chainId:c.chainId,toChainId:d.chainId,toTokenAddress:d.tokenContractAddress,fromTokenAddress:c.tokenContractAddress,amount:T,userWalletAddress:g},...r.computedSlippage,pmm:"1",gasDropType:t?.computedGasDropSelected?1:0,forbiddenBridgeTypes:Vs(p),dexIds:Vs(i?.computedIds),receiveWalletAddress:m?.specifiedAddress};return o.extendFeeConfig(w)},tu=()=>{let{quoteStore:a}=B();return{...Nt(),sort:a.bridgeSortType}},eu=()=>{let{quoteStore:a}=B(),{quote:t}=a,e=t?.bestRoute?.bridge?.bridgeId,{slippage:o,toChainId:r,receiveWalletAddress:n,userWalletAddress:i,chainId:c,fromTokenAddress:d,toTokenAddress:m,amount:p}=Nt();return{slippage:o,toChainId:r,receiveWalletAddress:n,userWalletAddress:i,chainId:c,fromTokenAddress:d,toTokenAddress:m,amount:p,bridgeId:e}};u();l();u();l();u();l();var j=class{constructor({orderData:t,extParams:e},o){s(this,"walletNoNeedExtParams",!1);s(this,"differentiatedEnvironment",t=>J()&&t.length>1&&!this.walletNoNeedExtParams&&!t[0].params?[{...t[0],extParams:t[1]}]:t);this.orderData=t,this.calldataType=t.calldataType,this.extParams=e||{},this.swapStore=o}get isTransferType(){return this.calldataType===ci.TRANSFER}};var Re=class extends j{constructor(){super(...arguments);s(this,"formatContractPayload",()=>{let{orderData:e}=this;return{...JSON.parse(e?.callData?.data)}});s(this,"formatTransferPayload",()=>{});s(this,"getSendTransactionParams",async()=>{let e=this.formatContractPayload();return this.differentiatedEnvironment([{...e,extParams:this.extParams}])});s(this,"preExecution",async()=>({payload:this.formatContractPayload()}))}};s(Re,"chainId",V.APTOS_MAINNET);u();l();var be=class extends j{constructor(e,o,r){super(e,o);s(this,"makeSendBtcCallParams",async e=>{let{preDataForSendBtc:o}=this.swapStore.rootStore.walletContractStore;if(!o)throw Error("preDataForSendBtc is not ready");let{satBytes:r,coinAmount:n,dustSize:i,fetchUtxoList:c,serviceCharge:d}=o,m=await c();return{...e,utxoList:m,satBytes:r,dustSize:i,coinAmount:n,serviceCharge:d}});s(this,"formatContractPayload",()=>{});s(this,"formatTransferPayload",async()=>{let{orderData:e}=this;return this.swapStore.transferBtcPayload(e.callData)});s(this,"extendExtParams",e=>({...e,extParams:this.extParams}));s(this,"getSendTransactionParams",async()=>{if(!this.token.isNativeToken)throw new Error("btc token is not native token");let e;if(this.isTransferType){let o=await this.formatTransferPayload();e=this.extendExtParams(o),J()&&(e=await this.makeSendBtcCallParams(e))}else throw Error("Not support contract call");return this.differentiatedEnvironment([e])});s(this,"preExecution",async()=>{if(!this.token.isNativeToken)throw new Error("btc token is not native token");let e;if(this.isTransferType)e=await this.formatTransferPayload();else throw Error("Not support contract call");return{payload:e}});this.token=r}};s(be,"chainId",V.BTC_MAINNET);u();l();var Hr=class extends j{constructor(){super(...arguments);s(this,"valueToHex",e=>I.BigNumber(e).toString(16));s(this,"formatContractPayload",()=>{let{orderData:e}=this,{priorityFee:o,maxFeePerGas:r,maxPriorityFeePerGas:n,gasPrice:i,gas:c,...d}=e?.callData||{};return d});s(this,"formatTransferPayload",()=>{let{orderData:e}=this;return e.callData});s(this,"getSendTransactionParams",async()=>{let{payload:e}=await this.preExecution();return no&&e.value&&(e.value=this.valueToHex(e.value)),this.differentiatedEnvironment([e])});s(this,"preExecution",async()=>{let e;this.isTransferType?e=this.formatTransferPayload():e=this.formatContractPayload();let{extendEvmParams:o,extendsGas:r}=this.swapStore;return e.extParams=this.extParams,r&&(e=r(e)),e=o(e),{payload:e}})}};s(Hr,"chainId",V.ETHEREUM_MAINNET);var jr=Hr;u();l();u();l();P();var ve=class{constructor(){s(this,"importSolana",async()=>{let t=await import("./index.browser.esm-UMJTAPC7.js"),{default:e}=await import("./bs58-N7DEN7IX.js");return{SolanaWeb3:t,bs58:e}});s(this,"deserialize",async t=>{let e={TRANSACTION:"transaction",VERSIONED_TRANSACTION:"versionedTransaction"},o,r,{SolanaWeb3:n,bs58:i}=await this.importSolana();try{o=n.Transaction.from(i.decode(t)),r=e.TRANSACTION}catch{o=n.VersionedTransaction.deserialize(i.decode(t)),r=e.VERSIONED_TRANSACTION}return{transaction:o,version:r}});s(this,"rentReserve",t=>{if(!t)return"0";let{BigNumber:e}=I,o=e("365.25").div(2).multipliedBy(2);return e("19.055441478439427").multipliedBy(t).multipliedBy(o).div(10**9).toFixed(9)});s(this,"txData",async t=>{let e;tr(t)?e=JSON.parse(t):e=t;let{data:o,accountLength:r,bizType:n,bizId:i,from:c,to:d}=e,{transaction:m,version:p}=await this.deserialize(o),g=this.rentReserve(r);return{payload:{bizType:n,bizId:i,transaction:m,version:p},inputData:o,from:c,to:d,rent:g}})}};s(ve,"chainId",V.SOLANA_MAINNET);var Le=class extends j{constructor(...e){super(...e);s(this,"formatContractPayload",async()=>{let{orderData:e}=this;return this.txData(e.unsignedTx)});s(this,"formatTransferPayload",async()=>{let{orderData:e}=this,{unsignedTx:o}=e;return this.txData(o)});s(this,"getSendTransactionParams",async()=>{let{payload:e}=await this.preExecution();return this.differentiatedEnvironment([e,this.extParams])});s(this,"preExecution",async()=>{let e;return this.isTransferType?e=await this.formatTransferPayload():e=await this.formatContractPayload(),e});s(this,"getTxData",()=>{let{jitoData:e,jitoEnable:o=!1,unsignedTx:r}=this.orderData||{};try{if(o){let{jitoUnsignedTx:n}=e;return JSON.parse(n).array}return[JSON.parse(r)]}catch(n){throw new Error(n)}});s(this,"jitoTransaction",async()=>{let e=this.getTxData();try{return Promise.all(e.map(this.txData))}catch(o){throw new Error(o)}});let o=new ve;Object.assign(this,{...o})}};s(Le,"chainId",V.SOLANA_MAINNET);u();l();var we=class extends j{constructor(){super(...arguments);s(this,"formatContractPayload",()=>{let{orderData:e}=this,{data:o,from:r}=e.callData,n=JSON.parse(o);return{...n,functionArgs:n.functionArgsEncode,txType:"contract_call",stxAddress:r}});s(this,"formatTransferPayload",()=>{});s(this,"getSendTransactionParams",async()=>this.differentiatedEnvironment([this.formatContractPayload(),this.extParams]));s(this,"preExecution",async()=>({payload:this.formatContractPayload()}))}};s(we,"chainId",V.STACKS_MAINNET);u();l();var Oe=class extends j{constructor(){super(...arguments);s(this,"walletNoNeedExtParams",!0);s(this,"formatContractPayload",()=>{let{orderData:e}=this,o=JSON.parse(e.unsignedTx),{executionRequest:r}=JSON.parse(o.data);return r.calls});s(this,"formatTransferPayload",()=>{});s(this,"getSendTransactionParams",async()=>this.differentiatedEnvironment([this.formatContractPayload()]));s(this,"preExecution",()=>({payload:this.formatContractPayload()}))}};s(Oe,"chainId",V.STARKNET_MAINNET);u();l();var Kr=class extends j{constructor(){super(...arguments);s(this,"formatContractPayload",()=>{let{orderData:e}=this,{txBytes:o}=JSON.parse(e.unsignedTx);return{transactionBlock:o}});s(this,"getSendTransactionParams",async()=>this.differentiatedEnvironment([this.formatContractPayload(),this.extParams]));s(this,"preExecution",async()=>({payload:this.formatContractPayload()}))}};s(Kr,"chainId",V.SUI_MAINNET);var zs=Kr;u();l();var Yr=class extends j{constructor(){super(...arguments);s(this,"walletNoNeedExtParams",!0);s(this,"formatContractPayload",()=>{let{orderData:e}=this,{params:o}=JSON.parse(e.unsignedTx);return o});s(this,"formatTransferPayload",()=>{let{orderData:e}=this,{params:o}=JSON.parse(e.unsignedTx);return o});s(this,"getSendTransactionParams",async()=>{let e=this.isTransferType?this.formatTransferPayload():this.formatContractPayload();return this.differentiatedEnvironment([e,this.extParams])});s(this,"preExecution",async()=>({payload:this.isTransferType?this.formatTransferPayload():this.formatContractPayload()}))}};s(Yr,"chainId",V.TON_MAINNET);var Js=Yr;u();l();var Pe=class extends j{constructor(){super(...arguments);s(this,"formatContractPayload",()=>{let{orderData:e}=this;return JSON.parse(e.unsignedTx)});s(this,"formatTransferPayload",()=>{});s(this,"getSendTransactionParams",async()=>{let e=this.formatContractPayload();return this.differentiatedEnvironment([{...e,extParams:this.extParams}])});s(this,"preExecution",async()=>({payload:this.formatContractPayload()}))}};s(Pe,"chainId",V.TRON_MAINNET);var Ql={[be.chainId]:be,[jr.chainId]:jr,[Le.chainId]:Le,[Re.chainId]:Re,[zs.chainId]:zs,[Pe.chainId]:Pe,[we.chainId]:we,[Oe.chainId]:Oe,[Js.chainId]:Js},Hl=a=>Ql[a]||jr,jl=(a,t,e)=>{let{chainId:o}=a,r=Hl(o);return new r(t,e,a)},Fo=jl;u();l();u();l();var $r=()=>{if(J()){let e={home:Ar()?_o.TGAPP:_o.PLUGIN,coinDetail:_o.WALLET,bot:_o.COMMAND},o=jt.get("pageSource");return{orderSource:e[o]}}return{orderSource:yr()?.source}};var Zs=a=>{let t=0;return a.forEach(e=>{t=I.add(t,e.rent,{returnString:!0})}),t},Kl=a=>{let t=a[0];return{fromAdr:t.from,toAdr:t.to,inputData:t.inputData}},tn=async({walletId:a,swapParams:t,signedTransactions:e,txArray:o,enableJito:r,isMemeMode:n=!1})=>{let i=o.length>1,c=[],d=[],{default:m}=await import("./bs58-N7DEN7IX.js");e.map(O=>{if(n){let{serializedTransaction:Wt,signature:Lt}=O;return{txHash:Lt,signedTx:Wt}}let lt=O?.signature||O?.signatures[0],ot=m.encode(lt),At=m.encode(O.serialize());return{txHash:ot,signedTx:At}}).forEach(O=>{c.push(O.signedTx),d.push(O.txHash)});let g="";i?g=JSON.stringify(c):g=c[0];let T=d[0],y=i?{mev:"Jito",jitoHash:d[1]}:{},w=Kl(o),M=Zs(o);return{updateMultiOrderInfo:{transactionHash:T,walletTxData:{extJson:JSON.stringify({...y,rent:M,txSource:3,feeType:4,multiTag:0,isMainTx:!1,coinAmount:0,serviceCharge:0,signedTx:i?JSON.parse(g):g}),isMainTx:!1,serviceCharge:0,txHash:T,walletId:a,txSource:3,coinAmount:0,walletType:2,signedTx:g,...w}},dexMultiMetaSaveOrderParam:{...t,enableJito:r,...$r()}}},ou=async({signedTransactions:a,swapParams:t,walletId:e,txArray:o,enableJito:r,traceData:n})=>{let i=await tn({walletId:e,signedTransactions:a,swapParams:t,txArray:o,enableJito:r,traceData:n});return C.post(ma,i)};u();l();function Yl({selector:a}){let t=document.querySelector(a);t&&t.scrollTo({top:0,behavior:"smooth"})}var Xr=Yl;var ru=20,ce={CONFIRM:"confirm",UPDATE:"update",FILL_UP:"fill_up",SNAP_UPDATE:"snap_update"},en=class{constructor(t){s(this,"quoteData",null);s(this,"preDataForSendBtc",null);s(this,"setPreDataForSendBtc",t=>{this.preDataForSendBtc=t});s(this,"setQuoteData",t=>{this.quoteData=t});s(this,"quoteParams",()=>{let{accountStore:t,fromToStore:e,receiveAddressStore:o}=this.rootStore,n={...Nt(),userWalletAddress:t.address};return e.computedDiffCrossChain&&(n.receiveWalletAddress=o.receiveAddrObj?.specifiedAddress),n});s(this,"updating",!1);s(this,"updateQuoteData",async()=>{let{quoteStore:{quote:t},swapStore:e}=this.rootStore,o=this.rootStore?.quoteStore?.quote?.bestRoute?.defiPlatformId;this.updating=!0;let n={...Nt(),bridgeId:t?.bestRoute?.bridge?.bridgeId,...o&&{defiPlatformId:o}},i=await e.extendSignParams(n),[c,d]=await _(C.post(`${Ki}`,i));if(this.updating=!1,Xr({selector:"#wallet_scroll"}),c){N.error({title:c?.data?.msg||f("swaptrade_top_notif_data_failed")});return}let{callDataResult:m,quoteResult:p}=d?.data||{};if(this.rootStore.quoteStore.handleUpdateQuote({data:p}),m){let g=await this.getPreExecutionPayload(m);ht(()=>{this.transactionPayload=g})}this.initCountDown(),this.startCountdown()});s(this,"updateBridgeGetIntentQuoteCallData",async()=>{let t=eu();this.updating=!0;let[e,o]=await _(C.get(ea,{params:{...t}}));if(this.updating=!1,Xr({selector:"#wallet_scroll"}),e){N.error({title:e?.data?.msg||f("swaptrade_trading_mode_error_no_update")});return}let{quoteResult:r}=o?.data||{};r&&this.rootStore.quoteStore.handleUpdateQuote({data:r}),this.initCountDown(),this.startCountdown()});s(this,"updateSnapQuoteData",async()=>{let t=Nt(),e=this.rootStore?.quoteStore?.quote?.bestRoute?.defiPlatformId;this.updating=!0;let[o,r]=await _(C.get(Zi,{params:{defiPlatformId:e,...t}}));if(this.updating=!1,Xr({selector:"#wallet_scroll"}),o){N.error({title:o?.data?.msg||f("swaptrade_trading_mode_error_no_update")});return}let{quoteResult:n}=r?.data||{};n&&this.rootStore.quoteStore.handleUpdateQuote({data:n}),this.initCountDown(),this.startCountdown()});s(this,"timer",null);s(this,"countdown",ru);s(this,"initCountDown",()=>{this.countdown=ru});s(this,"startCountdown",()=>{this.timer=setTimeout(()=>{let t=this.countdown;if(t===0){this.clearTimer();return}this.countdown=t-1,this.startCountdown()},1e3)});s(this,"clearTimer",()=>{this.timer&&clearTimeout(this.timer)});s(this,"initGasInfo",()=>({gasType:"normal",gasLimit:"0",gasPrice:"0",maxFeePerGas:"0",maxPriorityFeePerGas:"0",supportEip1559:!1,isNetworkFeeLoading:!0,isGasLimitLoading:!0}));s(this,"gasInfo",this.initGasInfo());s(this,"setGasInfo",t=>{this.gasInfo=t});s(this,"gasFee",0);s(this,"setGasFee",t=>{this.gasFee=t});s(this,"orderInfo",{});s(this,"transactionPayload",null);s(this,"solonaRent","");s(this,"getPreExecutionPayload",async(t,e)=>{let{swapStore:o,quoteStore:r}=this.rootStore,n=r?.quote?.bestRoute||{},{fromToken:i}=n,c=Fo(i,{orderData:t},o);if(e){let p=await c.jitoTransaction();return this.solonaRent=Zs(p),p}let{payload:d,rent:m}=await c.preExecution();return i.chainId===V.SOLANA_MAINNET&&m&&(this.solonaRent=m),d});s(this,"setTransactionPayload",t=>{this.transactionPayload=t});s(this,"fetchCallData",async()=>{let{swapStore:t}=this.rootStore||{};t.setCalldataSign(null);let e=t.saveOrderParams(),o=await t.extendSignParams(e);if(!o)return!1;let r=t.isSwapSolana(o.chainId),n,i;if(r){let d=t.extendSolanaCalldata(o);[n,i]=await t.getSolanaCalldata(d)}else[n,i]=await _(C.post(Cr,o));if(n){let d=[90002,10009,50028].includes(Number(n?.code))?n?.error_message:n?.data?.msg;return N.error({title:d||f("swaptrade_top_notif_data_failed")}),!0}let c=await this.getPreExecutionPayload(i?.data||{},r);return this.transactionPayload=c,!1});s(this,"nativeCoin",null);s(this,"setNativeCoin",t=>{this.nativeCoin={...t}});s(this,"calcNativeCoinAmount",()=>{let{coinAmountInt:t,decimals:e}=this.nativeCoin,{from:o,computedIsFromBtcCoin:r}=this.rootStore.fromToStore;return I.BigNumber(r?o.availableBalance:eo(t,e))});s(this,"calcNativeCoinAmountChange",()=>{let t;if(this.type===bt.SWAP){let{fromToStore:o}=this.rootStore;t=o.from}else{let{fromToken:o,fromTokenAmount:r}=this.rootStore.facetStore.facetOrderDetail;t={...o,amount:r}}let e=I.BigNumber(this.gasFee).isNaN()?"0":this.gasFee;return t.isNativeToken?I.BigNumber(t.amount).plus(e):I.BigNumber(e)});s(this,"gasFeeLoading",!0);s(this,"setGasFeeLoading",t=>{this.gasFeeLoading=t});s(this,"gasLimitError",null);s(this,"setGasLimitError",t=>{this.gasLimitError=t});s(this,"activityId",null);s(this,"setActivityId",t=>{this.activityId=t});s(this,"type",bt.SWAP);s(this,"setSwapType",t=>{this.type=t});s(this,"reset",()=>{this.gasInfo=this.initGasInfo(),this.setGasFeeLoading(!1),this.nativeCoin=null,this.transactionPayload=null,this.gasFee=0,this.setGasLimitError(null),this.setStarknetRegisterStatus(""),this.setVisibleStarknetRegister(!1),this.setActivityId(null),this.setSwapType(bt.SWAP),this.clearTimer(),this.solonaRent=""});s(this,"starknetRegisterStatus","");s(this,"setStarknetRegisterStatus",t=>{this.starknetRegisterStatus=t});s(this,"visibleStarknetRegister",!1);s(this,"setVisibleStarknetRegister",t=>{this.visibleStarknetRegister=t});s(this,"onSwap",()=>{oo({...ct(),button_name:"confirm"}),this.rootStore.swapStore.onSwap()});s(this,"onRedeem",()=>{this.rootStore.facetStore.walletSendRedeem()});s(this,"onIntentSwap",()=>{this.rootStore.intentSwapStore.onIntentSwap()});s(this,"confirmSwapMap",{[bt.SWAP]:this.onSwap,[bt.REDEEM]:this.onRedeem,[bt.INTENT_SWAP]:this.onIntentSwap});s(this,"onConfirm",t=>{this.confirmSwapMap[t]?.()});s(this,"getBtnProps",t=>{let{fromToStore:e,quoteStore:o}=this.rootStore,r=o?.computedIsOfflineType,{symbol:n,coinId:i,chainId:c}=this.nativeCoin||{};return{[ce.CONFIRM]:{disabled:this.computedConfirmBtnDisabled,onClick:m=>{this.onConfirm(m)},text:f("swaptrade_card_swap_btn_confirm_swap"),loading:this.computedIsConfirming},[ce.UPDATE]:{onClick:()=>{oo({...ct(),button_name:"update"}),this.updateQuoteData().catch(()=>{})},loading:this.updating,text:f("swaptrade_confirmswap_btn_update_price")},[ce.SNAP_UPDATE]:{onClick:()=>{oo({...ct(),button_name:"update"}),r?this.updateBridgeGetIntentQuoteCallData().catch(()=>{}):this.updateSnapQuoteData().catch(()=>{})},loading:this.updating,text:f("swaptrade_confirmswap_btn_update_price")},[ce.FILL_UP]:{onClick:()=>{va({wallet_address:this.rootStore.accountStore.address,button_name:"fill_up"}),e.baseAddFunds({coinId:i,chainId:c,receiveOnly:!1})},text:f("swaptrade_dialog_btn_supplement",{token:n})}}[t]});L(this),this.rootStore=t}get computedFormatTime(){return Ta(this.countdown)}get computedPriceUpdate(){return this.countdown===0}get computedIsSufficientGas(){if(!this.nativeCoin)return!0;let t=this.calcNativeCoinAmount(),e=this.calcNativeCoinAmountChange();return t.gte(e)}get computedSolonaNativeTokenSufficientRent(){let{quoteStore:t}=this.rootStore,e=t?.quote?.bestRoute||{},{fromToken:o}=e||{};if(o?.chainId!==V.SOLANA_MAINNET||!this.nativeCoin||!this.solonaRent)return!0;let r=this.calcNativeCoinAmount(),n=this.calcNativeCoinAmountChange();return r.gte(n.plus(this.solonaRent))}get walletSendParams(){let{toLocale:t,dispatch:e}=b;return!t||!e?null:{t,dispatch:e}}get computedIsIntentSwap(){return this.rootStore?.quoteStore?.computedIsOfflineType}get compuletedGetNativeCoinLoading(){return this.nativeCoin?this.nativeCoin?.isBalanceLoading:!0}get compuletedGetNativeCoinError(){return this.nativeCoin?this.nativeCoin.isBalanceLoadError:!0}get computedConfirmBtnDisabled(){let{RegisterLocalStatusEnum:t}=b.global,{computedIsStarknetChain:e,computedIsFromBtcCoin:o,computedIsEvmChain:r}=this.rootStore.fromToStore;if(this.computedIsIntentSwap)return!1;if(e&&this.starknetRegisterStatus!==t?.COMPLETED)return!0;let n=this.computedPriceUpdate||!this.computedIsSufficientGas||!this.computedSolonaNativeTokenSufficientRent||this.gasFeeLoading||this.gasLimitError||this.compuletedGetNativeCoinError||this.compuletedGetNativeCoinLoading;return o||!r?n:n||this.gasInfo?.isGasLimitLoading||this.gasInfo?.gasLimitInfo?.queryGasLimitErrorUseDefault}get computedIsConfirming(){let{swapStore:t,intentSwapStore:e}=this.rootStore;return this.computedIsIntentSwap?!!e.isConfirmLoading:t.isConfirmLoading}get computedBtnProps(){let t=ce.CONFIRM;return(!this.computedIsSufficientGas||!this.computedSolonaNativeTokenSufficientRent)&&!this.compuletedGetNativeCoinError&&!this.compuletedGetNativeCoinLoading?t=ce.FILL_UP:this.computedPriceUpdate&&(t=this.computedIsIntentSwap?ce.SNAP_UPDATE:ce.UPDATE),this.getBtnProps(t)}get computedMonitorGasType(){return this.gasInfo?.gasType?{network_fee_details:{gas_level:this.gasInfo?.gasType}}:{}}},zr=en;u();l();P();u();l();P();P();F();u();l();P();P();var nu=(a,t)=>a.filter(({networks:e})=>e.findIndex(r=>r.name===t)>-1),iu=(a,t)=>a.filter(({account:e})=>e[t]),au=({recentAddrData:a,addressBookData:t,walletListData:e,chainName:o})=>{let r=[];if(a.length>0){let n=a.map(({specifiedAddress:i,...c})=>({specifiedAddress:i,...c}));r.push({group:f("swaptrade_extension_wallet_address_recent_address"),list:n})}if(t.length>0){let n=t.map(i=>({...i,specifiedAddress:i.address}));r.push({group:f("swaptrade_extension_wallet_address_connected_wallets"),list:n})}if(e.length){let n=e.map(c=>({specifiedAddress:c.account[o],group:c.keyringName,name:c.walletName,walletId:c.walletId}));Object.entries(On(n,"group")).forEach(([c,d])=>{r.push({group:c,list:d})})}return r},su=a=>String(S(a,"isLeveraged"))==="1",cu=(a,t)=>{let e=[null,null];return su(a)&&(e[0]=a),su(t)&&(e[1]=t),e};var{BigNumber:K}=I,Bo=class{constructor(t){s(this,"defaultToken",{amount:"",prevAmount:"",balance:"",logoURI:"",coinId:"",decimals:"",usdPrice:"",tokenName:"",baseCoinId:"",tokenSymbol:"",tokenLogoUrl:"",isNativeToken:0,tokenContractAddress:"",isSafeMoonToken:"",isHoneypot:"",buyTaxes:"0",sellTaxes:"0",reverseReceiveAmount:"",chainId:""});s(this,"from",{...this.defaultToken,amount:"1"});s(this,"to",this.defaultToken);s(this,"fromBalanceState",nt.BALANCE_NOT_SHOW);s(this,"toBalanceState",nt.BALANCE_NOT_SHOW);s(this,"fromBalanceRequestError",!1);s(this,"toBalanceRequestError",!1);s(this,"isBalanceLoading",!1);s(this,"visibleAddFunds",!1);s(this,"setFrom",t=>{this.from=t});s(this,"setTo",t=>{this.to=t});s(this,"maxDialogType",yo.enough);s(this,"setMaxDialogType",t=>{this.maxDialogType=t});s(this,"checkMaxDialogTypeIsEnough",t=>yo.enough===t);s(this,"typedValue","");s(this,"fromMax",!1);s(this,"independentField",k.FROM);s(this,"singleTypedValue","");s(this,"singleFromMax",!1);s(this,"advanceSetTypedValue",(t="",e=!1,o="")=>{(o||this.commonStore.currentTab)===E.SWAP?(this.singleTypedValue=t,this.singleFromMax=e):this.setTypeInput(t,e)});s(this,"needCrossChainDoubleConfirm",!1);s(this,"setNeedCrossChainDoubleConfirm",t=>{this.needCrossChainDoubleConfirm=t});s(this,"updateBtcFromBalance",async()=>this.computedIsFromBtcCoin?(await this.getTokenBalanceByAccount(k.FROM,q(this.from)),!this.fromBalanceRequestError):!this.fromBalanceRequestError);s(this,"onClickMax",async()=>{Ea({button_name:"max"});let{isNativeToken:t}=this.from;this.setField(k.FROM);let e="",o="";if(t===1){let[r,n]=await Promise.all([this.rootStore.quoteStore.fetchGasTokenFee(),this.updateBtcFromBalance()]);if(!n)return;let{balance:i,availableBalance:c}=this.from,d=(this.computedIsFromBtcCoin?c:i)||"0";if(r===-1)return;o=K(d).minus(r);let m=o.isNegative();this.setMaxDialogType(m?yo.insufficient:yo.enough),m&&this.setShowAddFund(!0),this.showMaxDialog(),this.setShowMaxIcon(!0),e=m?"":o.toString()}else e=this.from.balance;this.advanceSetTypedValue(e,!0)});s(this,"setTypeInput",(t,e)=>{this.typedValue=t,this.fromMax=!!e});s(this,"setField",t=>{this.independentField=t});s(this,"quoteUpdateFromTo",t=>{let{receiveAmount:e="",fromTokenPrice:o="",toTokenPrice:r="",payAmount:n="",inputToTokenPrice:i=""}=t||{};!this.computedIsExactIn&&e?(this.from.amount=n,this.to.amount=this.computedTypedValue,this.to.prevAmount=this.computedTypedValue,this.from.currentTime=new Date().getTime(),this.to.usdPrice=i):this.computedIsExactIn&&(this.from.amount=this.computedTypedValue,this.to.amount=e,this.from.prevAmount=this.computedTypedValue,this.to.currentTime=new Date().getTime(),this.to.usdPrice=r),this.to.reverseReceiveAmount=e,this.from.usdPrice=o});s(this,"checkAndGetTokenInfo",async({chainId:t,tokenContractAddress:e})=>{let[o,r]=await this.getTokenInfoAndBalance(t,e);return o?null:r.data});s(this,"getDexMultiDefaultTokenInfo",t=>{let{chainList:e}=this.commonStore,o=q(e).find(r=>Number(r.chainId)===Number(t??Ro))||{};return{fromDexMultiTokenInfoVO:{...o.dexDefaultFromToTokenShowVO?.fromDexMultiTokenInfoVO,reserveGas:o.reserveGas},toDexMultiTokenInfoVO:o.dexDefaultFromToTokenShowVO?.toDexMultiTokenInfoVO||{}}});s(this,"addressReplaceSymbol",t=>{let{fromDexMultiTokenInfoVO:e}=this.getDexMultiDefaultTokenInfo(t.chainId),{tokenSymbol:o,isNativeToken:r}=e;return r&&this.commonStore.getTokenAddress(t)===this.commonStore.getTokenAddress(e)?o:t?.tokenContractAddress});s(this,"symbolReplaceAddress",t=>this.tokenReplaceMainToken(t).tokenContractAddress);s(this,"validTokens",{});s(this,"fetchTokenInfo",async t=>{if(t.tokenContractAddress){let e=await this.checkAndGetTokenInfo(t);if(e?.tokenContractAddress){let r={...e,balance:e.amountNum,amount:t.amount||""},n=`${e.chainId}_${this.commonStore.getTokenAddress(e)}`;return this.validTokens[n]=!0,r}let o=`${t.chainId}_${this.commonStore.getTokenAddress(t)}`;return this.validTokens[o]=t.tokenContractAddress==fi,null}return null});s(this,"checkQueryToken",async(t,e=!0)=>{if(!H(t.chainId))return null;let o=t;if(Na(this.commonStore.chainList,Number(t.chainId))){let{from:n}=this.getInitializedValue(t.chainId);if(this.commonStore.getTokenAddress(t)===this.commonStore.getTokenAddress(n)&&e){let c=`${n?.chainId}_${this.commonStore.getTokenAddress(n)}`;return this.validTokens[c]=!0,n}let i=await this.fetchTokenInfo({chainId:Number(t.chainId),tokenContractAddress:t.tokenContractAddress});e?o=i||n:o=i}else o=null;return o});s(this,"updateFrom",t=>{(!this.commonStore.equalsToken(t,this.from)||this.from.balance!==t.balance)&&(this.setShowMaxIcon(!1),this.setShowAddFund(!1)),this.from={...q(this.from),...t}});s(this,"updateFromAmount",t=>{this.from.amount=t,t||(this.from.usdPrice="0"),this.from.prevAmount||(this.from.prevAmount=t)});s(this,"updateTo",t=>{this.to={...q(this.to),...t}});s(this,"hideMaxDialog",!!D.get(Ms));s(this,"hideMaxDialogLessGas",!!D.get(Fs));s(this,"setStorageShowMaxDialog",t=>{if(t){let e=this.checkMaxDialogTypeIsEnough(this.maxDialogType);D.set(e?Ms:Fs,"1"),e?this.hideMaxDialog=!0:this.hideMaxDialogLessGas=!0}this.visibleMaxDialog=!1});s(this,"visibleMaxDialog",!1);s(this,"showMaxDialog",()=>{let t=this.checkMaxDialogTypeIsEnough(this.maxDialogType);t&&this.hideMaxDialog||!t&&this.hideMaxDialogLessGas||(this.visibleMaxDialog=!0)});s(this,"showMaxIcon",!1);s(this,"setShowMaxIcon",t=>{this.showMaxIcon=t});s(this,"showAddFund",!1);s(this,"setShowAddFund",t=>{this.showAddFund=t});s(this,"setFromBalanceRequestError",t=>{this.fromBalanceRequestError=t});s(this,"setToBalanceRequestError",t=>{this.toBalanceRequestError=t});s(this,"resetBalanceState",()=>{this.setShowMaxIcon(!1),this.setShowAddFund(!1),[this.fromBalanceRequestError,this.toBalanceRequestError]=[this.toBalanceRequestError,this.fromBalanceRequestError]});s(this,"onSwitchFromTo",async()=>{if(!this.isBalanceLoading){this.rootStore.quoteStore.quoteScope=null;let[t,e]=[q(this.from),q(this.to)];this.resetBalanceState();let o={amount:this.computedTypedValue??"",prevAmount:this.computedTypedValue??"",usdPrice:""},r={amount:"",prevAmount:"",usdPrice:""};this.setNeedCrossChainDoubleConfirm(!0),this.setField(k.FROM),this.computedIsSingleChain?(this.setCacheTokenInfo({chainId:e.chainId,tokenContractAddress:e.tokenContractAddress,amountNum:e.balance},"switchFromTo"),this.setFrom({...e,...o})):(this.rootStore.quoteStore.setQuoteNumber(this.computedTypedValue?0:2),this.setCacheTokenInfo({chainId:e.chainId,tokenContractAddress:e.tokenContractAddress,amountNum:e.balance},"switchFromTo"),this.setFrom({...e,amount:e.amount||"",prevAmount:e.amount||"",usdPrice:""})),this.setTo({...t,...r}),this.advanceSetTypedValue(e.amount),this.rootStore.receiveAddressStore.clearReceiveAddressValue()}});s(this,"getChainInfo",t=>{let{chainList:e}=this.commonStore;return q(e).find(r=>Number(r.chainId)===Number(t))||{}});s(this,"getInitializedValue",(t=Ro)=>{let e=this.getChainInfo(t),{fromDexMultiTokenInfoVO:o,toDexMultiTokenInfoVO:r}=e?.dexDefaultFromToTokenShowVO||{fromDexMultiTokenInfoVO:{},toDexMultiTokenInfoVO:{}},n={...q(o),balance:"",reserveGas:e?.reserveGas},i={...q(r),balance:""};return{from:n,to:i}});s(this,"resetFromTo",async t=>{let{chainList:e,currentTab:o}=this.commonStore,r=o===E.BRIDGE;if(Number(t)!==Number(this.from.chainId)){let n=q(e).find(p=>Number(p.chainId)===Number(t)),{fromDexMultiTokenInfoVO:i,toDexMultiTokenInfoVO:c,toCrossDexMultiTokenInfoVO:d}=n?.dexDefaultFromToTokenShowVO||{fromDexMultiTokenInfoVO:{},toDexMultiTokenInfoVO:{}};this.from={...q(i),balance:"",reserveGas:n?.reserveGas};let m=r&&d||c;this.to={...q(m),balance:""}}});s(this,"clearFromTo",()=>{this.from={},this.to={}});s(this,"updateBalanceIfNativeToken",(t,e)=>{e.isNativeToken?this.getTokenBalanceByAccount(t,e,!1).catch(vn):(this.setFromBalanceRequestError(!1),this.setBalance(t,e.amountNum))});s(this,"getSwapTokenBalance",(t=!1)=>{this.getTokenBalanceByAccount(k.FROM,q(this.from),t).catch(()=>{}),this.getTokenBalanceByAccount(k.TO,q(this.to),t).catch(()=>{})});s(this,"getTokenInfoAndBalance",async(t,e)=>{let o=this.accountStore.getAddressByChainId(t),r={chainId:t,tokenAddress:e,userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,userWalletAddress:o,businessType:this.commonStore.computedCurrentTabIsLimit?Ds.LIMIT_ORDER:Ds.SWAP_ORDER};return _(C.get(Tr,{params:r}))});s(this,"needBalanceLoading",!0);s(this,"setNeedBalanceLoading",t=>{this.needBalanceLoading=t});s(this,"getTokenBalanceByAccount",async(t,e,o=!1)=>{let r=t===k.FROM,{chainId:n,tokenContractAddress:i}=e;if(H(n)&&i&&this.accountStore.computedAccountId){this.needBalanceLoading&&(this.isBalanceLoading=!0);let c=await this.getTokenInfoAndBalance(n,i);if(this.isBalanceLoading=!1,this.setNeedBalanceLoading(!0),!this.commonStore.equalsToken(e,r?this.from:this.to))return;if(c[0]){if(o){this.fromBalanceRequestError=!1,this.toBalanceRequestError=!1;return}r?(this.fromBalanceRequestError=!0,this.fromBalanceState=nt.BALANCE_REQUEST_FAILED):(this.toBalanceRequestError=!0,this.toBalanceState=nt.BALANCE_REQUEST_FAILED),this.setBalance(t,"0","0","0");return}r?this.fromBalanceRequestError=!1:this.toBalanceRequestError=!1;let{amountNum:d,availableAmountNum:m,currencyAmount:p}=c[1]?.data||{};r&&this.setCacheTokenInfo({chainId:n,tokenContractAddress:i,amountNum:d},"api"),this.setBalance(t,d,m,p)}});s(this,"cacheTokenInfo",{});s(this,"setCacheTokenInfo",(t,e)=>{this.cacheTokenInfo=t,A.info(v.GET_BALANCE,{...this.cacheTokenInfo,type:e})});s(this,"setBalance",(t,e="",o="",r="")=>{let n=t===k.TO,i={balance:e,availableBalance:o,currencyAmount:r};n?this.updateTo({...this.to,...i}):this.updateFrom({...this.from,...i})});s(this,"setBalanceState",t=>{let{amount:e,address:o,from:r,to:n}=t;Boolean(o)&&Boolean(r.tokenContractAddress)?this.fromBalanceRequestError===!0?this.fromBalanceState=nt.BALANCE_REQUEST_FAILED:K(r.balance||"0").lt(e||"0")?this.fromBalanceState=nt.BALANCE_INSUFFICIENT:this.fromBalanceState=nt.COMMON:this.fromBalanceState=nt.BALANCE_NOT_SHOW,!(Boolean(o)&&Boolean(n.tokenContractAddress))||!this.computedIsToAddressEqualsCurrentToAddress&&this.computedDiffCrossChain?this.toBalanceState=nt.BALANCE_NOT_SHOW:this.toBalanceRequestError===!0?this.toBalanceState=nt.BALANCE_REQUEST_FAILED:this.toBalanceState=nt.COMMON});s(this,"updateFromBalancePush",t=>{let{coinAmountOriginalDec:e,availableAmountNum:o,currencyAmount:r}=t;this.commonStore.equalsToken(this.from,t)?(this.setCacheTokenInfo({chainId:t.chainId,tokenContractAddress:t.tokenContractAddress,amountNum:e},"ws"),this.setBalance(k.FROM,e,o,r)):this.commonStore.equalsToken(this.to,t)&&this.setBalance(k.TO,e,o,r)});s(this,"tokenReplaceMainToken",t=>{let e=t,{fromDexMultiTokenInfoVO:o}=this.getDexMultiDefaultTokenInfo(t?.chainId),{tokenSymbol:r,chainId:n}=o;return H(t?.chainId)&&t?.tokenContractAddress&&(this.commonStore.getTokenAddress(t)===(this.commonStore.isSensitiveChain(n)?r:he(r))||this.commonStore.getTokenAddress(t)===this.commonStore.getTokenAddress(o))&&(e={...o,amount:t.amount}),e});s(this,"onClickAddFunds",()=>{let{tokenSymbol:t,chainName:e}=this.from,{address:o}=this.accountStore,r={currency:t,network:e,address:o};this.getDeposit(r)});s(this,"calOrderUpdateFromTo",t=>{let{fromTokenUsd:e,toTokenUsd:o,fromAmount:r,toAmount:n}=t||{};go(r)||(this.from.amount=r),go(e)||(this.from.usdPrice=e),go(n)||(this.to.amount=n),go(o)||(this.to.usdPrice=o)});s(this,"isEvmChain",t=>H(t)?this.commonStore.getChainByID(t)?.chainType!==oi.NO_EVM_CHAIN:!0);s(this,"isTronChain",t=>t===V.TRON_MAINNET);s(this,"getFormatFromToToken",async({from:t,to:e},o)=>{let[r,n]=await Promise.all([this.checkQueryToken(t,o),this.checkQueryToken(e,o)]),i=r,c=n,d=m=>`${m?.chainId}-${m?.tokenContractAddress}`;if(r){let m=this.getInitializedValue(r?.chainId),p=fo(Rs([r,n,m.from,m.to],d));i=p[0],c=p[1]}else if(n){let m=this.getInitializedValue(n.chainId),p=fo(Rs([n,m.from,m.to],d));i=p[1],c=p[0]}return{token1:i,token2:c}});s(this,"orderContinueStatus",et.DEFAULT);s(this,"setOrderContinueStatus",t=>{this.orderContinueStatus=t});s(this,"fillSwapFromTo",async({apiRequestParams:t,locationParams:e})=>{let{closeModal:o}=this.rootStore.recentTransactionStore;!await this.beforeCheckAndGetTokenInfo(t,e)||(o(),this.setSwapAndLimitTypeValue(e.inputAmount))});s(this,"beforeCheckAndGetTokenInfo",async(t,e)=>{let{orderCheckContinue:o}=this.rootStore.oneMoreOrderStore;if(this.setOrderContinueStatus(et.LOADING),t&&!await o(t))return this.setOrderContinueStatus(et.ERROR),!1;let{token1:r,token2:n}=await this.getFormatFromToToken(e,!1);return!r||!n?(N.error({title:f("swaptrade_history_toast_setup_error"),duration:Pt}),this.setOrderContinueStatus(et.ERROR),!1):(this.setOrderContinueStatus(et.READY),this.updateFromAndToInfo(r,n),!0)});s(this,"beforeCheckUrl",async t=>{this.setOrderContinueStatus(et.LOADING);let{orderCheckContinue:e}=this.rootStore.oneMoreOrderStore;return await e(t)?(this.setOrderContinueStatus(et.READY),!0):(this.setOrderContinueStatus(et.ERROR),!1)});s(this,"updateFromAndToInfo",(t,e)=>{this.updateFrom(t),this.updateTo(e)});this.rootStore=t,this.accountStore=t.accountStore,this.commonStore=t.commonStore}get computedTypedValue(){return this.commonStore.currentTab===E.SWAP?this.singleTypedValue:this.typedValue}get computedFromMax(){return this.commonStore.currentTab===E.SWAP?this.singleFromMax:this.fromMax}get computedNeedCrossChainDoubleConfirm(){return this.computedIsSingleChain?!1:!this.needCrossChainDoubleConfirm}get dependentField(){return this.independentField===k.FROM?k.TO:k.FROM}get computedIsExactIn(){return this.independentField===k.FROM}get computedIsSingleChain(){return H(this.from.chainId)&&H(this.to.chainId)&&Number(this.from.chainId)===Number(this.to?.chainId)}get computedSwapAmount(){return{[this.independentField]:this.computedFromMax?Ce(this.computedTypedValue,{noNeedThousandth:!0}):this.computedTypedValue,[this.dependentField]:this.computedCalAmount[this.dependentField]}}get computedCalAmount(){return{[k.FROM]:Ce(this.from?.amount,{noNeedThousandth:!0})??"",[k.TO]:Ce(this.to?.amount,{noNeedThousandth:!0})??""}}get computedIfQuote(){return!!(this.computedTypedValueIsValid&&this.from&&this.to)}get computedTypedValueIsValid(){return!K(this.computedTypedValue).isZero()&&!K(this.computedTypedValue).isNaN()}get computedFromAmountIsValid(){let{amount:t}=this.from;return Kt(t)}get computedFromLocalCostByUsd(){let{usdPrice:t}=this.from;if(!this.computedFromAmountIsValid)return"";let{nowCurrencyUnit:e}=this.commonStore,{symbol:o,usdToThisRate:r}=e,n=K(t);if(o&&t&&r&&!n.isNaN()){let c=n.multipliedBy(r).toString();return St(c,o,{needBillionMillionUnit:!1})}return""}get computedToLocalCostByUsd(){let{usdPrice:t}=this.to,{nowCurrencyUnit:e}=this.commonStore,{symbol:o,usdToThisRate:r}=e,n=K(t);if(o&&t&&r&&this.to.amount&&!n.isNaN()&&Kt(this.from.amount)){let c=n.multipliedBy(r).toString();return St(c,o,{needBillionMillionUnit:!1})}return""}get computedRate(){let{from:t,to:e,computedIsExactIn:o}=this,{quoteStore:r,gasDropStore:n}=this.rootStore,i=S(r,"quote.bestRoute.gasDropFromAmount",""),c=i&&n?.gasDropConfig?.gasDrop?K(t?.amount).minus(i):K(t?.amount),d=e?.reverseReceiveAmount&&o||!o&&t?.amount;return c&&d?Z(K(e?.reverseReceiveAmount).div(c).toString(10),{needBillionMillionUnit:!1}):""}get computedToFromRate(){let{from:t,to:e,computedIsExactIn:o}=this,{quoteStore:r,gasDropStore:n}=this.rootStore,i=S(r,"quote.bestRoute.gasDropFromAmount",""),c=i&&n?.gasDropConfig?.gasDrop?K(t?.amount).minus(i):K(t?.amount),d=e?.reverseReceiveAmount&&o||!o&&t?.amount;return c&&d?Z(K(c).div(e?.reverseReceiveAmount).toString(10),{needBillionMillionUnit:!1}):""}get computedIsToAddressEqualsCurrentToAddress(){let t=this.accountStore.getAddressByChainId(this.to.chainId);return t&&this.rootStore.receiveAddressStore.computedReceiveAddr===t}get computedValueDifference(){let{quoteStore:t}=this.rootStore,{usdPrice:e}=this.from,{usdPrice:o,currentTime:r}=this.to,n=S(t,"quote.bestRoute.gasDropFromAmount",""),i=S(t,"quote.bestRoute.fromTokenAmount",""),c=oe(e),d=qs(e),m=oe(o),p=qs(o);if(c||d||m||p)return{isUp:!1,diff:"",isOver:!1,nowTime:new Date().getTime()};let g=n?K(e).div(K(i))*K(n):"";e=n?e-g:e;let T=K(o).minus(e).div(e).multipliedBy(100),y=K(T.toFixed(2,1));if(y.gt(-.1)&&y.lt(.1))return null;let M=T.isNegative()?"":"+",O="";return T.gt(100)?O=`>${M}${Bt(100,{needZero:!1})}`:T.lt(-100)?O=`<${M}${Bt(100,{needZero:!1})}`:O=`${M}${Bt(y.toString(10),{needZero:!1})}`,{isUp:T.gte(0),diff:O,isOver:T.lte(-10),currentTime:r,specialValueRangePrompt:T.gt(-10)&&T.lt(10),value:`${K(T.toFixed(2,1)).toString(10).replace(/\+|-/,"")}`}}get computedIsCrossChain(){return H(this.from.chainId)&&H(this.to.chainId)&&Number(this.from.chainId)!==Number(this.to?.chainId)}get computedIsBridge(){let{from:t,to:e}=this;return this.computedIsCrossChain&&t.tokenSymbol===e.tokenSymbol}getDeposit(){}get computedDiffCrossChain(){let t=!!this.accountStore.address,e=this.commonStore.getChainByID(this.from.chainId),o=this.commonStore.getChainByID(this.to.chainId),r=String(this.from.isHoneypot),n=String(this.to.isHoneypot),{computedNonsupportChain:i}=this.accountStore,c=e?.crossChainType||"",d=o?.crossChainType||"";return t&&!i&&r!=="1"&&n!=="1"&&c&&d&&c!==d}get computedMaxTipsText(){let{from:t,maxDialogType:e}=this,{cacheNativeGasFee:o}=this.rootStore.quoteStore;if(!t.isNativeToken||!o||!t.tokenSymbol)return f("wallet_swap_toast_reserve_mainnet_token");let r={value:Z(o),tokenSymbol:t.tokenSymbol};if(this.checkMaxDialogTypeIsEnough(e)){if(this.computedIsFromBtcCoin&&I.gt(this.computedUnavailableBalance,0)){let n=Z(this.computedUnavailableBalance);return f("swaptrade_dialog_pay_card_reserved_from_wallet",{symbol:r.tokenSymbol,value:r.value,unablevalue:n})}return f("swaptrade_dialog_desc_reserved_netfee",r)}return f("swaptrade_dialog_desc_please_reserve",r)}get computedShowAddFund(){let{accountStore:t,swapBtnStore:e}=this.rootStore,{from:o}=this;return!t.computedNonsupportChain&&(this.independentField===k.FROM&&K(this.computedTypedValue||0).gt(K(o.balance||0))||e.computedTooBalance)||this.showAddFund&&!this.checkMaxDialogTypeIsEnough(this.maxDialogType)}get computedIsEvmChain(){return this.isEvmChain(this.from.chainId)}get computedDefaultAutoSlippageInfo(){let t=this.commonStore.getChainByID(this.from.chainId);return{autoSlippage:t?.toleranceSlippage?.selectItem,autoTotalSlippage:t?.crossToleranceSlippage?.selectItem}}get computedIsSolanaChain(){return xr(this.from.chainId)}get computedIsAptosChain(){return ic(this.from.chainId)}get computedIsTronChain(){return Pr(this.from.chainId)}get computedIsSuiChain(){return rc(this.from.chainId)}get computedIsStacksChain(){return sc(this.from.chainId)}get computedIsStarknetChain(){return nc(this.from.chainId)}get computedHasToSwap(){let t=S(this.rootStore.quoteStore,"quote.bestRoute.toSwapFeeUsd");return this.computedIsCrossChain&&t>0}setSwapAndLimitTypeValue(t){let{computedCurrentTabIsLimit:e}=this.commonStore,{clearSellAndReceive:o}=this.rootStore?.limitOrderControlStore||{};e?o?.():Kt(t)?(this.setField(k.FROM),this.advanceSetTypedValue(t)):this.advanceSetTypedValue("")}get computedLeverageTokenPair(){return cu(this.from,this.to)}get computedFormToTokenIsLeverageToken(){let[t,e]=this.computedLeverageTokenPair;return!!t||!!e}get computedIsFromBtcChain(){return oc(this.from.chainId)}get computedIsFromBtcCoin(){return this.computedIsFromBtcChain&&this.from.isNativeToken}get computedUnavailableBalance(){return K(this.from.balance).minus(this.from.availableBalance).toString()}get computedIsFacetToken(){let{from:t,to:e}=this;return Number(t.tokenType)===$e.FACET||Number(e.tokenType)===$e.FACET}get computedNonsupportFacetToken(){let{address:t,walletConfig:{OKXWalletType:e,walletType:o}}=this.accountStore;if(!t)return!1;let r=[Zt.MNEMONIC,Zt.PRIVATE_KEY].includes(e),n=o===dr.METAMASK;return this.computedIsFacetToken&&!(r||n)}};var xe=class extends Bo{constructor(e){super(e);s(this,"getDeposit",()=>()=>{});s(this,"addFundsParams",{});s(this,"closeAddFunds",()=>{this.visibleAddFunds=!1});s(this,"onClickAddFunds",()=>{let{tokenSymbol:e,chainName:o,tokenLogoUrl:r,chainId:n,isNativeToken:i,tokenContractAddress:c}=this.from;this.visibleAddFunds=!0;let d={currency:e,network:o,iconUrl:r,chainId:n,isNativeToken:i,tokenContractAddress:i?"":c,receiveOnly:!0};this.baseAddFunds(d)});s(this,"baseAddFunds",e=>{this.visibleAddFunds=!0,this.addFundsParams={...e}});s(this,"tokenReplaceMainToken",(e,o)=>{let r=e,n=!Rr(e),{fromDexMultiTokenInfoVO:i}=this.getDexMultiDefaultTokenInfo(n?o:e.chainId),{tokenSymbol:c,chainId:d}=i;return!n&&(this.commonStore.getTokenAddress(e)===(this.commonStore.isSensitiveChain(d)?c:he(c))||this.commonStore.getTokenAddress(e)===this.commonStore.getTokenAddress(i))&&(r={...i,amount:e.amount}),r});ut(this),Et(()=>{let{computedDiffCrossChain:o,to:r}=this;return{computedDiffCrossChain:o,toChainId:r?.chainId}},({computedDiffCrossChain:o,toChainId:r})=>{this.cacheToChainId!==r&&this.rootStore.receiveAddressStore.saveReceiveAddressValue({}),this.rootStore.receiveAddressStore.setCacheToChainId(o&&r?r:-1)},{equals:zt.shallow})}};u();l();P();u();l();F();var on=class{constructor(t){s(this,"signIntentSwap",async()=>[]);s(this,"createIntentOrder",async t=>{let e={intentCode:t.offlineType,signature:t.signature,quote:t?.quote,userWalletAddress:this.rootStore?.accountStore?.address,defiPlatformId:t.defiPlatformId},[o,r]=await _(C.post(ta,{...e}));return o&&(A.error(v.INTENT_ORDER_CREATE_ERROR,{error:o}),N.error({title:o?.error_message||f("swaptrade_trading_mode_alert_order_fail")})),ro({...ct(),order_id:r?.data?.orderId,wallet_type:this.rootStore?.accountStore.walletConfig?.walletType}),[o,r]});s(this,"bridgeSumbitIntentOrder",async t=>{let{slippageStore:e,quoteStore:o,receiveAddressStore:r,fromToStore:n,accountStore:i}=this.rootStore,{quote:c,computedQuoteAmount:d}=o,{from:m,to:p}=n,{computedMinimumReceived:g,computedRealSlippageValue:T}=e,y=r?.receiveAddrObj?.specifiedAddress,w=T,M=c?.bestRoute?.bridge?.bridgeId,O=i?.address,lt={signature:t.signature,quote:t?.quote,defiPlatformId:t.defiPlatformId,receiveWalletAddress:y,fromChainId:m?.chainId,fromTokenAddress:m?.tokenContractAddress,fromAmount:d,toChainId:p.chainId,toTokenAddress:p.tokenContractAddress,toAmount:p.reverseReceiveAmount,walletAddress:O,bridgeId:M,minimumReceived:g,slippage:w},[ot,At]=await _(C.post(oa,{...lt}));return ot&&(A.error(v.INTENT_ORDER_CREATE_ERROR,{error:ot}),N.error({title:ot?.error_message||f("swaptrade_trading_mode_alert_order_fail")})),ro({...ct(),order_id:At?.data?.orderId,wallet_type:this.rootStore?.accountStore.walletConfig?.walletType}),[ot,At]});this.rootStore=t}},uu=on;u();l();var lu=xt(["isConfirmLoading"],[]);var rn=class extends uu{constructor(e){super(e);s(this,"isConfirmLoading",!1);s(this,"setIsConfirmLoading",e=>{this.isConfirmLoading=e});s(this,"signIntentSwap",async(e,o)=>{let{signTransaction:r}=this.rootStore.sendTransactionStore,[n,i]=await r(o,e);return n&&(A.error(v.INTENT_SWAP_SIGN_ERROR,{error:n,msg:{chainId:e,unsignedTx:o}}),N.error({title:f("swaptrade_trading_mode_alert_order_fail")})),[n,i]});s(this,"onIntentSwap",async()=>{let{quoteStore:e}=this.rootStore;if(e?.computedIsOfflineType){await this.onIntentBridgeOrder();return}await this.onIntentSwapOrder()});s(this,"onIntentSwapOrder",async()=>{this.setIsConfirmLoading(!0),A.keepLive();let{swapStore:e,quoteStore:o}=this.rootStore,r=S(o,"quote.bestRoute.fromToken.chainId");try{let{offlineType:n,calldata:i,defiPlatformId:c}=o?.quote.bestRoute,{quote:d,unsignedTx:m}=i||{};if(!d||!m)return;let[p,g]=await this.signIntentSwap(r,m);if(p)return;let[T,y]=await this.createIntentOrder({quote:d,offlineType:n,signature:g,defiPlatformId:c});if(T)return;e.afterTransaction(y.data?.orderId)}catch(n){A.error(v.INTENT_SWAP_PROCESS_ERROR,{error:n})}finally{this.setIsConfirmLoading(!1),A.removeKeep()}});s(this,"onIntentBridgeOrder",async()=>{this.setIsConfirmLoading(!0),A.keepLive();let{swapStore:e,quoteStore:o}=this.rootStore,r=S(o,"quote.bestRoute.fromToken.chainId");try{let{bridge:n}=o?.quote.bestRoute,{calldata:i,defiPlatformId:c}=n,{quote:d,unsignedTx:m}=i||{};if(!d||!m)return;let[p,g]=await this.signIntentSwap(r,m);if(p)return;let[T,y]=await this.bridgeSumbitIntentOrder({quote:d,signature:g,defiPlatformId:c});if(T)return;e.afterTransaction(y.data?.orderId)}catch(n){A.error(v.INTENT_SWAP_PROCESS_ERROR,{error:n})}finally{this.setIsConfirmLoading(!1),A.removeKeep()}});Rt(this,lu)}},Jr=rn;u();l();u();l();F();var sn=class{constructor(t){s(this,"receiveAddrStatus",Ye.NORMAL);s(this,"receiveAddrObj",{});s(this,"saveReceiveAddressValue",t=>{this.receiveAddrObj=this.filterReceiveWalletInfo(t),t?.specifiedAddress||this.initCheckAddrStatus()});s(this,"clearReceiveAddressValue",()=>{this.receiveAddrObj={},this.initCheckAddrStatus(),this.walletAddrInWeb3=[],this.getLinkedWalletAddrInWeb3().catch(()=>{})});s(this,"checkReceiveAddressLoading",!1);s(this,"filterReceiveAddress",(t,e,o=!0)=>{let r=e?.specifiedAddress||this.receiveAddrObj?.specifiedAddress||"";return r?t.filter(({specifiedAddress:n})=>o?n.includes(r):n===r):t});s(this,"filterReceiveWalletInfo",t=>{if(!t.specifiedAddress||t.walletId)return t;let e=this.filterReceiveAddress(this.initWalletAddrListFromChain,t,!1);return e.length?e[0]:t});s(this,"initCheckAddrStatus",()=>{this.checkReceiveAddressLoading=!1,this.receiveAddrStatus=Ye.NORMAL});s(this,"checkReceiveAddr",async t=>{if(t||this.receiveAddrObj.specifiedAddress){this.checkReceiveAddressLoading=!0;let{to:e}=this.rootStore.fromToStore;try{let o=await Wa(e?.chainId,t||this.computedReceiveAddr),r=Symbol("requestId");if(this.currentRequestId=r,o){let{data:n}=await C.get(Hi,{params:{address:t||this.receiveAddrObj.specifiedAddress,chainId:e?.chainId}});this.currentRequestId===r&&ht(()=>{this.receiveAddrStatus=n.status})}else ht(()=>{this.receiveAddrStatus=Ye.ILLEGALITY})}catch(o){A.stuff(o),this.receiveAddrStatus=Ye.ILLEGALITY}finally{this.checkReceiveAddressLoading=!1}}else this.initCheckAddrStatus()});s(this,"getSpecifiedChainWalletList",async t=>{let e=await this.getSpecifiedChainWalletListByWeb3(t),o={};return e?.forEach(r=>{let{specifiedAddress:n,walletType:i,createTime:c}=r,d=i===dr.OKEXCHAIN;o[n]&&o[n]?.has&&d?o[n].walletInfo.createTime<c&&(o[n].walletInfo=r):(!o[n]?.has||d)&&(o[n]={walletInfo:r,has:d})}),Object.keys(o).map(r=>o[r].walletInfo)});s(this,"walletAddrInWeb3",[]);s(this,"getLinkedWalletAddrInWeb3",async()=>{let{computedDiffCrossChain:t,to:e}=this.rootStore.fromToStore,{computedAccountId:o}=this.rootStore.accountStore;if(!t)return;let[r,n]=await _(this.getSpecifiedChainWalletList({chainId:e.chainId,walletIds:[o]}));r||ht(()=>{this.walletAddrInWeb3=n})});s(this,"initWalletAddrListFromChain",[]);s(this,"initWalletAddrListInStorage",[]);s(this,"filterWalletAddrListFromChain",[]);s(this,"filterWalletAddrListInStorage",[]);s(this,"getWalletList",async()=>{let{to:t}=this.rootStore.fromToStore,e=await this.getSpecifiedChainWalletList({chainId:t.chainId});ht(()=>{this.initWalletAddrListFromChain=e,this.filterWalletAddrListFromChain=e;let o=D.get(ko);if(o){let r=o[t.chainId]||[];this.initWalletAddrListInStorage=r,this.filterWalletAddrListInStorage=r}})});s(this,"getFilteredAddrList",t=>{this.filterWalletAddrListFromChain=this.filterReceiveAddress(this.initWalletAddrListFromChain,t),this.filterWalletAddrListInStorage=this.filterReceiveAddress(this.initWalletAddrListInStorage,t)});s(this,"saveWalletAddressToStorage",t=>{this.receiveAddrObj?.specifiedAddress&&D.set(ko,{[t.chainId]:[this.receiveAddrObj]})});s(this,"formatInputValue",t=>{let{specifiedAddress:e,deriveName:o,label:r}=t;if(e.length<=9)return e;let n=Er(t.specifiedAddress);return o&&(n=`(${n})`,r?n=`${o} - ${r} ${n}`:n=`${o} ${n}`),n});this.rootStore=t}get computedSwapHighLight(){return this.receiveAddrStatus===Ye.NORMAL&&!!this.receiveAddrObj?.specifiedAddress}get computedFormatReceiveAddr(){return this.receiveAddrObj?.specifiedAddress?this.formatInputValue(this.receiveAddrObj):""}get computedReceiveAddr(){return this.receiveAddrObj?.specifiedAddress||""}setReceiveAddress(t){this.receiveAddress=t}getReceiveAddress(){return this.receiveAddress}async getSpecifiedChainWalletListByWeb3(){return[]}get computedWalletAddrInWeb3(){return this.walletAddrInWeb3.length?this.walletAddrInWeb3[0]:null}get isFromFilterAddress(){let t=this.filterReceiveAddress(this.initWalletAddrListFromChain,this.receiveAddrObj?.specifiedAddress,!1),e=this.filterReceiveAddress(this.initWalletAddrListInStorage,this.receiveAddrObj?.specifiedAddress,!1);return!!(t.length+e.length)&&!!this.receiveAddrObj?.specifiedAddress}},du=sn;var nn=class extends du{constructor(e){super(e);s(this,"formatInputValueEx",(e,o)=>{let{keyringName:r,walletName:n}=e;if(o.length<=9)return o;let i=Er(o);return r&&(i=`(${i})`,n?i=`${r} - ${n} ${i}`:i=`${r} ${i}`),i});s(this,"cacheToChainId",-1);s(this,"setCacheToChainId",e=>{this.cacheToChainId=e});s(this,"addressListEx",[]);s(this,"getWalletListEx",()=>{let{accountStore:e,fromToStore:o}=this.rootStore,r=b.getNetWorkName(o.to.chainId),{walletList:n,addressBookList:i,keyringIdentityTypeEnum:c}=e,m=(D.get(ko)||{})[o.to.chainId]||[],p=nu(i,r),g=iu(n,r);this.addressListEx=au({recentAddrData:m,addressBookData:p,walletListData:g,chainName:r,keyringIdentityTypeEnum:c})});ut(this)}get computedFormatReceiveAddrEx(){let{accountStore:e,fromToStore:o}=this.rootStore,{walletConfig:r}=e;if(this.receiveAddrObj.specifiedAddress)return this.formatInputValueEx(this.receiveAddrObj,this.receiveAddrObj.specifiedAddress);let n=b.getNetWorkName(o.to.chainId),i=r?.account[n];return i?(this.receiveAddrObj={...r,specifiedAddress:i},this.formatInputValueEx(r,i)):""}},Zr=nn;u();l();F();u();l();var an=class{constructor(t){s(this,"updateTxHash",t=>(A.info(v.UPDATE_HASH,{...t,tags:{orderId:t.orderId,status:t?.status||1}}),C.post(bi,t).catch(e=>{A.info(v.UPDATE_HASH_ERROR,{...t,error:e,tags:{orderId:t.orderId}})})));s(this,"cancelOrder",t=>(A.info(v.CANCEL_ORDER,{tags:{orderId:t}}),C.get($i,{params:{id:t}})));this.rootStore=t}},mu=an;var cn=class extends mu{constructor(){super(...arguments);s(this,"sendTransaction",async(...e)=>b.global?.signAndSubmitTransaction(...e));s(this,"sendTransactionEnhance",async(...e)=>this.sendTransaction(...e));s(this,"signTransaction",async(e,o)=>{let[r,n]=await _(b.global.signTypedDataV4(o,e));return[r,n]})}async signSolanaTransactionWithMeme(e,o){let{calldataParams:r}=e;return await Promise.all(o.map(i=>b.global.signSolanaCommonTransaction({fromAddress:r.userWalletAddress,instanceType:i.payload.version,serializedMessage:i.inputData,needToReplaceRecentBlockhash:!1})))}},co=cn;u();l();P();u();l();F();u();l();P();P();var un=class{constructor(t){s(this,"rootStore");this.rootStore=t}checkZeroValue(){let t=null,o=this.rootStore.quoteStore.quote.bestRoute,{fromTokenPrice:r,toTokenPrice:n,fromToken:i,toToken:c}=o;return!Number(r)&&!Number(n)?t=i.tokenSymbol===c.tokenSymbol?Q.ALIKE_TOKEN_SYMBOL_PRICE_UNKNOWN:Q.ALL_TOKEN_PRICE_UNKNOWN:Number(r)?Number(n)||(t=Q.TO_TOKEN_PRICE_UNKNOWN):t=Q.FROM_TOKEN_PRICE_UNKNOWN,{errorType:t,continueToNextInterceptor:!1}}checkValueDifference(){let t=null,{fromToStore:e}=this.rootStore,{computedValueDifference:o,computedIsCrossChain:r}=e;return o?.isOver&&(t=r?Q.VALUE_DIFFERENCE_TOO_MUCH_CROSS:Q.VALUE_DIFFERENCE_TOO_MUCH),{errorType:t,continueToNextInterceptor:!1}}checkMinReceive(){let t=null,e=this.rootStore.quoteStore,o=this.rootStore.slippageStore;return e?null:(o?.computedMinimumReceivedIsOrange&&(t=Q.MIN_RECEIVED_TOO_SMALL),{errorType:t,continueToNextInterceptor:!1})}checkRepeatOrderWithEnoughBalance(){let t=null,{swapCheckStore:e}=this.rootStore,{repeatOrder:o}=e;return o?.enoughFlag===ws.ENOUGH&&(t=Q.REPEAT_ORDER),{errorType:t,continueToNextInterceptor:!1}}async checkBlockedRepeatOrder(){let t=null,{swapCheckStore:e}=this.rootStore;await e.checkRepeatOrder();let{repeatOrder:o}=e;return o&&(o.repeatFlag===ge.BTC_REPEAT?t=Q.REPEAT_ORDER_BTC:o.repeatFlag===ge.FACET_REPEAT?t=Q.REPEAT_ORDER_FACET:o.enoughFlag!==ws.ENOUGH&&(t=Q.REPEAT_ORDER_NOT_ENOUGH)),{errorType:t,continueToNextInterceptor:!1}}checkFacetTokenCrossChainDetail(){let{fromToStore:t}=this.rootStore,{from:e,to:o,computedNonsupportFacetToken:r}=t;if(r||D.get(mi))return null;let n=null;return e.tokenType!==o.tokenType&&(Number(e.tokenType)===$e.FACET||Number(o.tokenType)===$e.FACET)&&(n=Q.FACET_SWAP_TIPS),{errorType:n,continueToNextInterceptor:!1}}checkCrossChain(){let t=null;return this.rootStore.fromToStore.computedNeedCrossChainDoubleConfirm&&!D.get(ni)&&(t=Q.CROSS_CHAIN_DOUBLE_CONFIRM),{errorType:t,continueToNextInterceptor:!1}}checkGasMoreThanReceive(){let t=null,{fromToStore:e,quoteStore:o}=this.rootStore,{computedIsCrossChain:r}=e,n=o.quote.bestRoute,{toTokenPrice:i,quoteNetWorkFeeOfMoney:c,fromSwapFeeUsd:d}=n,{BigNumber:m}=I;return(r?new m(d):new m(c)).gte(new m(i))&&(t=Q.GAS_MORE_THAN_RECEIVE_VALUE),{errorType:t,continueToNextInterceptor:!1}}checkToSwapThanGasFee(){let t=null,{fromToStore:e,quoteStore:o}=this.rootStore,{computedHasToSwap:r}=e,n=Number(e.to.chainId)===1;if(r&&n){let i=S(o,"quote.bestRoute.toSwapFeeUsd"),c=S(o,"quote.bestRoute.bridge.bridgeAmountOutUsd"),d=S(o,"quote.bestRoute.bridge.toRiskLimit");I.BigNumber(i).dividedBy(c).gte(d)&&(t=Q.TO_SWAP_THAN_GAS_FEE)}return{errorType:t,continueToNextInterceptor:!1}}checkVolatilitySlippage(){let t=null,o=this.rootStore.slippageStore.computedVolatilityTips?.swapInterceptorType;return o&&(t=o),{errorType:t,continueToNextInterceptor:!0}}async checkBtcBalance(){let{fromToStore:t,safeMoonStore:e}=this.rootStore,{computedIsFromBtcCoin:o,from:r,updateBtcFromBalance:n}=t;if(o){if(!await n())throw Error("btc balance update failed");let c=e.computedInputVal,d=r.availableBalance;if(I.BigNumber(c).gt(d))return{errorType:Q.BTC_AVAILABLE_BALANCE_NOT_ENOUGH,continueToNextInterceptor:!1}}return null}async checkCrossChainSwap(){let{swapCheckStore:t}=this.rootStore;await t.checkCrossChainSwap();let e=t.checkSwapMoreInfo?.errorCode;return xn(e)&&e!==0?e===4&&D.get(`${ir}_${t.checkSwapMoreInfo?.contentTip?.extra?.bridgeName}_${e}`)||D.get(`${ir}_${e}`)?null:{errorType:Q.CHECK_CROSS_MORE,continueToNextInterceptor:!1}:null}async checkThirdPartyProvider(){let{quoteStore:t}=this.rootStore,{computedIsOkxProvider:e}=t,o=D.get(`${ir}_${si}`);return!e&&!o?{errorType:Q.THIRD_PARTY_PROVIDER,continueToNextInterceptor:!0}:null}async checkBridgeThirdPartyProvider(){let{quoteStore:t}=this.rootStore,{computedBridgeIsOkxProvider:e,computedIsOfflineType:o}=t;return!e&&o?{errorType:Q.THIRD_PARTY_PROVIDER,continueToNextInterceptor:!0}:null}makeCheckers(){let{fromToStore:{computedIsCrossChain:t}}=this.rootStore;return t?[this.checkBridgeThirdPartyProvider,this.checkVolatilitySlippage,this.checkCrossChainSwap,this.checkBtcBalance,this.checkZeroValue,this.checkToSwapThanGasFee,this.checkValueDifference,this.checkMinReceive,this.checkGasMoreThanReceive]:[this.checkThirdPartyProvider,this.checkVolatilitySlippage,this.checkBlockedRepeatOrder,this.checkFacetTokenCrossChainDetail,this.checkZeroValue,this.checkRepeatOrderWithEnoughBalance,this.checkValueDifference,this.checkMinReceive,this.checkGasMoreThanReceive]}async check(){let t=[],e=this.makeCheckers();for(let o=0;o<e.length;o++){let r=e[o],{errorType:n,continueToNextInterceptor:i}=await r.call(this)||{};if(n&&(t.push(n),!i))return t}return t}},pu=un;u();l();P();var $l=()=>{let{quoteStore:a}=B(),t=a.enableQuoteAggregates?S(a,"quote.bestRoute"):null;return S(t,"defiPlatformId")===z?f("swaptrade_trade_placeholder_okxdex"):S(t,"name")},ln=({disabled:a})=>{let{commonStore:t,fromToStore:e,buySellStore:o,quoteStore:r}=B();if(t.portal===yt.MARKET)return o.tradeMode==="BUY"?f("swaptrade_market_placeorder_btn_buy_symbol",{symbol:e.to.tokenSymbol}):f("swaptrade_market_placeorder_btn_sell_symbol",{symbol:e.from.tokenSymbol});let c=(r.enableQuoteAggregates?S(r,"quote.bestRoute"):null)?ti:a?dt:He;if(e.computedIsSingleChain){let d=$l();return f(c,{provider:d})}return f(ei)},hu=()=>{let{commonStore:a,buySellStore:t}=B();return a.portal===yt.MARKET?t.tradeMode==="BUY"?fe.TYPE.green:fe.TYPE.red:null},fu=()=>{let{commonStore:a,swapBtnStore:t,swapStore:e}=B();return a.portal===yt.MARKET?e.isConfirmLoading:t.swapBtnLoading};var Uo=class{constructor(t){s(this,"swapBtnErrorTipsDialog",null);s(this,"swapInterceptor");s(this,"isInterceptionProcessing",!1);s(this,"defaultTipsDialogInfo",()=>({type:"",visible:!1,confirmCallBack:()=>{}}));s(this,"notShowAgainCrossChainConfirm",!1);s(this,"setNotShowAgainCrossChainConfirm",t=>{this.notShowAgainCrossChainConfirm=t});s(this,"tipsDialogInfo",this.defaultTipsDialogInfo());s(this,"swapBtnLoading",!1);s(this,"showErrorTips",(t,e)=>{this.tipsDialogInfo={type:t,visible:!0,confirmCallBack:e},this.setNotShowAgainCrossChainConfirm(!1)});s(this,"closeErrorTipsDialog",()=>{this.swapBtnLoading=!1,this.tipsDialogInfo.visible=!1});s(this,"openConfirmSwapDialog",(t,e)=>{let{swapStore:o}=this,{receiveAddressStore:r}=this.rootStore;r.saveWalletAddressToStorage(e),o.setConfirmSwapVisible(!0)});s(this,"connectWallet",()=>{});s(this,"approve",()=>{});s(this,"cancelApprove",()=>{});s(this,"swap",()=>{});s(this,"clickSwapOnDapp",()=>{let{from:t,to:e,computedIsSingleChain:o}=this.fromToStore,{computedNotThirdBiz:r}=this.commonStore;kr({business_type:o?"swap":"bridge",trade_dialog:r?"no":"yes",from_token_address:t.tokenContractAddress,to_token_address:e.tokenContractAddress,swap_type:o?"discover_swap":"discover_cross_chain_swap",from_chain:t.chainName,to_chain:e.chainName}),this.rootStore.swapDappStore?.fetchDappList()});s(this,"checkDappTrade",()=>{let t=this.rootStore.swapDappStore?.checkShouldJumpToDapp;return typeof t=="function"&&t()?Ao:null});s(this,"isQuoting",()=>{let{fromToStore:t,quoteStore:e,slippageStore:o}=this.rootStore,{isFetchQuoting:r,bestRoute:n,quoteError:i,quoteNull:c}=e.quote,{from:d,to:m,computedTypedValue:p}=t,{tokenContractAddress:g}=d,{computedRealSlippageValue:T}=o;return c||!n&&i&&!r||!p||!m.tokenContractAddress||!g||T>50||T<0?dt:null});s(this,"isHoneypot",()=>this.rootStore?.safeMoonStore?.computedHoneypot?dt:null);s(this,"noAmountOrOverLimit",()=>{let{fromToStore:t}=this,{overLimit:e}=this.rootStore?.safeMoonStore?.computedSlippageTips||{},{computedTypedValue:o}=t;return Number(o)===0||e?dt:null});s(this,"hasFeeConfigErrorTips",()=>this.outerStore.computedFeeConfigErrorTips?dt:null);s(this,"uninitializedWalletInfo",()=>{let{accountStore:{hasInitWalletInfo:t}}=this;return t?null:dt});s(this,"unConnectedWallet",()=>{let{accountStore:{isConnectedWallet:t}}=this;return t?null:To});s(this,"nonsupportChain",()=>{let{accountStore:{computedNonsupportChain:t}}=this;return t?dt:null});s(this,"nonsupportFacetToken",()=>{let{fromToStore:{computedNonsupportFacetToken:t}}=this;return t?dt:null});s(this,"checkReceiveAddressStatus",()=>{let{fromToStore:{computedDiffCrossChain:t}}=this,{receiveAddressStore:{checkReceiveAddressLoading:e,computedSwapHighLight:o}}=this.rootStore;return t&&!o||e?dt:null});s(this,"interceptionProcessing",()=>{let{fromToStore:t}=this;return!this.isInterceptionProcessing&&t.isBalanceLoading||t.fromBalanceState===nt.BALANCE_REQUEST_FAILED?dt:null});s(this,"balanceLessThenInputAmount",()=>this.computedTooBalance?Io:null);s(this,"approveStatus",()=>{let{approveStore:{computedApprovalStatus:t}}=this;return ai[t]||null});s(this,"isValidAmount",()=>{let{fromToStore:t}=this,{from:e,to:o}=t;return o.amount&&e.amount?He:null});s(this,"getBtnStatus",()=>{let t=[this.hasFeeConfigErrorTips,this.unConnectedWallet,this.nonsupportChain,this.nonsupportFacetToken,this.isHoneypot,this.checkDappTrade,this.checkReceiveAddressStatus,this.noAmountOrOverLimit,this.interceptionProcessing,this.balanceLessThenInputAmount,this.isQuoting,this.approveStatus,this.isValidAmount],e;for(let o of t){let r=o();if(r){e=r;break}}return e||(e=dt),e});s(this,"checkIsCurrentQuote",()=>(this.computedIsCurrentQuote||N.warn({title:f("swaptrade_mid_toast_tryagain_with_newquote")}),this.computedIsCurrentQuote));let{accountStore:e,fromToStore:o,swapStore:r,commonStore:n,quoteStore:i,approveStore:c}=t;this.rootStore=t,this.accountStore=e,this.fromToStore=o,this.swapStore=r,this.commonStore=n,this.quoteStore=i,this.approveStore=c,this.swapInterceptor=new pu(t),Object.assign(this,t)}async runSwapInterceptor(t){this.isInterceptionProcessing=!0;let[e,o]=await _(this.swapInterceptor.check());if(this.isInterceptionProcessing=!1,e){A.error(v.UPDATE_BTC_BALANCE_ERROR_BEFORE_SWAP,{error:e});return}if(o.length===0){t();return}let r=-1,n=()=>{r++;let i=r===o.length-1;this.showErrorTips(o[r],i?t:n)};n()}getBtnAllStatus({from:t}){return{[To]:{statusType:To,disabled:!1,toLocaleText:()=>f(To),onClick:this.connectWallet},[Io]:{statusType:Io,disabled:!0,toLocaleText:()=>f(Io,{tokenSymbol:W(t.tokenSymbol)}),symbol:t.tokenSymbol},[sr]:{statusType:sr,disabled:!1,toLocaleText:()=>f(sr,{tokenSymbol:W(t.tokenSymbol)}),onClick:()=>{this.quoteStore.setAggregateSelectStatus(1),this.approve()},icon:"okx-defi-dex-authorization",iconType:fe.ICON_POSITION.leading},[Co]:{statusType:Co,loading:!0,disabled:!0,toLocaleText:()=>f(Co)},[Ls]:{statusType:Co,disabled:!1,toLocaleText:()=>f(Ls,{ccy:t.tokenSymbol}),onClick:this.cancelApprove,icon:"okx-defi-dex-authorization",iconType:fe.ICON_POSITION.leading},[nr]:{statusType:nr,loading:!0,disabled:!0,toLocaleText:()=>f(nr)},[dt]:{statusType:dt,disabled:!0,toLocaleText:()=>ln({disabled:!0})},[He]:{statusType:He,disabled:!1,loading:fu(),toLocaleText:()=>ln({disabled:!1}),onClick:()=>{this.quoteStore.setAggregateSelectStatus(1),this.swap()},type:hu()},[Ao]:{statusType:Ao,disabled:!1,loading:this.rootStore.swapDappStore?.swapOnDappBtnLoading,toLocaleText:()=>f(Ao),icon:"okds-open-link",iconType:fe.ICON_POSITION.leading,onClick:this.clickSwapOnDapp}}}get needToCrossChainDoubleCheck(){return!0}get computedTooBalance(){let{rootStore:t,fromToStore:e,accountStore:o}=this,{isConnectedWallet:r}=o,n=e.from.balance,i=t.safeMoonStore.computedInputVal;return r?I.BigNumber(n||0).isLessThan(i):!1}get computedBtnStatus(){let{fromToStore:t}=this,{from:e}=t,o=this.getBtnStatus();return this.getBtnAllStatus({from:e,swapLoading:this.swapBtnLoading})[o]}get computedIsCurrentQuote(){let{fromToStore:t,quoteStore:e}=this,{computedIsExactIn:o,computedTypedValue:r}=t,{quote:n,getGasTokenFeeLoading:i}=e,{fromTokenAmount:c="",inputToTokenAmount:d=""}=n?.bestRoute||{},m=!!r,p=m&&o&&I.BigNumber(r).isEqualTo(c),g=m&&!o&&I.BigNumber(r).isEqualTo(d);return!i&&(p||g)}};u();l();var gu=xt(["tipsDialogInfo","notShowAgainCrossChainConfirm","isInterceptionProcessing","swapBtnLoading"],["computedTooBalance","computedBtnStatus","computedIsCurrentQuote"]);u();l();var mn=()=>{let{accountStore:a}=B();ba({wallet_address:a.address,...Ua()})};var Ne=class extends Uo{constructor(e){super(e);s(this,"handleSwap",async()=>{let{quote:e,computedIsOfflineType:o}=this.quoteStore,{receiveAddressStore:r,swapStore:n}=this.rootStore,{from:i,cacheTokenInfo:c}=this.fromToStore;if(this.swapBtnLoading=!0,this.walletContractStore.setQuoteData(e.bestRoute),A.info(v.CLICK_WALLET_SWAP_BUTTON,{chainId:i.chainId,tokenContractAddress:i.tokenContractAddress,amountNum:i.balance}),I.eq(i.balance,c.amountNum)||A.info(v.BALANCE_IS_ERROR,{chainId:i.chainId,tokenContractAddress:i.tokenContractAddress,amountNum:i.balance,cacheTokenInfo:c}),!o){let p=await this.walletContractStore.fetchCallData();if(this.swapBtnLoading=!1,p)return}this.swapBtnLoading=!1;let d=o?bt.INTENT_SWAP:bt.SWAP;r.saveWalletAddressToStorage(this.fromToStore?.to);let{fromToken:m}=qn.get(e,"bestRoute",{});if(n.isSwapSolana(m.chainId)){b.history?.push({pathname:Ze});return}b.history?.push({pathname:Ft,search:`needUpdate=${cr.on}&type=${d}`})});s(this,"swap",async()=>{let e=this.checkIsCurrentQuote();kr({wallet_address:this.accountStore.address,button_name:"confirm",...ct()}),e&&(this.swapBtnLoading=!0,this.runSwapInterceptor(this.handleSwap))});s(this,"approve",async()=>{this.approveStore.updateCurrentApproveTokenConfig({status:U.Approving});let e=await b.checkMpcAccountIfNecessary();if(mn(),!e){this.approveStore.updateCurrentApproveTokenConfig({status:U.UnApproved});return}this.approveStore.setApprove()});s(this,"cancelApprove",async()=>{this.approveStore.updateCurrentApproveTokenConfig({status:U.CancelApproving});let e=await b.checkMpcAccountIfNecessary();if(mn(),!e){this.approveStore.updateCurrentApproveTokenConfig({status:U.CancelApprove});return}this.approveStore.setApprove(je.CANCEL_APPROVE)});this.walletContractStore=e.walletContractStore,Rt(this,gu)}};u();l();u();l();P();F();u();l();P();var Xl=/\s/,Su=a=>!(!tr(a)||Xl.test(a)||a.length<10);u();l();P();var td=I.mul(.5,100),ed=I.mul(.1,100),pn=a=>{let t=S(a,"quoteStore.quote.bestRoute.autoSlippageInfo",{}),{computedDefaultAutoSlippageInfo:e}=a.fromToStore;return{...e,...t}},qo=({isSingleChain:a,autoSlippageInfo:t})=>{let{autoSlippage:e,autoTotalSlippage:o}=t||{};return a?e||.01:o||.03},es=a=>{let t=a.fromToStore.computedIsSingleChain,e=pn(a),o=qo({isSingleChain:t,autoSlippageInfo:e});return I.mul(I.ceilTruncate(o,3,!1),100)},od=a=>{let t=$t(a);if(t.indexOf(".")>-1){let e=t.split("."),o=e[0],r=e[1];r&&r.length>1&&(r=r.slice(0,1)),t=`${o}.${r}`}return tt(t)},os=({inputSlippageParams:a,computedSafeMoonTips:t,minSlippageShow:e,maxSlippageShow:o=td,autoSlippageValue:r=0,isSingleChain:n=!0})=>{let{safeMoonSlippage:i=0,overLimit:c,equalLimit:d}=t||{};if(a===""&&!t)return{slippage:0,inputValue:"",notice:"",isError:!1};let m=od(a),p="",g=!1,T=!1;return t?.safeMoonSlippage?c||d||I.BigNumber(m).isZero()?p="":e>m?(p=f("swaptrade_settings_errortip_minimum_slippage",{cross:Bt(e,{needZero:!1})}),g=!0,m=i):i>m?(p=f("swaptrade_settings_errortip_lowslippage_failed",{auto:Bt(i,{needZero:!1})}),T=!0):m>o&&(p=f("swaptrade_card_swap_advance_options_exceeding_desc",{num:Bt(o,{needZero:!1})}),g=!0,m=i):me(m)?(m="",g=!0):m<e?(p=f(n?"swaptrade_dialog_modal_singlechain_limit":"swaptrade_dialog_modal_crosschain_limit",{value:I.thousandFormat(e)}),g=!0):m<r?(p=f("swaptrade_dialog_modal_transaction_failure"),g=!1):m>=ed&&m<=o?(p=f("swaptrade_adjustslip_modalhint_actual_amount_less",{value:Bt(m,{needZero:!1})}),g=!1):m>o&&(m=o,p=f("swaptrade_card_swap_advance_options_exceeding_desc",{num:Bt(o,{needZero:!1})}),g=!0),{slippage:m,inputValue:a!==""?$t(m):"",notice:p,isError:g,isWarning:T}},Tu=({slippageInfo:a,isSingleChain:t})=>{let{autoSlippageInfo:e,customSlippage:o}=a,r={};return t?o||(r=pe(e,["autoSlippage"])):r=pe(e,["autoFromSlippage","autoToSlippage","autoTotalSlippage"]),Object.keys(r).forEach(i=>{let c=r[i],d=I.ceilTruncate(c,3,!1);r[i]=I.toPlainString(Number(d))}),{customSlippage:o,autoSlippageInfo:r}};var Vo=class{constructor(t){s(this,"defaultGasFee","--");s(this,"isWalletConfirm",!1);s(this,"setWalletConfirm",t=>{this.isWalletConfirm=t});s(this,"isConfirmLoading",!1);s(this,"txInfo",{});s(this,"resetTxInfo",()=>{this.txInfo={}});s(this,"showRecentTransactionModal",t=>{this.confirmSwapVisible=!1,this.rootStore.recentTransactionStore.showModal(t)});s(this,"saveOrderParamsExtendSlippageAndGasPrice",t=>{let e={...t},{computedQuote:o,fromToStore:r}=this,{computedIsSingleChain:n,computedDefaultAutoSlippageInfo:i}=r,{autoSlippageInfo:c}=o.bestRoute||{},d=qo({isSingleChain:n,autoSlippageInfo:i}),m={autoSlippageInfo:c||{}},p=S(this,"rootStore.slippageStore");return p&&(d=p.computedRealSlippageValue,m=p.getOrderSlippageInfo()),Object.assign(e,{slippage:String(d),...Tu({slippageInfo:m,isSingleChain:n})})});s(this,"saveOrderSingleChainParams",t=>{let{computedQuote:e}=this,{originDexRouterList:o,dexRouterList:r}=e.bestRoute||{};return{...t,dexRouterList:r,originDexRouterList:o}});s(this,"saveOrderCrossChainParams",t=>{let{computedQuote:e,fromToStore:o}=this,{receiveAddressStore:r}=this.rootStore,{to:n,computedDiffCrossChain:i}=o,{receiveAddrObj:c}=r,{fromDexRouterList:d,bridge:m,toDexRouterToList:p,originFromDexRouterList:g}=e.bestRoute||{};return{...t,toChainId:n.chainId,crossChainDexRouter:{fromDexRouterList:d,toDexRouterToList:p,bridge:m,originFromDexRouterList:g},...i?{receiveWalletAddress:c?.specifiedAddress}:{}}});s(this,"saveOrderParams",()=>{let{fromToStore:t}=this,{computedIsSingleChain:e}=t,o=this.baseSaveOrderParams();return e?this.saveOrderSingleChainParams(o):this.saveOrderCrossChainParams(o)});s(this,"calldataSign",null);s(this,"setCalldataSign",t=>{this.calldataSign=t});s(this,"extendSignParams",async t=>{let e={...t},o=S(this.quoteStore,"quote.bestRoute.permit2Data");if(o&&!this.calldataSign){let[r,n]=await this.checkPermit2();if(r)return null;this.setCalldataSign(n),e={...e,unsignedTx:o?.unsignedTx,signature:n}}else o&&this.calldataSign&&(e={...e,unsignedTx:o?.unsignedTx,signature:this.calldataSign});return e});s(this,"checkPermit2",async()=>{let t=S(this.quoteStore,"quote.bestRoute.permit2Data"),e=S(this.quoteStore,"quote.bestRoute.fromToken.chainId"),{signTransaction:o}=this.rootStore.sendTransactionStore,r=t?.unsignedTx,[n,i]=await o(r,e);return n&&(A.error(v.SIGN_PERMIT2_DATA,{error:n,unsignedTx:r}),Mo(n)||Qt.error({title:f("swaptrade_trading_mode_alert_order_fail")})),[n,i]});s(this,"resetFromToAmount",()=>{this.fromToStore.updateFrom({amount:"",currentTime:"",prevAmount:"",usdPrice:""}),this.fromToStore.updateTo({amount:"",prevAmount:"",usdPrice:"",currentTime:""}),this.fromToStore.advanceSetTypedValue("")});s(this,"transferBtcPayload",t=>{let e={...t},{from:o}=this.fromToStore;return e.value=eo(e.value,o.decimals),e});s(this,"getExtParams",t=>{let{computedIsSingleChain:e,to:o,from:r,computedDiffCrossChain:n}=this.fromToStore,{receiveAddrObj:i}=this.rootStore.receiveAddressStore,c=n?i?.specifiedAddress:o.tokenContractAddress;return{txSource:3,orderId:t,toTokenAddress:c,crossChain:e?0:1,chainId:r.chainId,tokenAddress:r.tokenContractAddress,amount:r.amount,toChainId:o.chainId}});s(this,"confirmSwapVisible",!1);s(this,"setConfirmSwapVisible",t=>{this.confirmSwapVisible=t});s(this,"isSwapSolana",t=>!!(xr(t)&&this.rootStore.solanaPriorityFeeStore?.jitoData));s(this,"extendSolanaCalldata",t=>{let{feeType:e,customFee:o,computedPriorityFeeList:r}=this.rootStore.solanaPriorityFeeStore||{},n=r.find(c=>c.type===e),i=o||n.fee;return{...t,tradeMode:2,priorityFee:i,customPriorityFee:!!o}});s(this,"solanaSwapParams",null);s(this,"setSolanaSwapParams",t=>{this.solanaSwapParams=t});s(this,"getSolanaCalldata",t=>(this.setSolanaSwapParams(t),_(C.post(Cr,t))));s(this,"solanaTransaction",async(t,e)=>{let{from:o}=this.fromToStore,{computedAccountId:r}=this.accountStore,i=await Fo(o,{orderData:t,extParams:{}},this).jitoTransaction(),c=i.map(p=>p.payload.transaction),[d,m]=await _(this.rootStore.sendTransactionStore.signAllTransactions(c));if(d){this.onWalletFail(d,t?.orderId),this.isConfirmLoading=!1,A.removeKeep();return}await this.sendSolanaTransaction({signedTransactions:m,txArray:i,swapParams:e,walletId:r,enableJito:t.jitoEnable})});s(this,"sendSolanaTransaction",async({signedTransactions:t,txArray:e,swapParams:o,walletId:r,enableJito:n})=>{let[i,c]=await _(ou({signedTransactions:t,txArray:e,swapParams:o,walletId:r,enableJito:n}));if(this.isConfirmLoading=!1,A.removeKeep(),!i){let d=S(c,"data.broadcastResult.data.orderId");this.afterTransaction(d)}});this.rootStore=t,this.commonStore=t.commonStore,this.accountStore=t.accountStore,this.fromToStore=t.fromToStore,this.tokenModalStore=t.tokenModalStore,this.quoteStore=t.quoteStore,this.gasDropStore=t.gasDropStore}get computedEstimateGasFee(){let t=this.defaultGasFee,e=this.commonStore.nowCurrencyUnit,o=S(this.computedQuote.bestRoute,"quoteNetWorkFeeOfMoney");if(this.isSwapSolana(this.fromToStore.from.chainId)&&this.quoteStore.enableQuoteAggregates){let n=S(this.rootStore.solanaPriorityFeeStore,"computedPriorityFeeOfUsd",0);o=I.add(n,o,{returnString:!0})}let r=I.BigNumber(o).multipliedBy(S(e,"usdToThisRate"));return!Y(e)&&!r.isNaN()&&(t=St(r.toJSON(),e?.symbol)),t}get computedCrossChainFromFee(){let t=S(this.computedQuote.bestRoute,"fromSwapFeeUsd");if(!t||me(Number(t)))return"--";let{computedNowCurrencySymbol:e,currencyConversion:o}=this.commonStore,r=o(t).toString();return`${St(r,e)}`}updateTxHash(t){this.rootStore.sendTransactionStore.updateTxHash(t)}cancelOrder(t){t&&this.rootStore.sendTransactionStore.cancelOrder(t)}baseSaveOrderParams(){let{accountStore:t,computedQuote:e,fromToStore:o,quoteStore:r,gasDropStore:n}=this,{from:i,to:c}=o,{estimateGasFee:d,minimumReceived:m,gasDropAmount:p,defiPlatformId:g,traceData:T}=e.bestRoute||{},{computedIsMevOpen:y}=this.rootStore.mevStore,w={chainId:i.chainId,fromAmount:I.BigNumber(r?.computedQuoteAmount).toString(10),fromTokenAddress:i.tokenContractAddress,fromTokenDecimal:String(i.decimals),toAmount:c.reverseReceiveAmount,toTokenAddress:c.tokenContractAddress,toTokenDecimal:String(c.decimals),userWalletAddress:t.address,estimateGasFee:d,pmm:"1",gasDropType:n?.computedGasDropSelected?1:0,gasDropAmount:p,minimumReceived:m,openMev:y,toChainId:c.chainId,traceData:T};g&&(w.defiPlatformId=g);let M=this.rootStore.outerStore.extendFeeConfig(w);return this.saveOrderParamsExtendSlippageAndGasPrice(M)}saveOrderUrl(){return Sr}onSaveOrder(t){let e={...t,...$r()};return A.info(v.SAVE_ORDER_PARAMS,{data:e}),C.post(this.saveOrderUrl(),e)}saveOrderErr(t){let{error_code:e,error_message:o=""}=t,r=t?.data?.code||e||"";return A.error(v.SAVE_ORDER_ERROR,{error:t,tags:{errorCode:e||r,error_msg:`${v.SAVE_ORDER_ERROR}_${r}`}}),e==="10014"?Qt.error({title:f("swaptrade_toast_trade_not_available")}):Qt.error({title:o||f("swaptrade_toast_save_order_fail")})}saveOrderError(t){this.saveOrderErr(t),this.isConfirmLoading=!1,A.removeKeep()}async onSwap(t){this.isConfirmLoading=!0,A.keepLive(),this.setCalldataSign(null);let e=this.saveOrderParams(),o=await this.extendSignParams(e);if(!o){this.isConfirmLoading=!1;return}if(this.isSwapSolana(o.chainId)){await this.onSolanaSwap(o);return}let[r,n]=await _(this.onSaveOrder(o));if(r){this.saveOrderError(r);return}A.info(v.SAVE_ORDER,{data:n?.data,tags:{orderId:n?.data.orderId}}),ro({...ct(),order_id:n?.data.orderId,wallet_type:this.accountStore.walletConfig?.walletType});let[i]=await _(this.onChainTransaction({...n?.data,swapParams:o},t));i&&this.onWalletFail(i,n?.data?.orderId),this.isConfirmLoading=!1,A.removeKeep()}walletErrorMessage(t){let e=null;try{e=JSON.parse(t?.message)}catch{e={}}return e}walletErrToast(t,e){let o,r=this.walletErrorMessage(t);return A.error(v.SEND_ERROR,{error:t,tags:{orderId:e}}),r?.code===te.SLIPPAGE_LOW?o=f("swaptrade_home_toast_slippage_too_low"):r?.code===te.SEND_TX_ERROR_CODE&&(o=r?.message),Qt.error({title:o||f("swaptrade_home_toast_broadcast_failed")})}onWalletFail(t,e){Mo(t)?this.cancelOrder(e):t?.code!==gi.RECEIPT_ERROR&&(Lo.emit(vo.FAIL,{data:{orderId:e},status:-2,message:vs("transaction fail")}),this.walletErrToast(t,e)),A.error(v.ON_WALLET_FAIL,{error:t,tags:{orderId:e}})}extendEvmParams(t){return t}isOkxWallet(){}async getTransactionPayload({orderData:t,orderId:e}){let{from:o}=this.fromToStore;return Fo(o,{orderData:t,extParams:this.getExtParams(e)},this).getSendTransactionParams()}sendTransactionEnhance(...t){return this.rootStore.sendTransactionStore.sendTransaction(...t)}getTransaction(){}logChainId(){return!0}async doubleCheckChainId(){return!0}async onChainTransaction(t,e){let{callData:o,orderId:r,swapParams:n}=t,i=await this.getTransactionPayload({orderData:t,orderId:r}),{computedIsEvmChain:c,from:d}=this.fromToStore;if(A.info(v.PAYLOAD,{payload:i,tags:{orderId:r}}),e)try{await e(...i)}catch(p){return A.error(v.BEFORE_SEND_TRANSACTION_ERROR,{error:p}),!1}return this.logChainId({message:v.CHECK_CHAIN_ID_BEFORE_SEND_TRANSACTION,fromChainId:d.chainId,saveOrderChainId:n.chainId,orderId:r}),await this.doubleCheckChainId({saveOrderChainId:n.chainId,orderId:r})?this.sendTransactionEnhance(...i).then(({result:p,nonce:g})=>{if(!Su(p))throw new Error(`hash format is invalid: ${p}`);return this.txInfo={...o,txHash:p},I.BigNumber(g).isNaN()?(this.updateTxHash({orderId:r,transactionHash:p}),c&&this.getTransaction(p,this.fromToStore.from.chainId).then(T=>{A.info(v.UPDATE_NONCE,{nonce:T.nonce,tags:{orderId:r}}),this.updateTxHash({orderId:r,transactionHash:p,nonce:T.nonce})}).catch(T=>{A.error(v.UPDATE_NONCE_FAIL,{error:T})})):this.updateTxHash({orderId:r,transactionHash:p,nonce:g}),this.afterTransaction(r),this.logChainId({message:v.CHECK_CHAIN_ID_AFTER_SEND_TRANSACTION,fromChainId:d.chainId,saveOrderChainId:n.chainId,orderId:r}),!0}):!1}afterTransaction(t){this.setWalletConfirm(!0),this.showRecentTransactionModal(t),Lo.emit(vo.TXHASH,{status:0,data:q(this.txInfo),message:vs("Transaction hash has been generated")})}get computedQuote(){return this.quoteStore.quote}checkRepeatOrderDetail(t){t&&this.rootStore.recentTransactionStore.showModal(t)}async onSolanaSwap(t){let e=this.extendSolanaCalldata(t),[o,r]=await this.getSolanaCalldata(e);if(o){this.saveOrderError(o);return}A.info(v.SAVE_ORDER,{data:r?.data,tags:{orderId:r?.data.orderId}}),ro({...ct(),order_id:r?.data.orderId,wallet_type:this.accountStore.walletConfig?.walletType}),await this.solanaTransaction(r.data,e)}};u();l();var Iu=xt(["isWalletConfirm","isConfirmLoading","txInfo","confirmSwapVisible"],["computedEstimateGasFee","computedCrossChainFromFee","computedQuote"]);var De=class extends Vo{constructor(e){super(e);s(this,"sendTransactionEnhance",e=>{let{computedIsSolanaChain:o,computedIsTronChain:r,computedIsAptosChain:n,computedIsSuiChain:i,computedIsStacksChain:c,computedIsStarknetChain:d,computedIsFromBtcCoin:m}=this.rootStore?.fromToStore,{from:p}=this.rootStore?.fromToStore,{walletSendParams:g}=this.rootStore.walletContractStore;return this.rootStore.sendTransactionStore.sendTransaction(p.chainId,e,g).then(T=>{let y,w;if(o)y=T.signature;else if(r){let{transaction:M}=T;y=M?.txID}else if(n)y=T;else if(i)y=T;else if(c)y=T.txHash;else if(d)y=T.transaction_hash;else if(m)y=T;else if(ac(p.chainId))y=T.txHash;else{let{hash:M,nonce:O}=T;y=M,w=O}return{result:y,nonce:w}})});s(this,"showRecentTransactionModal",e=>{this.isConfirmLoading=!1,this.confirmSwapVisible=!1,b.history.replace(`${Te}/${e}`)});s(this,"baseSaveOrderParams",()=>{let e=super.baseSaveOrderParams(),{walletMevControl:o}=this.rootStore.mevStore;return{...e,openMev:e.openMev||o}});s(this,"extendsGas",e=>{let o={...e},{gasInfo:r}=this.rootStore.walletContractStore,{gasLimitInfo:n,isGasLimitLoading:i,gasType:c,...d}=r;return o.extParams.gasType=c,{...o,gasInfo:d}});s(this,"extendEvmParams",e=>{let o=super.extendEvmParams(e),{activityId:r}=this.rootStore.walletContractStore,n=this.rootStore.quoteStore.quote?.bestRoute?.isEnableMev;r&&(o.extParams.activityId=r);let{computedIsMevOpen:i,mevInfo:c,walletMevControl:d}=this.rootStore.mevStore;return(i||d)&&(o.extParams.isMev=!0,o.extParams.mevInfo=c),!i&&Number(n)===ui.ON&&(o.extParams.isShowBlockSwapMevTooltip=!0),o});s(this,"onWalletFail",(e,o)=>{this.isConfirmLoading=!1,!e?.message?.includes(b.global?.HARDWALLETERROR)&&super.onWalletFail(e,o)});s(this,"checkRepeatOrderDetail",e=>{e&&b.history.push(`${Te}/${e}`)});s(this,"checkUtxoBeforePublish",async e=>{let{utxoList:o}=e,{preDataForSendBtc:r}=this.rootStore.walletContractStore,{checkUtxoBeforePublish:n}=r;await n(o)});s(this,"onSwap",async()=>{this.isConfirmLoading=!0;let e=await b.checkMpcAccountIfNecessary();if(this.isConfirmLoading=!1,!e)return;let{computedIsOfflineType:o}=this.rootStore.quoteStore,{computedIsFromBtcCoin:r}=this.rootStore?.fromToStore;o?await this.rootStore.intentSwapStore?.onIntentSwap():await super.onSwap(r?this.checkUtxoBeforePublish:null)});s(this,"getSaveOrderMonitorData",()=>({...ct(),...this.rootStore.walletContractStore.computedMonitorGasType}));Rt(this,Iu)}isOkxWallet(){return!0}getTransaction(){}walletErrorMessage(e){return e}};u();l();P();P();u();l();P();P();F();u();l();u();l();var Cu=function(){return new Promise(function(t){setTimeout(t,1)})};u();l();var uo=R(x());u();l();var rd={[E.SWAP]:"swap_used_chain_cache",[E.LIMIT_ORDER]:"limit_used_chain_cache",[E.BRIDGE]:"bridge_used_chain_cache"},Au=(a,t,e)=>{let o=rd[e],r=D.get(o)||[];if(r.length===0&&(r=t.slice(0,4).map(i=>i.chainId)),a.forEach(n=>{r.includes(n)||r.unshift(n)}),r=r.filter(n=>t.find(i=>i.chainId===n)),r.length<4)for(let n=0;n<t.length&&r.length<4;n++)r.includes(t[n].chainId)||r.push(t[n].chainId);return r.length>4&&(r=r.slice(0,4)),D.set(o,r),r};u();l();var Wo=class{constructor(t){s(this,"id",1);s(this,"tokenSymbol","--");s(this,"tokenName","--");s(this,"decimals",6);s(this,"tokenContractAddress","");s(this,"tokenLogoUrl","");s(this,"type","");s(this,"amountNum",0);s(this,"currencyAmount",0);L(this),Object.assign(this,t),this.tokenModalStore=B().tokenModalStore}get computedPrice(){let{nowCurrencyUnit:t}=this.tokenModalStore.commonStore,{symbol:e,usdToThisRate:o}=t,r=I.BigNumber(this.currencyAmount);return r.isNaN()||r.isZero()?`${e||""}0.00`:e&&o&&!r.isNaN()&&!r.isZero()?St(r.multipliedBy(o).toJSON(),e):"0"}get computedIsSelect(){let{equalsToken:t}=this.tokenModalStore.commonStore,{from:e,to:o}=this.tokenModalStore.fromToStore;return this.tokenModalStore.tokenModalFromState===k.FROM?t(this,o):t(this,e)}get computedIsSelectOrigin(){let{from:t,to:e}=this.tokenModalStore.fromToStore,{equalsToken:o}=this.tokenModalStore.commonStore;return this.tokenModalStore.tokenModalFromState===k.FROM?o(this,t):o(this,e)}get computedAmountNum(){return this.amountNumBigDecimal!==""?this.amountNum:0}toJSON(){return q(this)}};u();l();var Go=(a={})=>({...ft,logoUrl:ft.logoUrl(),chainName:f(ft.localKey),...a}),rs=(a={})=>{let t=Yn();return{...kt,get logoUrl(){return t===Kn.dark?kt.darkLogoUrl():kt.logoUrl()},chainName:f(kt.localKey),...a}};var yu="hide_collect_cancel_dialog",ku="hideTokenGuide",Me=class{constructor(t){s(this,"searchValue","");s(this,"setSearchValue",t=>{this.searchValue=t});s(this,"fromTokenList",new Map);s(this,"toTokenList",new Map);s(this,"searchTokenList",{});s(this,"error",!1);s(this,"tokenModalVisible",!1);s(this,"tokenModalFromState",k.FROM);s(this,"setTokenModalFromState",t=>{this.tokenModalFromState=t});s(this,"loading",{[k.FROM]:{},[k.TO]:{}});s(this,"initLoading",()=>{this.loading={[k.FROM]:{},[k.TO]:{}}});s(this,"importTokenInfo",{});s(this,"setImportTokenInfo",t=>{this.importTokenInfo={...t}});s(this,"toSelectedChainId","");s(this,"fromSelectedChainId","");s(this,"setToSelectedChainId",t=>{this.toSelectedChainId=t});s(this,"setFromSelectedChainId",t=>{this.fromSelectedChainId=t});s(this,"extendTokens",(t,e)=>t.filter(o=>this.commonStore.getChainByID(tt(o.chainId))).map(o=>{let r=new Wo(o,this);return{...o,balance:r.computedAmountNum,selected:r.computedIsSelect,selectedOrigin:e?r.computedIsSelectOrigin:!1,price:r.computedPrice}}));s(this,"extendTokenList",(t=[],e=!0)=>Y(t)?t:this.extendTokens(t,e));s(this,"importUserToken",Jt(function*(e,o=!0){let r=e.map(c=>{let{chainId:d,tokenContractAddress:m,tokenSymbol:p,decimals:g}=c;return{chainId:d,contractAddress:m,tokenSymbol:p,precision:g}}),n={userUniqueId:this.commonStore.userUniqueId,tokenDetailList:r},i=[];try{i=(yield C.post(gr,n)).data}catch(c){throw N.error(f("swaptrade_pricechart_no_connection_desc")),c}return o&&(this.searchValue="",this.changeTokenModalVisible(!1)),i}));s(this,"sortTokens",t=>Fn(t,[e=>Number(e.topPlacement),e=>Number(e.currencyAmount),e=>Number(e.amountNum),e=>Number(e.isCollectToken),e=>Number(e.collectTime)],["desc","desc","desc","desc","desc"]));s(this,"orderTokenList",t=>this.computedIsCollectChain?t:this.commonStore.currentTab===E.BRIDGE?t.map(e=>({...e,tokenList:this.sortTokens(e.tokenList)})):this.sortTokens(t));s(this,"formatTokenList",(t,e)=>{let o=t;t.length>100&&e!==ft.chainId&&(o=t.slice(0,100));let r=this.extendTokenList(o,!0);return this.orderTokenList(r)});s(this,"changeTokenModalVisible",t=>{this.tokenModalVisible=t});s(this,"clearCacheTokenList",()=>{});s(this,"getTokenListByChainId",async()=>{let t=this.tokenModalFromState===k.FROM,e={};if(this.clearCacheTokenList(),this.tokenModalFromState===k.FROM?e={fromChainId:this.fromSelectedChainId}:this.tokenModalFromState===k.TO&&(e={fromChainId:this.fromToStore.from.chainId,toChainId:this.toSelectedChainId}),this.tokenModalFromState===k.FROM&&Number(this.fromSelectedChainId)===kt.chainId){this.getFromAllNetworksTokens();return}if(this.tokenModalFromState===k.TO&&Number(this.toSelectedChainId)===kt.chainId){this.getToAllNetworksTokens(e.fromChainId);return}if(this.tokenModalFromState===k.FROM&&Number(this.fromSelectedChainId)===ft.chainId){this.getFromCollectedTokens();return}if(this.tokenModalFromState===k.TO&&Number(this.toSelectedChainId)===ft.chainId){this.getToCollectedTokens(e.fromChainId);return}t?this.getTokenList(k.FROM,e.fromChainId):this.getTokenList(k.TO,e.toChainId,e.fromChainId)});s(this,"setTokenList",(t,e,o)=>{let r=this.formatTokenList(e,t);this[`${o}TokenList`].set(t,r)});s(this,"cancelGetTokenListRef",null);s(this,"handleTokenList",Jt(function*(e,o,r,n){this.setError(!1),this.cancelGetTokenListRef&&this.cancelGetTokenListRef.abort(),this[`${e}TokenList`].get(o)||this.setLoading(e,o,!0),this.cancelGetTokenListRef=$();try{let{data:i}=yield C.get(r,{params:n,signal:this.cancelGetTokenListRef?.signal}),c=this.toLowerCaseContractAddress(i);return this.setTokenList(o,c,e),this.setLoading(e,o,!1),{data:c}}catch(i){return this.isCancel(i)?null:(this.setTokenList(o,[],e),this.setLoading(e,o,!1),this.setError(!0),i)}}).bind(this));s(this,"getCrossChainParams",(t,e,o)=>{switch(t){case E.BRIDGE:return{fromChainId:e.fromChainId??e?.chainId,userUniqueId:e.userUniqueId,accountId:e.accountId,userWalletAddress:e.userWalletAddress,...o,toChainId:o.toChainId===-1?"":o?.toChainId};case E.SWAP:default:return e}});s(this,"getTokenList",Jt(function*(e,o,r){let n={fromChainId:r,chainId:o,userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,userWalletAddress:this.accountStore.computedSpecialWalletAddress};this.commonStore?.computedCurrentTabIsLimit&&(n={...n,businessLine:ee.LIMIT_ORDER});let i=this.getCrossChainParams(this.commonStore.currentTab,n,{selectChainType:this.getCrossChainSelectChainType(),toChainId:this.computedCurrentToChainId,fromTokenAddress:this.fromToStore.from.tokenContractAddress||""}),c=tt(o);if(this.computedIsNotSupportToChain)return this.setTokenList(c,[],e),{data:[]};let d=Yt(It.ALL_TOKENS,this.commonStore.currentTab);return yield this.handleTokenList(e,c,d,i)}));s(this,"getFromCollectedTokens",Jt(function*(){let e={userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,fromChainId:"",userWalletAddress:this.accountStore.computedSpecialWalletAddress};this.commonStore?.computedCurrentTabIsLimit&&(e={...e,businessLine:ee.LIMIT_ORDER});let o=this.getCrossChainParams(this.commonStore.currentTab,e,{selectChainType:ye.FROM,toChainId:this.computedCurrentToChainId,fromTokenAddress:""}),r=Yt(It.COLLECT_LIST,this.commonStore.currentTab);return yield this.handleTokenList(k.FROM,ft.chainId,r,o)}));s(this,"getToCollectedTokens",Jt(function*(e){let o={userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,fromChainId:e,chainId:e,userWalletAddress:this.accountStore.computedSpecialWalletAddress};this.commonStore?.computedCurrentTabIsLimit&&(o={...o,businessLine:ee.LIMIT_ORDER});let r=this.getCrossChainParams(this.commonStore.currentTab,o,{selectChainType:ye.TO,toChainId:"",fromTokenAddress:this.fromToStore.from.tokenContractAddress}),n=Yt(It.COLLECT_LIST,this.commonStore.currentTab);return yield this.handleTokenList(k.TO,ft.chainId,n,r)}));s(this,"getFromAllNetworksTokens",Jt(function*(){let e={userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,fromChainId:"",userWalletAddress:this.accountStore.computedSpecialWalletAddress};this.commonStore?.computedCurrentTabIsLimit&&(e={...e,businessLine:ee.LIMIT_ORDER});let o=Yt(It.ALL_NETWORK,this.commonStore.currentTab),r=this.getCrossChainParams(this.commonStore.currentTab,e,{selectChainType:ye.FROM,toChainId:this.computedCurrentToChainId,fromTokenAddress:""});return yield this.handleTokenList(k.FROM,kt.chainId,o,r)}));s(this,"getToAllNetworksTokens",Jt(function*(e){let o={userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,fromChainId:e,userWalletAddress:this.accountStore.computedSpecialWalletAddress};this.commonStore?.computedCurrentTabIsLimit&&(o={...o,businessLine:ee.LIMIT_ORDER});let r=Yt(It.ALL_NETWORK,this.commonStore.currentTab),n=this.getCrossChainParams(this.commonStore.currentTab,o,{selectChainType:ye.TO,toChainId:"",fromTokenAddress:this.fromToStore.from.tokenContractAddress});return yield this.handleTokenList(k.TO,kt.chainId,r,n)}));s(this,"cancelSearchRef",null);s(this,"needRemoveChainId",t=>[kt.chainId,ft.chainId].includes(tt(t)));s(this,"getSearchChainType",()=>{let t=ar.SINGLE;return this.computedCurrentChainId===kt.chainId&&(t=ar.ALL_NETWORK),this.computedCurrentChainId===ft.chainId&&(t=ar.COLLECT),t});s(this,"getCrossChainSearchType",()=>this.computedCurrentChainId===ft.chainId?$s.COLLECTION:$s.COMMON);s(this,"getCrossChainSelectChainType",()=>this.tokenModalFromState===k.FROM?ye.FROM:ye.TO);s(this,"singleSearchParams",t=>{let e=this.getSearchChainType(),o={userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,chainType:e,searchType:e,userWalletAddress:this.accountStore.computedSpecialWalletAddress},r={},n={};return this.tokenModalFromState===k.FROM?(r={inputContent:t,fromChainId:this.fromSelectedChainId,chainId:this.fromSelectedChainId,toChainId:this.fromSelectedChainId},this.needRemoveChainId(this.fromSelectedChainId)&&(delete r.fromChainId,delete r.toChainId,delete r.chainId)):this.tokenModalFromState===k.TO&&(n={inputContent:t,fromChainId:this.fromToStore.from.chainId,chainId:this.fromToStore.from.chainId,toChainId:this.toSelectedChainId,fromTokenAddress:this.fromToStore.from.tokenContractAddress||""},this.needRemoveChainId(this.toSelectedChainId)&&(delete n.toChainId,delete r.chainId)),{...o,...r,...n}});s(this,"getSearchTokenList",async()=>{if(this.searchValue==="")return;if(this.cancelSearchRef&&this.cancelSearchRef.abort(),this.computedIsNotSupportToChain){this.setSearchTokenList({}),this.setLoading(this.tokenModalFromState,"search",!1);return}this.cancelSearchRef=$(),this.setLoading(this.tokenModalFromState,"search",!0),this.setError(!1);let t=Es(this.searchValue),e=this.getSearchParams(t);Ra({keyword:t});let o=Yt(It.SEARCH,this.commonStore.currentTab),r=this.getCrossChainParams(this.commonStore.currentTab,e,{inputContent:e?.inputContent,selectChainType:this.getCrossChainSelectChainType(),searchType:this.getCrossChainSearchType(),toChainId:this.computedCurrentToChainId,fromTokenAddress:this.fromToStore.from.tokenContractAddress||""}),[n,i]=await _(C.get(o,{params:{...r},signal:this.cancelSearchRef?.signal}));if(n&&!this.isCancel(n)){this.setError(!0),this.setSearchTokenList({}),this.setLoading(this.tokenModalFromState,"search",!1);return}if(i){let{data:c}=i;if(this.commonStore.currentTab===E.BRIDGE)this.setSearchTokenList({list:c});else{let{systemList:d,thirdPartyList:m}=i.data;this.setSearchTokenList({systemList:d,thirdPartyList:m})}this.setError(!1),this.setLoading(this.tokenModalFromState,"search",!1)}});s(this,"resetTokenModal",()=>{this.resetTokenData()});s(this,"resetTokenData",()=>{this.searchTokenList={},this.searchValue=""});s(this,"balancePushSort",(t,e)=>{let o=[...t],{currencyAmount:r,coinAmountOriginalDec:n}=e;for(let i=0;i<o.length;i++)if(this.commonStore.equalsToken(o[i],e)){o[i].amountNum=n,o[i].currencyAmount=r;break}return o});s(this,"updateAllTokenList",t=>{let{chainId:e}=t,o=tt(e),r=this.fromTokenList.get(o);r&&this.setTokenList(o,this.balancePushSort(q(r),t),k.FROM);let n=this.toTokenList.get(o);n&&this.setTokenList(o,this.balancePushSort(q(n),t),k.TO)});s(this,"checkFromToLegal",(t,e)=>{let{currentTab:o}=this.commonStore,r={toToken:{...e,amount:""},isChanged:!1};if(Number(t.chainId)!==Number(e.chainId)){if(this.computedToChain?.some(g=>g.chainId===e.chainId&&!g.disabled))return r;let{dexDefaultFromToTokenShowVO:n}=this.commonStore.getChainByID(this.fromToStore.from.chainId),{fromDexMultiTokenInfoVO:i,toDexMultiTokenInfoVO:c,toCrossDexMultiTokenInfoVO:d}=n,m=o===E.BRIDGE,p;return m&&d?p=d:this.commonStore.equalsToken(t,c)?p=i:p=c,{toToken:p,isChanged:!0}}return r});s(this,"calcCurToChainIdIsInSupList",t=>{let e=!1;return q(this.computedToChain).forEach(o=>{Number(o.chainId)===Number(t)&&!o.disabled&&(e=!0)}),e});s(this,"updateTokenCollected",async(t,e=!1)=>{let{isConnectedWallet:o}=this.accountStore;if(!o){N.error(f("swaptrade_selecttoken_toast_connect_wallet"));return}let r=wt({},{tokenContractAddress:t?.tokenContractAddress||this.rootStore.klineStore.chooseTokenContractAddress,chainId:Number(t?.chainId),symbol:t?.tokenSymbol,decimal:t?.decimals,isCustomToken:t?.isCustomToken||t?.isSubscribe,walletAddress:this.accountStore.address||this.accountStore.computedAccountWalletAddressesArray[0],userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId}),[n,i]=await _(C.post(Ir,r));this.updateTokenCollectedLocal(t),n?(N.error(f("swaptrade_pricechart_no_connection_desc")),this.updateTokenCollectedLocal(wt({},t,{isCollectToken:t?.tokenInfo?0:1}))):i?.data===-1?e?N.error({title:f("swaptrade_selecttoken_modal_favorite_limitreached"),duration:.5}):this.setShowCollectOverLimitDialog(!0):i?.data===0?(N.success({title:f("swaptrade_selecttoken_toast_removed_from_favorite"),duration:.5}),this.rootStore.marketInfoStore.setIsCollected(!1)):i?.data===1&&(_r(),N.success({title:f("swaptrade_selecttoken_toast_added_to_favorite"),duration:.5}),this.rootStore.marketInfoStore.setIsCollected(!0))});s(this,"hideCollectCancelConfirm",D.get(yu));s(this,"showCollectOverLimitDialog",!1);s(this,"setShowCollectOverLimitDialog",t=>{this.showCollectOverLimitDialog=t});s(this,"setCommonlyUsedChain",t=>{let{from:e,to:o}=this.fromToStore,{chainList:r,currentTab:n}=this.commonStore,i=t&&t.length>0?t:[e.chainId,o.chainId];return Au(i,r,n)});s(this,"tokenPageChainList",[]);s(this,"setTokenPageChainList",t=>{this.tokenPageChainList=t});s(this,"getCurrentToChainInfo",()=>this.computedToChain.find(e=>tt(e.chainId)===tt(this.toSelectedChainId)));s(this,"changeTokenPageChainList",async t=>{if(this.tokenPageChainList.findIndex(o=>tt(o.chainId)===tt(t))===-1){let o=this.commonStore.chainList.find(n=>tt(n.chainId)===tt(t)),r=[...this.tokenPageChainList];r.unshift(o),r.length>4&&r.pop(),this.setTokenPageChainList(r)}this.tokenModalFromState===k.FROM?this.setFromSelectedChainId(t):this.setToSelectedChainId(t),await this.getTokenListByChainId()});s(this,"searchChainKeywords","");s(this,"setSearchChainKeywords",t=>{this.searchChainKeywords=t});s(this,"filterChains",t=>fo(t,e=>{let o=he(Es(this.searchChainKeywords));return he(e.chainName).includes(o)}));s(this,"dialogIndex",Ns.TOKEN_LIST);s(this,"setDialogIndex",t=>{this.dialogIndex=t});s(this,"hideTokenGuide",!!D.get(ku));s(this,"setHideTokenGuide",()=>{this.hideTokenGuide=!0,D.set(ku,"1")});s(this,"importToken",async(t,e)=>{let r=(await this.importUserToken(Array.isArray(t)?t:[t]))[0]||{};e&&e(r),Rr(r)&&await this.fromToStore.getTokenBalanceByAccount(this.tokenModalFromState,r),this.setImportTokenInfo({}),this.setDialogIndex(Ns.TOKEN_LIST)});s(this,"reloadTokenList",async()=>{!this.tokenModalVisible||(this.searchValue!==""?await this.getSearchTokenList():await this.getTokenListByChainId())});s(this,"selectTokenHandle",async t=>{let e=this.commonStore.getChainByID(Number(t?.chainId));if(await Cu(),!e)return;let{quoteStore:o}=this.rootStore,{from:r,updateFrom:n,updateTo:i,setBalance:c,setFromBalanceRequestError:d,setToBalanceRequestError:m,to:p,computedIsExactIn:g,needCrossChainDoubleConfirm:T,setNeedCrossChainDoubleConfirm:y}=this.fromToStore,{clearReceiveAddressValue:w}=this.rootStore.receiveAddressStore;this.setCommonlyUsedChain([t?.chainId]);let M=this.tokenModalFromState===k.FROM,O=()=>{this.rootStore.fromToStore.setCacheTokenInfo({chainId:t.chainId,tokenContractAddress:t.tokenContractAddress,amountNum:t.balance},"tokenList"),d(!1),c(k.FROM,t.balance)},lt=()=>{m(!1),c(k.TO,t.balance)};if(t.selected){M?lt():O(),this.fromToStore.onSwitchFromTo();return}M?O():lt();let ot=()=>{T||y(!0)};if(M){if(Aa(t.chainId,p.chainId)&&this.commonStore.currentTab===E.BRIDGE){let At=new re(this.commonStore.currentTab,{}),[Wt,Lt]=await At.fetchCrossChainTokens({fromChainId:t.chainId,fromTokenAddress:t.tokenContractAddress}),{amount:bn}=r,zo={...t},ho;Wt?(n({...zo,amount:bn}),ho=e?.dexDefaultFromToTokenShowVO?.toCrossDexMultiTokenInfoVO,i({...ho})):(zo=Lt.data.fromTokenInfo,ho=Lt.data.toTokenInfo,n({...zo,amount:bn}),i(ho),ot(),this.fromToStore.getTokenBalanceByAccount("from",zo)),this.fromToStore.getTokenBalanceByAccount("to",ho)}else if(!this.commonStore.equalsToken(t,r)){let{amount:At}=r;o.setQuoteNumber(2),n({...t,amount:At});let{toToken:Wt,isChanged:Lt}=this.checkFromToLegal(t,p);i(Wt),Lt&&(ot(),this.fromToStore.getTokenBalanceByAccount("to",q(Wt))),g&&this.fromToStore.advanceSetTypedValue("")}}else this.commonStore.equalsToken(t,p)||(ot(),o.setQuoteNumber(0),i({...t,amount:""}),g||this.fromToStore.advanceSetTypedValue(""));w()});this.rootStore=t,this.commonStore=t.commonStore,this.swapStore=t.swapStore,this.accountStore=t.accountStore,this.fromToStore=t.fromToStore}get computedIsSearching(){return!!this.searchValue}setSearchTokenList(t){this.searchTokenList=t}setError(t){this.error=t}setLoading(t,e,o){this.loading[t][e]=o}get computedTokenList(){return this.tokenModalFromState===k.FROM?this.fromTokenList.get(this.fromSelectedChainId):this.toTokenList.get(this.toSelectedChainId)}get computedSearchTokenList(){let t={};return Y(this.searchTokenList)||(t={systemList:this.extendTokenList(this.searchTokenList?.systemList,!1),thirdPartyList:this.extendTokenList(this.searchTokenList?.thirdPartyList,!1)}),t}toLowerCaseContractAddress(t){let e=[];return Array.isArray(t)&&t.forEach(o=>{e.push({...o,tokenContractAddress:this.commonStore.getTokenAddress(o)})}),e}isCancel(t){return Tt(t)}getSearchParams(){throw new Error("getSearchParams method must be implemented by subclass")}get computedFromChain(){let t=Go(),e=rs({});return[t,e,...q(this.tokenPageChainList)]}get computedToChain(){let t=Go();if(H(this.fromToStore.from.chainId)){let e=this.tokenPageChainList.filter(o=>o?.chainId===this.fromToStore.from.chainId);return[t,...e]}return[t]}get computedCurrentToChainId(){return this.toSelectedChainId||H(this.toSelectedChainId)?this.toSelectedChainId:H(this.fromToStore.to.chainId)?this.calcCurToChainIdIsInSupList(this.fromToStore.to.chainId)?this.fromToStore.to.chainId:this.fromToStore.from.chainId:this.computedToChain.length>1?kt.chainId:Ro}reassignTokenInfo(t,e,o){if(this.commonStore.equalsToken(t,e)){let r=e?.isCollectToken;return wt({},e,{isCollectToken:r?0:1,collectTime:r?"":Date.now().toString(),isCustomToken:o?1:e?.isCustomToken})}return t}filterCollectToken(t){let e=!t.isCustomToken||t.balance;return!!(!this.computedIsCollectChain&&e||this.searchValue||t.isCollectToken)}updateTokenCollectedLocal(t){let e=(o=[],r=!1)=>o.map(n=>this.reassignTokenInfo(n,t,r)).filter(n=>this.filterCollectToken(n));if(this.searchValue){let{systemList:o,thirdPartyList:r}=this.searchTokenList;this.setSearchTokenList({systemList:e(o),thirdPartyList:e(r,!0)})}else this.updateTokenList(e)}updateTokenList(t){if(this.tokenModalFromState===k.FROM){let e=t(this.fromTokenList.get(this.fromSelectedChainId));this.fromTokenList.set(this.fromSelectedChainId,e)}else if(this.tokenModalFromState===k.TO){let e=t(this.toTokenList.get(this.toSelectedChainId));this.toTokenList.set(this.toSelectedChainId,e)}}get computedCurrentChainId(){return tt(this.tokenModalFromState===k.FROM?this.fromSelectedChainId:this.toSelectedChainId)}get computedIsCollectChain(){return this.computedCurrentChainId===ft.chainId}setShowCollectCancelConfirm(t){D.set(yu,t),this.hideCollectCancelConfirm=t}get computedIsNotSupportToChain(){let t=this.getCurrentToChainInfo();return this.tokenModalFromState===k.TO&&t&&t.disabled}get computedSelectedChainId(){return this.tokenModalFromState===k.FROM?this.fromSelectedChainId||this.fromToStore.from.chainId:this.tokenModalFromState===k.TO?this.toSelectedChainId||this.fromToStore.to.chainId:""}get computedAllChainList(){let t=this.commonStore.chainList;return this.tokenModalFromState===k.FROM?{supported:t,unsupported:[]}:this.tokenModalFromState===k.TO?this.computedToChainList:{supported:[],unsupported:[]}}get computedToChainList(){let t=this.commonStore.chainList,e=Jo(q(t),{chainId:Number(this.fromToStore.to.chainId)});return{supported:e?[e]:[],unsupported:[]}}get computedIsSearchChainStatus(){return!!this.searchChainKeywords}get computedSearchedChainList(){if(!this.computedIsSearchChainStatus)return{supported:[],unsupported:[]};let{supported:t,unsupported:e}=this.computedAllChainList;return{supported:this.filterChains(t),unsupported:this.filterChains(e)}}get computedTokenGuideVisible(){return!1}};var ss=class extends Me{constructor(e){super(e);s(this,"showChainTab",!0);s(this,"clearCacheTokenList",()=>{this.fromTokenList.clear(),this.toTokenList.clear()});s(this,"extendTokenList",(e=[],o=!0)=>Y(e)?e:e?.map(r=>({...r,tokenList:this.extendTokens(r.tokenList,o)})));s(this,"generateToChainMap",()=>{let e=this.commonStore.chainList,r=Jo(q(e),{chainId:Number(this.fromToStore.from.chainId)})?.bridgeSupportChainInfoList||[];return Nn([...r],"chainId")});ut(this)}get computedTokenGuideVisible(){let{tokenModalFromState:e,hideTokenGuide:o}=this;return e===k.TO&&!o}get computedSearchTokenList(){return this.extendTokenList(this.searchTokenList?.list,!1)}get computedToChainList(){let e=this.commonStore.chainList,o=[],r=[],n=this.generateToChainMap();return e.forEach(i=>{let c={...i};c.disabled=!n[i.chainId],c.disabled||o.push(c)}),{supported:o,unsupported:r}}updateTokenCollectedLocal(e){let o=(r=[],n=!1)=>{let i=[];return r?.forEach(c=>{let d=c?.tokenList.map(m=>this.reassignTokenInfo(m,e,n)).filter(m=>this.filterCollectToken(m));i.push({tokenList:d})}),i};if(this.searchValue){let{list:r}=this.searchTokenList;this.setSearchTokenList({list:o(r)})}else this.updateTokenList(o)}get computedToChain(){let e=Go(),o=rs({});if(H(this.fromToStore.from.chainId)){let r=this.generateToChainMap(),n=[];return q(this.tokenPageChainList).forEach(i=>{i.chainId!==Number(this.fromToStore.from.chainId)&&n.push({...i,disabled:!r[i.chainId]})}),[e,o,...n]}return[e]}getSearchParams(e){let o=this.getSearchChainType(),r={inputContent:e,userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,chainType:o,userWalletAddress:this.accountStore.computedSpecialWalletAddress};return this.tokenModalFromState===k.FROM&&(r={...r,fromChainId:this.fromSelectedChainId},this.needRemoveChainId(this.fromSelectedChainId)&&delete r.fromChainId),this.tokenModalFromState===k.TO&&(r={...r,fromChainId:this.fromToStore.from.chainId,fromTokenAddress:this.fromToStore.from.tokenContractAddress||"",toChainId:this.toSelectedChainId},this.needRemoveChainId(this.toSelectedChainId)&&delete r.toChainId),r}};u();l();F();var hn=class{constructor(t){s(this,"sendTransactionParams",{});s(this,"waitingHandleOrderList",[]);s(this,"needIntercept",!1);s(this,"updateHistoryOrderList",t=>{let e=J(),o=[],r=[],n=this.rootStore.recentTransactionStore;n.pendingOrders.forEach(i=>{let c=i;i.orderId===t&&(c={...i,status:wr.PendingRedeeming}),o.push(c)}),!e&&n.history?.list?.forEach(i=>{let c=i;i.orderId===t&&(c={...i,status:wr.PendingRedeeming}),r.push(c)}),n.setPendingOrders(o),!e&&n.setHistory({...n.history,list:r})});s(this,"sendTransactionEnhance",async({callData:t,chainId:e,redeemOrderIdPre:o,redeemOrderId:r,bizType:n},i=()=>{})=>{let c=J(),d=`${o}:${r}`;if(!c&&this.setWaitingHandleList(d),this.needIntercept)return;let m;if(J()){let p=this.rootStore.swapStore.extendsGas(t);m=this.sendTransactionStore.sendTransactionEnhance(e,p,this.rootStore?.walletContractStore?.walletSendParams)}else{if(!await this.rootStore.commonStore.connectAndSwitchNetwork(e))return;m=this.sendTransactionStore.sendTransactionEnhance(t)}m.then(({result:p,hash:g,nonce:T})=>{!c&&this.setWaitingHandleList(d,!0),this.sendTransactionStore.updateTxHash({orderId:r,transactionHash:c?g:p,bizType:n,nonce:T}),Ca(i),this.updateHistoryOrderList(o),c||this.sendTransactionStore.getTransaction(p,e).then(y=>{A.info(v.UPDATE_NONCE,{nonce:y.nonce,tags:{orderId:r}}),this.sendTransactionStore.updateTxHash({orderId:r,transactionHash:p,nonce:y.nonce,bizType:n})}).catch(y=>{A.error(v.UPDATE_NONCE_FAIL,{error:y,transactionHash:p,tags:{orderId:r}})})}).catch(p=>{!c&&this.setWaitingHandleList(d,!0),A.error(v.REDEEM_ORDER_ERROR,{error:p,tags:{orderId:r}})})});s(this,"walletSendRedeem",()=>{this.sendTransactionEnhance(this.sendTransactionParams,()=>{b.history?.goBack()})});s(this,"facetOrderDetail",{});this.rootStore=t,this.sendTransactionStore=t.sendTransactionStore,L(this,{},{autoBind:!0})}setSendTransactionParams(t){this.sendTransactionParams=t}async launchFacetSwap(t){let e=J(),{data:o}=this.rootStore.recentTransactionStore.detail,r=t?t.orderId:o?.orderId,n=t?t.chainId:o?.fromChainId,i=t?t.toTokenAddress:o?.toTokenAddress,c=t?t.fromTokenAddress:o?.fromTokenAddress,d={orderId:r,chainId:n,userWalletAddress:this.rootStore.accountStore.getAddressByChainId(n)};if(e&&t?.goOrderDetail){b.history?.push(`${Te}/${r}`);return}let[m,p]=await _(C.post(Yi,d));if(m){A.error(v.REDEEM_ORDER_CALL_DATA_ERROR,{error:m,tags:{orderId:r}}),Number(m?.code)===100002&&this.rootStore.recentTransactionStore.removePendingOrder(r),N.error({title:m?.msg||f("swaptrade_top_notif_data_failed")});return}let{redeemSignatureVo:g,redeemDetailInfo:T,redeemOrderId:y,bizType:w}=p?.data||{},{unsignedTx:M,...O}=g||{},lt={...O,extParams:{toTokenAddress:i,crossChain:0,tokenAddress:c,amount:T.fromTokenAmount,toChainId:n,...d}},ot={callData:lt,chainId:n,redeemOrderIdPre:r,redeemOrderId:y,bizType:w};if(this.setSendTransactionParams(ot),A.info(v.REDEEM_ORDER,{callData:lt,tags:{orderId:y}}),e){this.setFacetOrderDetail({...T}),this.rootStore.walletContractStore.setTransactionPayload(lt),b.history?.push({pathname:Ft,search:`needUpdate=${cr.off}&type=${bt.REDEEM}`});return}await this.sendTransactionEnhance(ot)}setWaitingHandleList(t,e=!1){this.waitingHandleOrderList.find(r=>r===t)?e?(this.waitingHandleOrderList=this.waitingHandleOrderList.filter(r=>r!==t),this.needIntercept=!1):(N.warn({title:f("swaptrade_history_notification_desc_wallet_confirm")}),this.needIntercept=!0):(this.waitingHandleOrderList=[...this.waitingHandleOrderList,t],this.needIntercept=!1)}getFacetExploreUrl(t){let{data:e}=this.rootStore.recentTransactionStore.detail,o=[e?.fromChildOrderDetailVo?.exploreUrl,e?.relativeTransaction?.exploreUrl];return this.computedIsFacetTradeType&&o?.[t]||""}get computedIsFacetTradeType(){let{data:{specialOrderType:t}}=this.rootStore.recentTransactionStore.detail;return t===ec.FromIsEthChainFacetCoin}get computedShowFacetTip(){return this.rootStore.recentTransactionStore.detail.data.status===wr.PendingCanRedeem}setFacetOrderDetail(t){this.facetOrderDetail=t}get computedFacetOrderToFromRate(){let{price:t}=this.facetOrderDetail;return t&&!oe(t)&&t!=="-1"?Z(t):""}get computedFacetOrderFromToRate(){let{price:t}=this.facetOrderDetail;return t&&!oe(t)&&t!=="-1"?Z(I.BigNumber("1").div(t).toString(10),{needBillionMillionUnit:!1}):""}get computedFacetOrderTokens(){let{fromToken:t,toToken:e,fromTokenAmount:o,toTokenAmount:r}=this.facetOrderDetail;return{fromToken:{...t,amount:o},toToken:{...e,amount:r}}}get computedFacetOrderMinimumReceived(){return this.facetOrderDetail.minimumReceived}get computedFacetTipParams(){let t=this.rootStore.recentTransactionStore.detail?.data;return{amount:Z(t?.fromChildOrderDetailVo?.toAmountOut,{needBillionMillionUnit:!1}),token:t?.fromChildOrderDetailVo?.toTokenSymbol}}},ns=hn;u();l();P();P();F();var Fe=class{constructor(t){s(this,"liquidityModelVisible",!1);s(this,"dataStatus",et.DEFAULT);s(this,"setDataStatus",t=>{this.dataStatus=t});s(this,"rawData",[]);s(this,"LiquidityCancelRef",null);s(this,"fetchLiquidityData",async()=>{this.resetAllLiquidityData(),this.setDataStatus(et.LOADING);let{from:t}=this.fromToStore;this.LiquidityCancelRef&&this.LiquidityCancelRef.abort(),this.LiquidityCancelRef=$();let[e,o]=await _(C.get(Xi,{params:{chainId:t.chainId},signal:this.LiquidityCancelRef?.signal,isolate:!0}));if(e)this.setDataStatus(et.ERROR);else{let r=S(o,"data");Y(r)?this.setDataStatus(et.NULL):(this.initAllLiquidityData(r),this.setDataStatus(et.READY))}});s(this,"selectedListIds",[]);s(this,"setSelectedListIds",t=>{this.selectedListIds=t});s(this,"confirmIds",null);s(this,"setConfirmIds",t=>{this.confirmIds=t});s(this,"filterSelectedListIds",(t,e)=>{let o;e?o=bs(this.selectedListIds,t):o=Ln(this.selectedListIds,t),this.setSelectedListIds(Xt(o))});s(this,"searchLiquidityValue","");s(this,"setLiquiditySearchValue",t=>{this.searchLiquidityValue=t});this.rootStore=t,this.fromToStore=this.rootStore.fromToStore,L(this,{},{autoBind:!0})}setLiquidityModelVisible(t){this.liquidityModelVisible=t}setData(t){this.rawData=t}resetAllLiquidityData(){this.setData([]),this.setSelectedListIds([]),this.setConfirmIds(null)}initAllLiquidityData(t){this.setData(t);let e=Zo(t,"id");this.setSelectedListIds(e);let o=this.fromToStore.from.chainId;H(o)&&this.setConfirmIds(Bn({},o,e))}get computedListCheckedAll(){return this.computedSearchStatus?this.computedSearchIfAllChecked:this.selectedListIds.length===this.rawData.length}get computedCheckedAllDisabled(){return this.computedSearchStatus&&Y(this.computedSearchData)}get computedLiquidityNum(){let{from:t}=this.rootStore.fromToStore,e="--",{dataStatus:o,rawData:r,confirmIds:n}=this;if(o===et.NULL)e="0 / 0";else if(o===et.READY){let i=S(n,t.chainId);e=`${!i||i&&i.length===0?r.length:i.length} / ${r.length}`}return e}get computedClearAll(){return Y(this.selectedListIds)}checkAllBtn(){let t="",e=this.computedSearchStatus?this.computedSearchData:this.rawData,o=Zo(e,"id");this.computedListCheckedAll?t=bs(this.selectedListIds,...o):t=Un(this.selectedListIds,o),this.setSelectedListIds(Xt(t))}get computedCheckedData(){return Zo(this.rawData,e=>({...e,isChecked:!!Pn(this.selectedListIds,e.id)}))}get computedSortListData(){return Oa(this.computedCheckedData)}get computedSearchStatus(){return!!this.searchLiquidityValue}get computedSearchDataIsNull(){return this.computedSearchStatus&&Y(this.computedSearchData)}get computedSearchData(){return Pa(this.computedCheckedData,this.searchLiquidityValue)}get computedSearchIfAllChecked(){let t=wn(this.computedSearchData,e=>e?.isChecked);return!Y(this.computedSearchData)&&t}get computedShowData(){return this.searchLiquidityValue?this.computedSearchData:this.computedSortListData}get computedIds(){return S(this.rootStore.liquidityChooseStore?.confirmIds,this.rootStore.fromToStore?.from.chainId)}get computedIsCustomLiquidity(){return(this.computedIds||[]).length<this.rawData.length}get computedMonitorLiquidSelectType(){let{computedIds:t=[],rawData:e}=this;return!t.length||t.length===e?.length?"all":t.length>1?"custom_>1":t.length===1?"custom_=1":""}get computedIsSelectedAllDex(){let{computedIds:t=[],rawData:e}=this;return!t.length||t.length===e?.length}};u();l();P();F();var fn=class{constructor(t){s(this,"orderCheckContinue",async t=>{let[e,o]=await _(C.get(zi,{params:t}));if(e)return N.error({title:f("swaptrade_history_toast_setup_error"),duration:Pt}),!1;let r=S(o,"data"),n=String(r?.checkCode);return n===Xe.SUCCESS?!0:(n===Xe.SINGLE_ERROR||n===Xe.LIMIT_SINGLE_ERROR?N.error({title:f("swaptrade_history_toast_chain_unsupported",{chain:r?.fromChainName}),duration:Pt}):n===Xe.CROSS_ERRORL||n===Xe.LIMIT_CROSS_ERRORL?N.error({title:f("swaptrade_history_toast_both_unsupported",{fromChain:r?.fromChainName,toChain:r?.toChainName}),duration:Pt}):N.error({title:f("swaptrade_history_toast_setup_error"),duration:Pt}),!1)});this.rootStore=t,L(this,{},{autoBind:!0})}},is=fn;u();l();P();var{BigNumber:_u}=I,gn="safemoon_slippage",Sn="safemoon_is_changed",Eu=50,Tn={NeedIncreaseSlip:0,AdviseGivenSlip:1,NotAvailableGivenSlip:2,AdviseSlip:3},Be=class{constructor(t){s(this,"isChanged",!1);s(this,"getSafemoonIsChangedLocal",()=>!!D.get(`${Sn}_${this.computedSlippageTokenPair}`));s(this,"cacheSlippage",0);L(this),this.rootStore=t,this.commonStore=t.commonStore,this.fromToStore=t.fromToStore,Et(()=>this.computedSlippageTokenPair,()=>{this.setSafeMoonIsChanged(D.get(`${Sn}_${this.computedSlippageTokenPair}`)),this.setCacheSlippage(D.get(`${gn}_${this.computedSlippageTokenPair}`))}),Et(()=>({slippage:this.computedPairSlippage}),()=>{this.cacheSlippage>0&&this.computedPairSlippage>this.cacheSlippage&&this.setSafeMoonIsChanged(!1),this.setCacheSlippage(D.get(`${gn}_${this.computedSlippageTokenPair}`))}),Et(()=>this.computedSlippage,e=>{this.commonStore.safemoonSlippage=e})}setSafeMoonIsChanged(t){this.isChanged=t,D.set(`${Sn}_${this.computedSlippageTokenPair}`,t)}checkIsChanged(t){let e=new _u(t),o=e.gte(this.computedPairSlippage)&&e.lte(50);o&&this.setSafeMoonIsChanged(o)}setSafeMoonPairSlippage(t){!this.isAccessSlippage(t)||(this.setCacheSlippage(t),D.set(`${gn}_${this.computedSlippageTokenPair}`,t))}isAccessSlippage(t){let e=new _u(t);return this.computedPairSlippage>0&&e.gte(this.computedPairSlippage)&&e.lte(50)}get computedAutoSlippage(){return es(this.rootStore)}get computedSafeMoonToken(){let{from:t,to:e}=this.fromToStore;return this.checkIsSafeMoon(t)?t:this.checkIsSafeMoon(e)?e:null}get computedHoneypot(){let{from:t,to:e}=this.fromToStore;return this.checkIsHoneypot(t)?t:this.checkIsHoneypot(e)?e:null}setCacheSlippage(t){this.cacheSlippage=t}get computedPairSlippage(){return this.computedSafeMoonToken?1.1:0}get computedSlippage(){return this.cacheSlippage>this.computedPairSlippage?this.cacheSlippage:this.computedPairSlippage}get computedOverLimit(){return this.computedSlippage>50}get computedSlippageTokenPair(){let{from:t,to:e}=this.fromToStore;return`${this.checkIsSafeMoon(t)?t.tokenContractAddress:""}_${this.checkIsSafeMoon(e)?e.tokenContractAddress:""}`}get computedSlippageTips(){let t=S(this,"rootStore.quoteStore.quote.bestRoute"),e=Number(this.computedAutoSlippage),{tokenSymbol:o}=this.computedSafeMoonToken||{};return t?.isSafeMoonToken!=="1"||t?.isHoneypot==="1"?null:e===Eu?{type:Tn.AdviseGivenSlip,safeMoonSlippage:e,equalLimit:!0,tip:f("swaptrade_card_errortip_autoadjust_to_50",{tokenSymbol:o,slippageTolerance:e}),tipEquation:f("swaptrade_card_errortip_autoadjust_to_50",{tokenSymbol:W(o),slippageTolerance:e}),inputWarning:f("swaptrade_adjustslip_modal_advise_givenslip")}:e>Eu?{type:Tn.NotAvailableGivenSlip,overLimit:!0,safeMoonSlippage:e,tip:f("wallet_swap_adjustslip_modal_slip_notsupported",{tokenSymbol:o}),tipEquation:f("wallet_swap_adjustslip_modal_slip_notsupported",{tokenSymbol:W(o)})}:{type:Tn.AdviseSlip,safeMoonSlippage:e,tip:f("swaptrade_card_errortip_autoadjust_to_less50",{slippageTolerance:e,tokenSymbol:o}),tipEquation:f("swaptrade_card_errortip_autoadjust_to_less50",{slippageTolerance:e,tokenSymbol:W(o)}),inputWarning:f("swaptrade_modal_errortip_adjust_to_suggested_range",{slippageTolerance:e})}}checkIsSafeMoon(t){return S(t,"isSafeMoonToken")===1}checkIsHoneypot(t){return S(t,"isHoneypot")===1}get computedInputVal(){let{computedIsExactIn:t,computedSwapAmount:e}=this.fromToStore;return!t&&this.computedHoneypot?"":e[k.FROM]}get computedInputFiatVal(){let{computedIsExactIn:t,computedFromLocalCostByUsd:e}=this.fromToStore;return!t&&this.computedHoneypot?"":e}get computedOutputVal(){let{computedIsExactIn:t,computedSwapAmount:e}=this.fromToStore;return t&&this.computedHoneypot?"":e[k.TO]}get computedOutputFiatVal(){let{computedIsExactIn:t,computedToLocalCostByUsd:e}=this.fromToStore;return t&&this.computedHoneypot?"":e}get computedOutputPopVal(){let{computedSwapAmount:t}=this.fromToStore;return this.computedHoneypot?"":Ce(t[k.TO])}};u();l();var as=class{constructor(){s(this,"gasDropConfig",{gasDropShow:!1,gasDropSwitch:D.get(Os)===ri.OPEN,chainName:"",chainId:"",deduction:"",gasDrop:"",tokenLogoUrl:"",tokenSymbol:""});s(this,"setGasDropInfo",t=>{this.gasDropConfig={...this.gasDropConfig,...t}});s(this,"setGasDropSwitch",t=>{this.setGasDropInfo({gasDropSwitch:t}),D.set(Os,`${Number(t)}`)});s(this,"resetGasDrop",()=>{this.setGasDropInfo({gasDropShow:!1})});L(this)}get computedGasDropSelected(){let{gasDropShow:t,gasDropSwitch:e}=this.gasDropConfig;return t&&e}};u();l();var In=class{constructor(t){s(this,"isShowMev",!1);s(this,"setShowMev",t=>{this.isShowMev=t});s(this,"isMevUserSwitchOpen",ur.DEFAULT);s(this,"setMevUserSwitchOpen",t=>{this.isMevUserSwitchOpen=t});s(this,"mevInfo",{});s(this,"setMevInfo",t=>{this.mevInfo=t});s(this,"walletMevControl",!1);s(this,"setWalletMevControl",t=>{this.walletMevControl=t});this.rootStore=t,this.quoteStore=this.rootStore.quoteStore,this.fromToStore=this.rootStore.fromToStore,L(this,{},{autoBind:!0})}get computedIsMevOpen(){return this.isShowMev&&(this.isMevUserSwitchOpen===ur.ON||this.isMevUserSwitchOpen===ur.DEFAULT)}},cs=In;u();l();P();var Cn=class{constructor(t){s(this,"feeConfig",{});s(this,"setFeeConfig",t=>{if(!this.isIframe)return;if(!Y(t)){this.feeConfig=t,jt.set("feeConfig",t);return}let e=jt.get("feeConfig"),o=pe(e,["referrerAddress","feePercent"]);Y(o)?(this.feeConfig={},jt.remove("feeConfig")):this.feeConfig=o});s(this,"widgetFeeConfig",{});s(this,"setWidgetFeeConfig",t=>{this.isWidget&&(this.widgetFeeConfig=t)});s(this,"receiveQuoteUrl",()=>this.isIframe?Ci:yi);s(this,"aggregatorQuoteUrl",()=>_i);s(this,"saveOrderUrl",()=>this.isIframe?Ri:Sr);s(this,"illegalFeePercent",t=>{let{BigNumber:e}=I,o=e(t);return!!(o.isNaN()||o.gt(di)||o.lte(0))});s(this,"extendFeeConfig",t=>{if(this.isWidget){let o=S(this.widgetFeeConfig,[t.chainId],{});if(typeof o.referrerAddress=="string")return{...t,...o};let r=S(o,["referrerAddress",t.fromTokenAddress]),n=S(r,"account"),c=S(r,"feePercent")||o.feePercent;return n?{...t,referrerAddress:n,feePercent:c}:t}if(!this.computedHasFeeConfig)return t;let e=Y(this.feeConfig)?jt.get("feeConfig"):this.feeConfig;return{...t,...e}});L(this),this.rootStore=t,this.isIframe=!J()&&ya()&&!no,this.isWidget=!J()&&ka()}get computedHasFeeConfig(){return!!this.feeConfig?.referrerAddress&&!!this.feeConfig?.feePercent&&this.isIframe}get computedFeeConfigErrorTips(){return this.computedHasFeeConfig?this.illegalFeePercent(this.feeConfig?.feePercent):!1}},us=Cn;u();l();F();u();l();P();F();u();l();var Ru=()=>{let{swapStore:a,intentSwapStore:t,swapDappStore:e,approveStore:o,fromToStore:r}=B(),{from:n,to:i}=r;return!(!i?.tokenContractAddress||!n?.tokenContractAddress||o.visibleApprove||a.isConfirmLoading||t.isConfirmLoading||e.computedSupportDappTradeByChain)};u();l();u();l();var bu=a=>{let{fromToStore:t,quoteStore:e}=B(),{commonDexInfo:o,pathSelectionRouterList:r,singleChainSwapInfo:n}=a,{computedIsSingleChain:i}=t,c=Number(o?.code)===Mt.CROSS_CHAIN_INTERVAL,d=c?{crossMaxAmount:o?.crossMaxAmount,crossMiniAmount:o?.crossMiniAmount}:null;return e.setQuoteScope(d),{isAutoError:c||(i?!n:!r?.length)}};var sd=({quoteStore:a,fromToStore:t})=>{a.setQuoteNumber(a.quoteNumber+1),a.quoteNumber===1&&a.checkQuoteScopeLtMin(a.quoteScope,t.from.amount)&&t.advanceSetTypedValue("")},nd=(a,{fromToStore:t,quoteStore:e})=>{let{commonDexInfo:o,pathSelectionRouterList:r,singleChainSwapInfo:n,swapType:i,intentCode:c,isSupportDappTrade:d,offlineType:m,traceData:p}=a,g={intentCode:c,offlineType:m,swapType:i,traceData:p},T=r?.map(w=>({...o,...w,...g,isSupportDappTrade:d}));return{bestRoute:t.computedIsSingleChain?{...o,...n,...g,intentInfo:a?.intentInfo||{},isSupportDappTrade:d}:e.pickBestRouterAccordingBridgeId(T)||{...o,...g,isSupportDappTrade:d},combineSelectionRouterList:T}},id=({bestRoute:a,combineSelectionRouterList:t,isAutoError:e},{fromToStore:o,quoteStore:r})=>{r.updateSlippageInfoFetched(a),r.setQuote({...r.quote,bestRoute:a,quoteNull:e,quoteError:null,isFetchQuoting:!1}),o.quoteUpdateFromTo(a),o.computedIsSingleChain||r.setPathSelectionRouterList(t||[])},Qo=({isAutoError:a},{approveStore:t})=>{a||t.isPendingNotCheck().catch(()=>{})},Ho=({isAutoError:a},{quoteStore:t})=>{a&&(t.handleReverseQuoteErrorAndNull(),ht(()=>{t.updateQuoteStatus(t.quoteScope?2:3)}))},ad=a=>{let{solanaPriorityFeeStore:t}=B();t&&t.setJitoData(a?.priorityFeeInfo)},vu=a=>{let{fromToStore:t,quoteStore:e,approveStore:o}=B(),{isAutoError:r}=bu(a);sd({quoteStore:e,fromToStore:t});let{bestRoute:n,combineSelectionRouterList:i}=nd(a,{fromToStore:t,quoteStore:e});id({bestRoute:n,combineSelectionRouterList:i,isAutoError:r},{fromToStore:t,quoteStore:e,approveStore:o}),ad(a),Qo({isAutoError:r},{approveStore:o}),Ho({isAutoError:r},{quoteStore:e})};u();l();var jo=class{constructor(t){s(this,"allTimerAndQuoteState",{[it.DEFAULT]:{isShowLoadingCpt:!1,quoteText:()=>""},[it.QUOTING]:{isShowLoadingCpt:!0,quoteText:()=>f(or)},[it.TIMER]:{isShowLoadingCpt:!0,quoteText:()=>f(or)},[it.QUOTE_IS_HONEYPOT]:{isShowLoadingCpt:!1,quoteText:()=>f(rr)},[it.QUOTE_NULL]:{isShowLoadingCpt:!0,quoteText:()=>f(rr)},[it.QUOTE_NULL_AND_SECTION]:{isShowLoadingCpt:!0,quoteText:()=>f(or)},[it.QUOTE_ERROR]:{isShowLoadingCpt:!1,quoteText:()=>f(rr)}});Object.assign(this,t)}isValidRange(t){if(typeof t!="string")return!1;let{from:e}=this.fromToStore,o=t.split("-");if(o.length!==2)return!1;let{BigNumber:r}=I;return r(e.amount).lt(o[0])||r(e.amount).gt(o[1])}getCurrentTimerQuoteState(){let{quoteNull:t,isFetchQuoting:e,quoteError:o,bestRoute:r}=this.quote,n=this.fromToStore?.computedIfQuote,i=o!==null;return n?i?this.allTimerAndQuoteState[it.QUOTE_ERROR]:this.rootStore.safeMoonStore.computedHoneypot?this.allTimerAndQuoteState[it.QUOTE_IS_HONEYPOT]:t?r?.msg&&(e||this.isValidRange(r.msg))?this.allTimerAndQuoteState[it.QUOTE_NULL_AND_SECTION]:this.allTimerAndQuoteState[it.QUOTE_NULL]:e?e?this.allTimerAndQuoteState[it.QUOTING]:this.allTimerAndQuoteState[it.DEFAULT]:this.allTimerAndQuoteState[it.TIMER]:this.allTimerAndQuoteState[it.DEFAULT]}};var{FACET_TOKEN_ERROR_ONE:ud,FACET_TOKEN_ERROR_TWO:ld,FACET_TOKEN_ERROR_THREE:dd}=Mt,Ue=class{constructor(){s(this,"dialogCloseFlag",!1);s(this,"slippageInfoFetched",!1);s(this,"setDialogCloseFlag",t=>{this.dialogCloseFlag=t});s(this,"enableQuoteAggregates",!1);s(this,"dialogShowQuotationComparison",!1);s(this,"setDialogShowQuotationComparison",t=>{this.dialogShowQuotationComparison=t});s(this,"quoteNumber",0);s(this,"setQuoteNumber",t=>{this.quoteNumber=t});s(this,"aggregateSelectId",vt);s(this,"isDialog",!1);s(this,"setIsDialog",t=>{this.isDialog=t});s(this,"initQuote",{bestRoute:null,quoteError:null,quoteNull:!1,isFetchQuoting:!1});s(this,"isPickRouterFromWallet",!1);s(this,"setIsPickRouterFromWallet",t=>{this.isPickRouterFromWallet=t});s(this,"quoteScope",null);s(this,"setQuoteScope",t=>{this.quoteScope=t});s(this,"fetchQuoteStatus",0);s(this,"quote",{...this.initQuote});s(this,"setQuote",t=>{this.quote=t});s(this,"pathSelectionRouterList",[]);s(this,"setPathSelectionRouterList",t=>{this.pathSelectionRouterList=t});s(this,"pickRouter",{});s(this,"setPickRouter",(t,e)=>{this.pickRouter=t,e&&(this.setNoCurrentPathTipInfo({bridgeName:t?.bridge?.bridgeName}),this.updateBestRoute(t))});s(this,"showChainListModel",!1);s(this,"setShowChainListModel",t=>{this.showChainListModel=t});s(this,"noCurrentPathTipInfo",{visible:!1,bridgeName:""});s(this,"setNoCurrentPathTipInfo",t=>{this.noCurrentPathTipInfo={...this.noCurrentPathTipInfo,...t}});s(this,"currentBridgeId","");s(this,"setCurrentBridgeId",t=>{this.currentBridgeId=t});s(this,"updateBestRoute",t=>{this.setQuote({...this.quote,bestRoute:t}),this.rootStore.fromToStore?.quoteUpdateFromTo(t)});s(this,"pickBestRouterAccordingBridgeId",t=>{let{smartRouterStore:{showXRouteModal:e}}=this.rootStore;if(!t||t.length===0)return null;let o=t.find(r=>r?.bridge?.bridgeId===this.currentBridgeId);return this.currentBridgeId&&!o&&(this.setCurrentBridgeId(""),!this.showChainListModel&&e!==fr.ROUTER_SELECT&&this.setNoCurrentPathTipInfo({visible:!0})),o||t?.[0]});s(this,"quoteTimer",null);s(this,"clearQuote",()=>{this.cleanQuoteTimer(),this.setQuote(this.initQuote),this.rootStore.fromToStore?.quoteUpdateFromTo(null),this.quotePending=!1;let{computedIsCrossChain:t,computedIfQuote:e}=this.fromToStore;t?(this.setBridgeQuoteSelectStatus(0),this.setBridgeFetchStatus(e?1:0)):(this.setAggregateSelectStatus(0),this.setAggregateFetchStatus(e?1:0))});s(this,"cancelRef",null);s(this,"cleanQuoteTimer",()=>{clearTimeout(this.quoteTimer),this.quoteTimer=null,this.cancelRef&&this.cancelRef.abort()});s(this,"isClearQuote",()=>{let{currentTab:t}=this.commonStore,{computedTypedValue:e,from:o,to:r,computedIsSingleChain:n,computedIsExactIn:i}=this.fromToStore;return t===E.LIMIT_ORDER||!Kt(e)||!r?.tokenContractAddress||!o?.tokenContractAddress||!i&&!n});s(this,"getQuoteData",t=>{let e=Nt();return _(io(()=>C.get(this.getQuoteStoreUrl(),{params:e,signal:t,isolate:!0}),Ht.NUM,Ht.TIMER))});s(this,"handleUpdateQuote",t=>{if(t){let{data:e}=t;vu(e)}});s(this,"fetchQuote",async({source:t}={})=>{if(!Ru())return this.quoteTimer=setTimeout(()=>{this.fetchQuote().catch(()=>{})},Ps),Promise.resolve(!1);if(t===0){let{computedIsCrossChain:r}=this.fromToStore;r?(this.setBridgeQuoteSelectStatus(0),this.setBridgeFetchStatus(1),this.setBridgeSelectId(vt)):(this.setAggregateSelectStatus(0),this.setAggregateFetchStatus(1),this.setAggregateSelectId(vt))}if(this.isClearQuote())return this.quoteScope=null,this.clearQuote(),Promise.resolve(!1);if(this.cleanQuoteTimer(),this.rootStore.outerStore.computedFeeConfigErrorTips)return this.handleQuoteError(null),Promise.resolve(!1);this.setQuote({...this.quote,isFetchQuoting:!0}),this.cancelRef=$();let[e,o]=await this.getQuoteData(this.cancelRef.signal);return this.quotePending=!1,!Tt(e)&&e&&this.handleQuoteError(e),this.handleUpdateQuote(o),this.setIsPickRouterFromWallet(!1),this.commonStore.setResetFromToByTabChange(!1),!Tt(e)&&!this.dialogCloseFlag&&ht(()=>{this.quoteTimer=setTimeout(()=>{this.fetchQuote().catch(()=>{})},Ps)}),Promise.resolve(!0)});s(this,"quotePending",!1);s(this,"debounceQuote",Qe(this.fetchQuote,lr));s(this,"fetchQuoteDebounce",async({source:t}={})=>{let{computedIsCrossChain:e,computedIfQuote:o}=this.fromToStore;this.quotePending=!0,o&&e?await this.debounceQuote({source:t}):o&&!e?this.debounceQuote({source:t}):this.clearQuote()});s(this,"handleQuoteError",t=>{this.setQuote({...this.initQuote,quoteError:t}),this.handleReverseQuoteErrorAndNull()});s(this,"getGasTokenFeeLoading",!1);s(this,"getGasTokenFeeCancelRef",null);s(this,"cancelGasTokenGeeRequest",()=>{this.getGasTokenFeeCancelRef&&(this.getGasTokenFeeCancelRef.abort(),this.getGasTokenFeeCancelRef=null)});s(this,"cacheNativeGasFee","");s(this,"setCacheNativeGasFee",t=>{this.cacheNativeGasFee=t});s(this,"fetchGasTokenFee",async()=>{let{from:t}=this.rootStore.fromToStore,{computedReserveGas:e}=this.rootStore.commonStore,{decimals:o,balance:r}=t||{},n=Dn(Nt(),["dexIds"]);this.getGasTokenFeeCancelRef=$();let i=this.rootStore.fromToStore?.computedIsExactIn?Ii:Ai;this.getGasTokenFeeLoading=!0;let c=this.getGasTokenFeeCancelRef.signal,d=e,[m,p]=await _(C.get(i,{params:{...n,amount:ga(r,o)},signal:c}));if(this.getGasTokenFeeLoading=!1,!Tt(m)&&m)return-1;if(!m){let{data:g}=p||{},{commonDexInfo:T}=g||{};Number(T?.code)===0&&T?.estimateReserveGasTokenFee!==""&&(d=T.estimateReserveGasTokenFee)}return this.setCacheNativeGasFee(d),d})}initQuoteStatus(){this.fetchQuoteStatus=0}updateQuoteStatus(t){this.fetchQuoteStatus=t}get computedSlippage(){let{computedIsSingleChain:t,computedDefaultAutoSlippageInfo:e}=this.fromToStore,o=this.rootStore.slippageStore,r=qo({isSingleChain:t,autoSlippageInfo:e}),n=Ae.AUTO;return o&&(r=o.computedRealSlippageValue,n=o.getSlippageType()),!this.slippageInfoFetched&&n===Ae.AUTO&&(n=Ae.DEFAULT),{slippage:r,slippageType:n}}getQuoteStoreUrl(){return this.outerStore.receiveQuoteUrl()}handleReverseQuoteErrorAndNull(){let{updateFromAmount:t,computedIsExactIn:e,updateTo:o}=this.fromToStore;e?o({amount:""}):t({amount:""})}getQuoteError(t){let{commonDexInfo:e,pathSelectionRouterList:o,singleChainSwapInfo:r}=t,{computedIsSingleChain:n}=this.fromToStore,i=Number(e?.code)===Mt.CROSS_CHAIN_INTERVAL,c=i?{crossMaxAmount:e?.crossMaxAmount,crossMiniAmount:e?.crossMiniAmount}:null;return this.setQuoteScope(c),{isAutoError:i||(n?!r:!o?.length)}}updateSlippageInfoFetched(t){let{autoSlippage:e,autoTotalSlippage:o}=t?.autoSlippageInfo||{};(e||o)&&(this.slippageInfoFetched=!0)}checkQuoteScopeLtMin(t,e){if(!t||!e)return!1;let{crossMiniAmount:o}=this.quoteScope||{};return!!I.BigNumber(e).lt(I.BigNumber(o))}get computedCurrentTimerQuoteState(){return new jo(this).getCurrentTimerQuoteState()}get computedRouterForSmartRouterStore(){return this.fromToStore?.computedIsSingleChain?this.quote?.bestRoute:this.pickRouter}get computedMediaForChangeSmartRouterData(){return Ga()?.media==="sm"||this.isDialog}get computedQuoteAmount(){let{computedIsExactIn:t}=this.fromToStore;return t?this.quote?.bestRoute?.fromTokenAmount:this.quote?.bestRoute?.payAmount}get computedQuoteIntervalIsEmpty(){return this.computedQuoteInterval.type===X.EMPTY}get computedQuoteInterval(){let{safeMoonStore:t,fromToStore:e,approveStore:o,swapBtnStore:r,swapDappStore:n}=this.rootStore;if(t.computedHoneypot||e.computedFormToTokenIsLeverageToken)return{type:X.EMPTY};let i=Qa.handleQuoteErrorState({quote:this.quote,honeypotToken:S(this,"rootStore.safeMoonStore.computedHoneypot",!1)})||this.accountStore.computedNonsupportChain,{from:c,computedNonsupportFacetToken:d}=this.fromToStore;if(i||d)return{type:X.EMPTY};if(n.checkShouldJumpToDapp())return{type:X.SHOULD_JUMP_DAPPS};if(this.computedNotSupportBtcAddress&&this.accountStore.isConnectedWallet)return{type:X.NOT_SUPPORT_BTC_ADDRESS_TYPE,text:this.quote.bestRoute?.errorMsg};if(this.computedIsNoOkxLiquidity)return{type:X.NOT_OKX_LIQUIDITY};if((!this.quoteScope||!e.computedIfQuote)&&this.fetchQuoteStatus!==3&&!o.computedIsCancelApproveStatus&&!this.computedPriceWarn.show&&!this.quote?.bestRoute?.errorMsg)return{type:X.EMPTY};if(this.computedCrossAccuracyLimit)return{type:X.CROSS_CHAIN_ACCURACY,text:f("swaptrade_card_tooltips_adjust_pay_token_decimal",{fromToken:c.tokenSymbol,value:this.computedCrossAccuracyLimit}),equation:f("swaptrade_card_tooltips_adjust_pay_token_decimal",{fromToken:W(c.tokenSymbol),value:this.computedCrossAccuracyLimit})};if(this.computedFacetTokenTips)return{type:X.FACET_TOKEN_SWAP_ERROR,text:this.computedFacetTokenTips};let{crossMiniAmount:p,crossMaxAmount:g}=this.quoteScope||{};if(I.BigNumber(c.amount).lt(I.BigNumber(p))){let T=Z(p,{cutPriceText:!0,isFloor:!1});return{type:X.CROSS_CHAIN_MIN,text:f("swaptrade_bridge_toast_min_amout_crosschain_swap",{value:T,symbol:c.tokenSymbol}),equation:f("swaptrade_bridge_toast_min_amout_crosschain_swap",{value:T,symbol:W(c.tokenSymbol)})}}if(I.BigNumber(c.amount).gt(I.BigNumber(g))){let T=Z(g,{cutPriceText:!0});return{type:X.CROSS_CHAIN_MAX,text:f("swaptrade_bridge_toast_max_amout_crosschain_swap",{value:T,symbol:c.tokenSymbol}),equation:f("swaptrade_bridge_toast_max_amout_crosschain_swap",{value:T,symbol:W(c.tokenSymbol)})}}return this.quote?.bestRoute?.errorMsg?{type:X.CROSS_CHAIN_MORE_TIPS,text:this.quote?.bestRoute?.errorMsg}:this.computedIsNoLiquidity?{type:X.NOT_LIQUIDITY}:this.computedCrossChainIntervalOutOfRange?{type:X.NOT_LIQUIDITY}:o.computedIsCancelApproveStatus&&!r.computedTooBalance?{type:X.CANCEL_APPROVE_TIPS}:this.computedPriceWarn.show?{type:X.PROVIDER_PRICE_WARN}:{type:X.EMPTY}}get computedNotSupportFromBtcAddressType(){let t=this.quote?.bestRoute?.code;return Number(t)===Mt.NOT_SUPPORT_FROM_BTC_ADDRESS}get computedNotSupportToBtcAddressType(){let t=this.quote?.bestRoute?.code;return Number(t)===Mt.NOT_SUPPORT_TO_BTC_ADDRESS}get computedNotSupportBtcAddress(){return this.computedNotSupportFromBtcAddressType||this.computedNotSupportToBtcAddressType}get computedCrossChainIntervalOutOfRange(){let{from:t}=this.fromToStore,{crossMiniAmount:e,crossMaxAmount:o}=this.quoteScope||{};return I.BigNumber(t.amount).lte(o)&&I.BigNumber(t.amount).gte(e)}get computedIsNoLiquidity(){return this.fetchQuoteStatus===3&&this.quote.quoteNull}get computedIsNoOkxLiquidity(){let t=this.quote?.bestRoute?.defiPlatformInfoList;return this.enableQuoteAggregates&&t&&this.aggregateFetchStatus===3?!t.some(o=>o?.defiPlatformId===z):!1}get computedCrossAccuracyLimit(){let{crossAccuracyLimit:t,code:e}=this.quote.bestRoute||{};return Number(e)===Mt.CROSS_CHAIN_ACCURACY?t:""}get computedFacetTokenTips(){let{errorMsg:t,code:e}=this.quote.bestRoute||{};return[ud,ld,dd].includes(Number(e))&&t?t:""}get computedYouSaveVisible(){let{computedNowCurrencySymbol:t,currencyConversion:e,computedIsWalletEnv:o}=this.commonStore,{computedIsExactIn:r,computedIsCrossChain:n}=this.rootStore.fromToStore,{quoteError:i,quoteNull:c,bestRoute:d}=this.quote;if(!r||i||c||!d?.youSaveDTO||n)return{visible:!1};let{youSaveDTO:m,fromToken:p,toToken:g}=d,{topTenDexInfoList:T,youSaveMoney:y}=m,w=Number(y)>=.1&&T?.length>0&&!p.isHoneypot&&!g.isHoneypot,M=e(y).toString(),O=w?St(M,t,{isFloor:!1}):"",lt=w?T?.[1]?.dexName:"";return o&&(!n&&this.computedTopTenDexInfoList.length>0?w=!0:w=!1),{visible:w,youSaveStr:O,dexName:lt}}get computedHasYouSave(){let{computedIsCrossChain:t}=this.rootStore.fromToStore;return!!this.quote?.bestRoute?.youSaveDTO||t}get computedTopTenDexInfoList(){if(!this.rootStore.fromToStore?.computedIsExactIn||!this.computedHasYouSave)return[];let{computedNowCurrencySymbol:t,currencyConversion:e}=this.commonStore;return this.quote?.bestRoute?.youSaveDTO?.topTenDexInfoList?.map(({logoUrl:o,dexName:r,comparePercent:n,price:i,dexAmountOut:c,amountOutOfMoney:d,gasOfMoney:m,isOkxDex:p})=>{let g=e(d)?.toString(),T=e(m)?.toString();return{logoUrl:o,dexName:r,comparePercent:n,price:i,isOkxDex:p,formatPrice:Z(i),dexAmountOut:I.BigNumber(c).toString(),formatDexAmountOut:Z(c),amountOutOfMoney:g,formatAmountOutOfMoney:St(g,t,{needBillionMillionUnit:!1}),gasOfMoney:St(T,t),symbol:t||""}})??[]}get computedReferredFee(){let{bestRoute:t}=this.quote,{referredNetWorkFee:e,referredAmount:o}=t||{};if(!o||!e)return"";let{computedNowCurrencySymbol:r,currencyConversion:n}=this.commonStore,{from:i}=this.fromToStore;return f("swaptrade_modal_desc_crosschain_valuediff_variavle",{price:`${Z(o)} ${i.tokenSymbol}`,fee:`${St(n(e).toString(),r)}`})}get computedIsUsingCentralizedBridge(){let t=["8"],e=String(this.quote.bestRoute?.bridge?.bridgeId);return t.includes(e)}get computedIsNoQuote(){return this.quote.quoteError||this.quote.quoteNull||!this.quote.bestRoute||this.rootStore.safeMoonStore?.computedHoneypot||this.fromToStore.computedFormToTokenIsLeverageToken||this.rootStore.outerStore.computedFeeConfigErrorTips||!this.fromToStore.computedTypedValueIsValid}get computedSupportDappTradeByQuote(){return Number(this.quote?.bestRoute?.isSupportDappTrade)===1}setAggregateFetchStatus(t){return t}setAggregateSelectStatus(t){return t}setAggregateSelectId(t){return t}get computedIsOfflineType(){let{computedIsCrossChain:t}=this.rootStore.fromToStore;return t?Number(this?.quote?.bestRoute?.bridge?.bridgeType)===Za.INTENT_BRIDGE:this?.quote?.bestRoute?.offlineType===za.YES}get computedIsFreeNetworkFee(){return this?.quote?.bestRoute?.bridge?.isFreeNetworkFee===Ja.FREE_NETWORK_FEE}get computedIsOkxProvider(){return!this?.quote?.bestRoute?.defiPlatformId||this?.quote?.bestRoute?.defiPlatformId===z}get computedBridgeIsOkxProvider(){let{defiPlatformId:t}=this?.quote?.bestRoute?.bridge||{};return!t||t===z}get computedPriceWarn(){let t=I.BigNumber(this?.quote?.bestRoute?.reducePercent),e=I.BigNumber(this?.quote?.bestRoute?.warnPercent);return{show:t&&t.isGreaterThan(e)}}get computedreducePercent(){return Sa(this?.quote?.bestRoute?.reducePercent)}};u();l();P();var md=a=>{let{quoteStore:t,swapStore:e}=B();!a&&t.bridgeQuoteSelectStatus!==0&&(t.setBridgeNoRouteTipStatus(e.confirmSwapVisible?2:1),t.setBridgeQuoteSelectStatus(0))},Ou=a=>Number(a.commonDexInfo?.code)===Mt.CROSS_CHAIN_INTERVAL,pd=a=>!a.pathSelectionRouterList?.length,hd=a=>Ou(a)||pd(a),fd=a=>{let{quoteStore:t}=B(),e=Ou(a)?{crossMaxAmount:a.commonDexInfo?.crossMaxAmount,crossMiniAmount:a.commonDexInfo?.crossMiniAmount}:null;t.setQuoteScope(e)},gd=a=>{let{quoteStore:t}=B(),e=t.bridgeSelectId===vt?a[0]:a?.find(o=>o.bridge.bridgeId===t.bridgeSelectId);return md(e),e||a[0]},Sd=({data:a})=>{let{commonDexInfo:t,singleChainSwapInfo:e,swapType:o,pathSelectionRouterList:r,intentCode:n,isSupportDappTrade:i,offlineType:c,traceData:d}=a||{},m=r?.map((y,w)=>({commonDexInfo:t,...y,isBest:w===0})),p={intentCode:n,offlineType:c,swapType:o,traceData:d},g={...e,...t,swapType:o,pathSelectionRouterList:m},T=m?.map(y=>({...t,...y,...p,isSupportDappTrade:i}));return{bestRoute:g,combineSelectionRouterList:T}},Td=a=>{let{quoteStore:t,smartRouterStore:e}=B();if(e.showXRouteModal!==fr.XROUTER)return;let o=a.find(r=>r?.bridge?.bridgeId===t.pickRouter?.bridge?.bridgeId);o&&t.setPickRouter(o)},Id=({bestRoute:a,bridgeInfo:t,isAutoError:e,originData:o,combineSelectionRouterList:r},{fromToStore:n,quoteStore:i})=>{let c=wt({},a,t);i.updateSlippageInfoFetched(c),i.setBridgeSelectId(c?.bridge?.bridgeId),i.setQuote({...i.quote,bestRoute:c,quoteNull:e,quoteError:null,isFetchQuoting:!1}),fd(o),e&&i.setBridgeFetchStatus(3),n.quoteUpdateFromTo(c),n.computedIsCrossChain&&(i.setPathSelectionRouterList(r||[]),Td(r||[]))},Pu=a=>{let{fromToStore:t,quoteStore:e,approveStore:o}=B(),{bestRoute:r,combineSelectionRouterList:n}=Sd({data:a}),i=gd(r.pathSelectionRouterList),c=hd(a);e.setQuoteNumber(e.quoteNumber+1),Id({bestRoute:r,bridgeInfo:i,isAutoError:c,originData:a,combineSelectionRouterList:n},{fromToStore:t,quoteStore:e}),Qo({isAutoError:c},{approveStore:o}),Ho({isAutoError:c},{quoteStore:e})};var ls=class extends Ue{constructor(e){super();this.isEnableBridgeQuoteSearch=!0;this.bridgeList=[];this.bridgeListPending=!0;this.bridgeQuoteSelectStatus=0;this.bridgeFetchStatus=0;this.bridgeNoRouteTipStatus=0;this.compareVisible=!1;this.dialogGroupVisibleStatus=1;this.bridgeSortType=0;this.setBridgeSelectId=e=>{this.bridgeSelectId=e};this.setBridgeQuoteSelectStatus=e=>{this.bridgeQuoteSelectStatus=e};this.setBridgeFetchStatus=e=>{this.bridgeFetchStatus=e};this.setBridgeNoRouteTipStatus=e=>{this.bridgeNoRouteTipStatus=e};this.setBridgeList=e=>{this.bridgeList=e};this.setBridgeListPending=e=>{this.bridgeListPending=e};this.setBridgeSortType=e=>{this.bridgeSortType=e};this.setCompareVisible=e=>{this.compareVisible=e};this.setDialogGroupVisibleStatus=e=>{this.dialogGroupVisibleStatus=e};this.getQuoteData=e=>{let o=tu();return this.bridgeFetchStatus===0&&this.setBridgeFetchStatus(1),_(io(()=>C.get(this.getQuoteStoreUrl(),{params:o,signal:e,isolate:!0}).then(r=>(this.setBridgeFetchStatus(2),this.handleUpdateQuote(r),this.setQuoteNumber(this.quoteNumber+1),this.quotePending=!1,r)).catch(r=>{throw A.stuff(r),r}),Ht.NUM,Ht.TIMER))};this.handleUpdateQuote=e=>{if(e){let{data:o}=e;Pu(o)}};this.updateBestRoute=e=>{let o={...this.quote.bestRoute,...e};this.setQuote({...this.quote,bestRoute:o}),this.rootStore.fromToStore?.quoteUpdateFromTo(o)};this.handleQuoteError=(e=null)=>{this.setQuote({...this.initQuote,quoteError:e}),this.handleReverseQuoteErrorAndNull(),this.setBridgeFetchStatus(4)};ut(this),Object.assign(this,e),this.rootStore=e}getQuoteStoreUrl(){return ki}};u();l();P();var _d="1",Ed="2",xu={minValue:.01,maxValue:.5},Nu={minValue:.03,maxValue:.5},qe=class{constructor(t){s(this,"slippageSetting",{autoIsSelected:!1,inputSlippage:""});s(this,"configSingle",xu);s(this,"configCross",Nu);s(this,"inputValue","");s(this,"inputCache","");s(this,"inputSlippageFocus",!1);s(this,"slippageNotice","");s(this,"hasSlippageError",!1);s(this,"hasSafeMoonWarning",!1);s(this,"isFrozen",!1);s(this,"frozenTooltip","");s(this,"clearNoticeAndError",()=>{this.slippageNotice="",this.hasSlippageError=!1});s(this,"setFrozenInfo",({computedSafeMoonNotSupport:t,isCrossBridgeOnly:e})=>{this.isFrozen=t||e,t?this.frozenTooltip=f("swaptrade_dialog_modal_current_notsupport"):e?this.frozenTooltip=f("swaptrade_dialog_modal_crosschain_notsupport"):this.frozenTooltip=""});s(this,"refreshInfo",()=>{let{inputSlippage:t}=this.slippageSetting;if(this.inputValue=t||"",this.computedSafeMoonTips||t!==""&&t!==void 0){let{computedSafeMoonTips:e,minSlippageShow:o,maxSlippageShow:r,computedAutoSlippage:n}=this,i=this.rootStore.fromToStore.computedIsSingleChain,{notice:c,isError:d,isWarning:m}=os({inputSlippageParams:this.computedSlippageValue,computedSafeMoonTips:e,minSlippageShow:o,maxSlippageShow:r,autoSlippageValue:n,isSingleChain:i});this.slippageNotice=c,this.hasSlippageError=d,this.hasSafeMoonWarning=m}});s(this,"onFocus",()=>{this.inputSlippageFocus=!0,this.hasSafeMoonWarning=!1,this.inputCache&&(this.onInput(null,this.inputCache),this.inputCache="")});s(this,"onInput",(t,e="")=>{let o=t||e;this.templeAutoSelected=!1;let{computedSafeMoonTips:r,minSlippageShow:n,maxSlippageShow:i,computedAutoSlippage:c}=this,d=this.rootStore.fromToStore.computedIsSingleChain,{notice:m,isError:p,isWarning:g}=os({inputSlippageParams:o,computedSafeMoonTips:r,minSlippageShow:n,maxSlippageShow:i,autoSlippageValue:c,isSingleChain:d});if(!me(tt(o))){let y=/^0{2,}/gm;o=o.replace(y,"0"),this.inputValue=o}let T=o||this.computedSafeMoonTips;this.slippageNotice=T?m:"",this.hasSlippageError=p,this.hasSafeMoonWarning=g});s(this,"onBlur",()=>{this.inputSlippageFocus=!1});s(this,"onSelectCustom",()=>{let t=this.inputValue,{computedSafeMoonTips:e,minSlippageShow:o,maxSlippageShow:r,computedAutoSlippage:n}=this,i=this.rootStore.fromToStore.computedIsSingleChain,{slippage:c,inputValue:d,notice:m,isError:p}=os({inputSlippageParams:t,computedSafeMoonTips:e,minSlippageShow:o,maxSlippageShow:r,autoSlippageValue:n,isSingleChain:i}),g=this.getSafeMoonStore();if(g.checkIsChanged&&g.checkIsChanged(t),e?this.inputValue=$t(c):this.inputValue&&(this.inputValue=$t(c),this.slippageNotice=m,this.hasSlippageError=p,this.hasSafeMoonWarning=!!e),(Number(t)===0||me(t))&&(this.slippageNotice=""),p){this.onSelectAuto(),this.inputSlippageFocus=!1;return}Ws({custom_or_auto:d?"custom":"auto"}),this.setSlippageSetting({autoIsSelected:!d,inputSlippage:d}),this.rootStore.quoteStore.fetchQuoteDebounce()});s(this,"onReset",()=>{let{inputSlippage:t}=this.slippageSetting;this.inputValue=t,this.clearNoticeAndError(),this.inputSlippageFocus=!1});this.rootStore=t,this.commonStore=t.commonStore,this.fromToStore=t.fromToStore,this.smartRouterStore=t.smartRouterStore,L(this,{},{autoBind:!0})}getSafeMoonStore(){return this.rootStore.safeMoonStore}getOrderSlippageInfo(){let{autoIsSelected:t}=this.slippageSetting,e=pn(this.rootStore);return t||this.isFrozen?{autoSlippageInfo:e}:{customSlippage:String(this.computedRealSlippageValue),autoSlippageInfo:e}}get minSlippage(){let t=this.rootStore.fromToStore.computedIsSingleChain,{computedSafeMoonToken:e}=this.getSafeMoonStore();if(e){let o=I.BigNumber.max(this.configCross.minValue,this.configSingle.minValue);return o.isNaN()?.011:o.toString()}return t?this.configSingle.minValue:this.configCross.minValue}get maxSlippage(){return this.rootStore.fromToStore.computedIsSingleChain?this.configSingle.maxValue:this.configCross.maxValue}get minSlippageShow(){return I.mul(this.minSlippage,100)}get maxSlippageShow(){return I.mul(this.maxSlippage,100)}get computedAutoSlippage(){let{computedHoneypot:t}=this.getSafeMoonStore();if(t){let e=S(this,"rootStore.quoteStore.quote.bestRoute.realSlippage",0);return I.mul(e,100)}return es(this.rootStore)}get computedSafeMoonNotSupport(){let{computedHoneypot:t,computedSlippageTips:e}=this.getSafeMoonStore();return!!(t||e?.overLimit||e?.equalLimit)}get computedSafeMoonSlippage(){return this.getSafeMoonStore().computedSlippage}get computedSafeMoonTips(){return this.getSafeMoonStore().computedSlippageTips}get computedSafeMoonTip(){return this.getSafeMoonStore().computedSlippageTips?.tip}get computedSafeMoonPairSlippage(){return this.getSafeMoonStore().computedPairSlippage}get computedSlippageValue(){return this.getSlippageValue()}get computedRealSlippageValue(){let t=this.getSlippageValue();return Number(I.div(t,100))||0}isValidVolatilityTip(){if(Number(this.computedSlippageValue)>this.computedAutoSlippage)return!1;let t=this.getSafeMoonStore(),e=this.smartRouterStore;return t.computedSafeMoonToken===null&&!e?.isCrossBridgeOnly}get computedVolatilityTips(){if(!this.isValidVolatilityTip())return null;let{computedAutoSlippage:t}=this,e=this.rootStore?.quoteStore?.quote?.bestRoute||{},{priceFluctuationMonitorTime:o,priceFluctuationThreshold:r,fromPriceFluctuation:n,toPriceFluctuation:i,rateFluctuationThreshold:c,slippageFluctuationhold:d,rateFluctuation:m}=e,{from:p,to:g}=this.fromToStore,T=g?.tokenSymbol||"",y=p?.tokenSymbol||"",w=I.mul(d,100),M=I.mul(r,100),O=I.mul(c,100),lt=Number(m),ot=Number(c);if(t>w){if(lt<ot)return null;let At=this.slippageSetting.autoIsSelected;return{tip:f("swaptrade_settings_alert_both_exchange_tips",{payToken:y,receiveToken:T,value:O,min:o}),tipEquation:f("swaptrade_settings_alert_both_exchange_tips",{payToken:W(y),receiveToken:W(T),value:O,min:o}),swapInterceptorType:At?Q.VOLATILITY_SLIPPAGE:null}}else if(t===w){let At=Math.abs(n),Wt=Math.abs(i),Lt=Number(r);if(At>Lt&&Wt>Lt)return{tip:f("swaptrade_placeorder_alert_both_volatility",{payToken:y,receiveToken:T,value:M,min:o}),tipEquation:f("swaptrade_placeorder_alert_both_volatility",{payToken:W(y),receiveToken:W(T),value:M,min:o})};if(At>Lt)return{tip:f("swaptrade_placeorder_alert_pay_receive_volatility",{token:y,value:M,min:o}),tipEquation:f("swaptrade_placeorder_alert_pay_receive_volatility",{token:W(y),value:M,min:o})};if(Wt>Lt)return{tip:f("swaptrade_placeorder_alert_pay_receive_volatility",{token:T,value:M,min:o}),tipEquation:f("swaptrade_placeorder_alert_pay_receive_volatility",{token:W(T),value:M,min:o})};if(lt>=ot)return{tip:f("swaptrade_settings_alert_both_exchange",{payToken:y,receiveToken:T,value:O,min:o}),tipEquation:f("swaptrade_settings_alert_both_exchange",{payToken:W(y),receiveToken:W(T),value:O,min:o})}}return null}getDefaultSetting(){let t={inputSlippage:"",autoIsSelected:!0},e=this.getSafeMoonStore();if(e.computedSafeMoonToken){let o=e.computedSlippage,r=$t(o);e.isChanged&&r&&(t.inputSlippage=r,t.autoIsSelected=!1)}return t}getSlippageType(){return this.slippageSetting.autoIsSelected||this.isFrozen?Ae.AUTO:Ae.CUSTOM}getSlippageValue(t=this.slippageSetting){let{autoIsSelected:e,inputSlippage:o}=t;return e||this.isFrozen?this.computedAutoSlippage:o||this.computedAutoSlippage}setSlippageSetting(t){let e={...t},o=this.getSafeMoonStore(),{computedSafeMoonToken:r}=o;if(!r){this.slippageSetting=e;return}let n=this.getSlippageValue(e);if(n===this.getSlippageValue(this.slippageSetting)||o.isAccessSlippage(n)||!o.getSafemoonIsChangedLocal()){e.inputSlippage="",e.autoIsSelected=!0;let i=$t(n);o.isChanged&&i&&(e.inputSlippage=i,e.autoIsSelected=!1),o.setSafeMoonPairSlippage(n),this.slippageSetting=e}}async initSlippageConfigs(){try{let{data:t}=await C.get(ji),e=t?.find(({configId:r})=>_d===r),o=t?.find(({configId:r})=>Ed===r);e&&(this.configSingle=e),o&&(this.configCross=o)}catch{this.configSingle=xu,this.configCross=Nu}}initSlippageSetting(){let t=this.getDefaultSetting(),e;t?e={...t}:e={autoIsSelected:!0,inputSlippage:""},this.setSlippageSetting(e)}initReactions(){Et(()=>{let{from:t,to:e}=this.fromToStore;return{chainId:t.chainId,toChainId:e.chainId,fromTokenAddress:t.tokenContractAddress,toTokenAddress:e.tokenContractAddress}},({fromTokenAddress:t,toTokenAddress:e})=>t&&e?(this.rootStore.quoteStore.slippageInfoFetched=!1,this.clearNoticeAndError(),this.initSlippageSetting()):!1,{equals:zt.shallow}),Et(()=>{let t=this.fromToStore.from.chainId,{computedSafeMoonSlippage:e}=this;return{fromId:t,computedSafeMoonSlippage:e}},this.clearNoticeAndError,{equals:zt.shallow}),Et(()=>{let{computedSafeMoonPairSlippage:t}=this;return{computedSafeMoonPairSlippage:t}},()=>{this.initSlippageSetting()},{equals:zt.shallow}),Et(()=>{let{isCrossBridgeOnly:t}=this.smartRouterStore,{computedSafeMoonNotSupport:e}=this;return{computedSafeMoonNotSupport:e,isCrossBridgeOnly:t}},this.setFrozenInfo,{equals:zt.shallow}),Et(()=>{let{slippageSetting:t,isFrozen:e,computedSafeMoonTip:o}=this;return{slippageSetting:t,isFrozen:e,computedSafeMoonTip:o}},this.refreshInfo,{equals:zt.shallow})}onSelectAuto(t=!1){Ws({custom_or_auto:"auto"}),!this.hasSlippageError&&!this.hasSafeMoonWarning&&this.inputValue?this.inputCache=this.inputValue:this.inputCache="";let e={autoIsSelected:!0,inputSlippage:""};if(this.inputValue="",this.slippageNotice="",this.hasSlippageError=!1,this.hasSafeMoonWarning=!1,!t){let o=this.getSafeMoonStore();o.computedSafeMoonToken&&o.setSafeMoonIsChanged(!1),this.setSlippageSetting(e),this.rootStore.quoteStore.fetchQuoteDebounce()}}get computedMinimumReceived(){let{quote:t,computedIsOfflineType:e}=this.rootStore.quoteStore,{receiveAmount:o,minimumReceived:r}=t?.bestRoute||{},n=this.fromToStore.to?.tokenSymbol;if(this.hasSlippageError||!Kt(o))return"--";let i=this.inputValue?I.div(this.inputValue,100):this.computedRealSlippageValue,c=e?r:I.mul(o,1-(Kt(i)?i:0));return`${Z(c,{needBillionMillionUnit:!1})} ${n}`}get computedMinimumReceivedIsOrange(){let{quote:t}=this.rootStore.quoteStore,e=this.computedMinimumReceived,o=t?.bestRoute?.receiveAmount,r=I.BigNumber(o);return!r.isZero()&&!r.isNaN()&&I.div(I.sub(r,e),r)>=.1}};u();l();P();F();var yn=class{constructor(t){s(this,"checkCrossChainParams",()=>{let{quoteStore:t,receiveAddressStore:e}=this.rootStore,{quote:o}=t,r=this.checkCommonParams(),{receiveAddrObj:n}=e,i=S(o.bestRoute,"quoteNetWorkFeeOfMoney"),c=o?.bestRoute?.bridge?.bridgeId,d=n?.specifiedAddress;return{...r,fromSwapFeeUsd:i,bridgeId:c,receiveWalletAddress:d}});s(this,"checkCommonParams",()=>{let{accountStore:t,fromToStore:e,quoteStore:o}=this.rootStore,{from:r,to:n}=e;return{fromChainId:r.chainId,fromTokenAddress:r.tokenContractAddress,amount:o?.computedQuoteAmount,toChainId:n.chainId,toTokenAddress:n.tokenContractAddress,userWalletAddress:t.address,accountId:t.computedAccountId}});s(this,"repeatOrder",null);s(this,"checkRepeatOrder",async()=>{this.repeatOrder=null;let{fromChainId:t,...e}=this.checkCommonParams(),{quoteStore:{quote:o}}=this.rootStore,r=S(o.bestRoute,"fromSwapFeeUsd"),n={...e,chainId:t,fromSwapFeeUsd:r},[i,c]=await _(C.get(Oi,{params:n}));!i&&[ge.COMMON_REPEAT,ge.BTC_REPEAT,ge.FACET_REPEAT].includes(c?.data.repeatFlag)&&ht(()=>{let{orderId:d,enoughFlag:m}=c?.data??{};this.repeatOrder={enoughFlag:m,repeatFlag:c?.data.repeatFlag,id:d}})});s(this,"checkSwapMoreInfo",null);s(this,"checkCrossChainSwap",async()=>{this.checkSwapMoreInfo=null;let t=this.checkCrossChainParams(),[e,o]=await _(C.post(Pi,{...t}));e||ht(()=>{this.checkSwapMoreInfo=o?.data})});L(this),this.rootStore=t}},ds=yn;u();l();F();var Ve=class{constructor(t){s(this,"swapOnDappBtnLoading",!1);s(this,"setSwapOnDappBtnLoading",t=>{this.swapOnDappBtnLoading=t});s(this,"refreshing",!1);s(this,"setRefreshing",t=>{this.refreshing=t});s(this,"dappListContainerVisible",!1);s(this,"setDappListContainerVisible",t=>{this.dappListContainerVisible=t});s(this,"fetchDappListError",!1);s(this,"setFetchDappListError",t=>{this.fetchDappListError=t});s(this,"availableNoticeVisible",!1);s(this,"setAvailableNoticeVisible",t=>{this.availableNoticeVisible=t});s(this,"dappList",[]);s(this,"setDappList",t=>{this.dappList=t});s(this,"getFetchParam",()=>{let{from:t,to:e,computedIsSingleChain:o}=this.fromToStore||{},r={},n="";return o?(n=ra,r={chainId:t?.chainId,tokenAddress:e?.tokenContractAddress}):(n=sa,r={fromChainId:t?.chainId,fromTokenAddress:t?.tokenContractAddress,toChainId:e?.chainId,toTokenAddress:e?.tokenContractAddress}),{url:n,params:r}});s(this,"fetchDappList",async t=>{t?(this.setFetchDappListError(!1),this.setRefreshing(!0)):this.setSwapOnDappBtnLoading(!0);let{url:e,params:o}=this.getFetchParam(),[r,n]=await _(C.get(e,{params:o}));if(this.setRefreshing(!1),this.setSwapOnDappBtnLoading(!1),r){if(Number(r.code)===40008){this.setAvailableNoticeVisible(!0);return}this.setFetchDappListError(!0),this.setDappListContainerVisible(!0);return}this.setDappList(n.data),this.setDappListContainerVisible(!0)});s(this,"getSupportDetail",(t={},e=!1)=>{let o=this.chainIsSupportMarket(t),r=this.chainIsSupportDappTrade(t),n=!!this.quoteStore?.computedSupportDappTradeByQuote,i=!o&&r,c=o&&r,d=o&&!r;return{chainSupportMarket:o,chainSupportDappTrade:r,quoteSupportDappTrade:n,balance:c||d,kline:c||d,klineJumpMarket:c||d,costValue:e&&c||d,valueDifference:d,liquidity:d,disableInput:i||c,showMax:d,showAddFund:d}});s(this,"mergeCurrencyInputProps",(t,e)=>({balanceStatus:e.balance?t.balanceStatus:nt.BALANCE_NOT_SHOW,costValue:e.costValue?t.costValue:"",valueDifference:e.valueDifference?t.valueDifference:{},disableInput:e.disableInput,showMax:e.showMax?t.showMax:!1,showMaxIcon:e.showMax?t.showMaxIcon:!1,showAddFund:e.showAddFund?t.showAddFund:!1}));s(this,"getCurrentFromToChainConfig",()=>{let t=this.fromToStore.from.chainId,e=this.fromToStore.to.chainId,o=this.commonStore.getChainByID(t),r=this.commonStore.getChainByID(e);return[o,r]});s(this,"chainIsSupportMarket",t=>Number(t?.isSupportMarket)===1);s(this,"chainIsSupportDappTrade",t=>Number(t?.isSupportDappTrade)===1);s(this,"bridgeSupportDappTrade",t=>Number(t?.supportLinkDapp)===1);s(this,"getSupportDappTradeByToken",()=>{let t=this.quoteStore?.computedSupportDappTradeByQuote,e=this.liquidityChooseStore?.computedIsSelectedAllDex;return this.fromToStore.computedIsSingleChain&&t&&e});s(this,"checkShouldJumpToDapp",()=>this.fromToStore.computedFormToTokenIsLeverageToken?!1:this.computedSupportDappTradeByChain?!0:this.getSupportDappTradeByToken());this.rootStore=t,this.commonStore=t.commonStore,this.fromToStore=t.fromToStore,this.quoteStore=t.quoteStore,this.liquidityChooseStore=t.liquidityChooseStore,L(this,{},{autoBind:!0})}get computedFromToSupportMarketAndDappTrade(){let[t,e]=this.getCurrentFromToChainConfig();return{from:{...this.getSupportDetail(t,!0)},to:{...this.getSupportDetail(e)}}}get computedFromToSupportMarket(){let[t,e]=this.getCurrentFromToChainConfig();return this.chainIsSupportMarket(t)&&this.chainIsSupportMarket(e)}get computedSupportDappTradeByChain(){let t=this.fromToStore.from.chainId,e=this.fromToStore.to.chainId,o=this.commonStore.getChainByID(t);if(this.fromToStore.computedIsSingleChain)return this.chainIsSupportDappTrade(o);let r=o?.bridgeSupportChainInfoList,n=Array.isArray(r)&&r.find(i=>Number(i.chainId)===Number(e));return this.bridgeSupportDappTrade(n)}};var lo=class extends _e{constructor(){super();s(this,"reset",()=>{this.receiveAddressStore=new Zr(this),this.outerStore=new us(this),this.fromToStore=new xe(this),this.approveStore=new Ee(this),this.quoteStore=new ls(this),this.tokenModalStore=new ss(this),this.safeMoonStore=new Be(this),this.walletContractStore=new zr(this),this.sendTransactionStore=new co(this),this.intentSwapStore=new Jr(this),this.swapCheckStore=new ds(this),this.swapStore=new De(this),this.swapBtnStore=new Ne(this),this.mevStore=new cs(this),this.recentTransactionStore=new Or(this),this.facetStore=new ns(this),this.liquidityChooseStore=new Fe(this),this.swapDappStore=new Ve(this),this.smartRouterStore=new br(this),this.slippageStore=new qe(this),this.oneMoreOrderStore=new is(this),this.gasDropStore=new as});this.reset()}},Ko=lo;s(Ko,"instance",null),s(Ko,"getInstance",()=>(lo.instance||(lo.instance=new lo),lo.instance));var Du=Ko;u();l();u();l();var ms=class extends Me{constructor(t){super(t),ut(this)}getSearchParams(t){return this.singleSearchParams(t)}};u();l();P();F();u();l();P();var Rd=a=>{let{quoteStore:t,swapStore:e}=B();!a&&t.aggregateSelectStatus!==0&&(t.setAggregateNoRouteTipStatus(e.confirmSwapVisible?2:1),t.setAggregateSelectStatus(0))},bd=a=>{let{quoteStore:t}=B(),e=t.aggregateSelectId===vt?a[0]:a.find(r=>r.defiPlatformId===t.aggregateSelectId),o=S(a.find(r=>r.defiPlatformId===z),"dexRouterList",[]);return Rd(e),wt({},e||a[0],{dexRouterList:o})},vd=({data:a,isCompareResult:t})=>{let{commonDexInfo:e,singleChainSwapInfo:o,swapType:r,isSupportDappTrade:n,defiPlatformInfoList:i,traceData:c}=a,d=i.map((p,g)=>({...p,isBest:g===0}));return{bestRoute:{...o,...e,isSupportDappTrade:t?n:"0",swapType:r,defiPlatformInfoList:d,traceData:c}}},Ld=({bestRoute:a,aggregateInfo:t,isAutoError:e},{fromToStore:o,quoteStore:r})=>{let n=wt({},a,t);r.updateSlippageInfoFetched(n),r.setAggregateSelectId(n.defiPlatformId),r.setQuote({...r.quote,bestRoute:n,quoteNull:e,quoteError:null,isFetchQuoting:!1}),e&&r.setAggregateFetchStatus(4),o.quoteUpdateFromTo(n)},wd=a=>{let{solanaPriorityFeeStore:t}=B();t&&a?.jitoData&&t.setJitoData(a?.jitoData)},Mu=a=>{let{fromToStore:t,quoteStore:e,approveStore:o}=B(),r=e.aggregateFetchStatus===3,{bestRoute:n}=vd({data:a,isCompareResult:r}),i=bd(n.defiPlatformInfoList),c=r&&n.defiPlatformInfoList.length===0;e.setQuoteNumber(e.quoteNumber+1),Ld({bestRoute:n,aggregateInfo:i,isAutoError:c},{fromToStore:t,quoteStore:e}),wd(a),Qo({isAutoError:c},{approveStore:o}),Ho({isAutoError:c},{quoteStore:e})};var ps=class extends Ue{constructor(e){super();this.enableQuoteAggregates=!0;this.setAggregateSelectId=e=>{this.aggregateSelectId=e};this.aggregateSelectStatus=0;this.setAggregateSelectStatus=e=>{this.aggregateSelectStatus=e};this.aggregateFetchStatus=0;this.setAggregateFetchStatus=e=>{this.aggregateFetchStatus=e};this.fetchOKXQuote=({params:e,signal:o})=>{this.aggregateFetchStatus!==3&&C.get(this.outerStore.aggregatorQuoteUrl(),{params:wt({},e,{defiPlatformIds:z}),signal:o}).then(r=>{this.aggregateFetchStatus===1&&(this.setAggregateFetchStatus(2),this.handleUpdateQuote(r),this.setQuoteNumber(this.quoteNumber+1),this.quotePending=!1)}).catch(r=>{A.stuff(r)})};this.getQuoteData=e=>{let o=Nt();return this.fetchOKXQuote({params:o,signal:e}),_(io(()=>this.fetchAggregatesQuote({params:o,signal:e}),Ht.NUM,Ht.TIMER))};this.handleUpdateQuote=e=>{if(e){let{data:o}=e;Mu(o)}};this.updateBestRoute=e=>{let o={...this.quote.bestRoute,...e};this.setQuote({...this.quote,bestRoute:o}),this.rootStore.fromToStore?.quoteUpdateFromTo(o)};this.aggregateNoRouteTipStatus=0;this.setAggregateNoRouteTipStatus=e=>{this.aggregateNoRouteTipStatus=e};this.handleQuoteError=(e=null)=>{this.setQuote({...this.initQuote,quoteError:e}),this.handleReverseQuoteErrorAndNull(),this.setAggregateFetchStatus(5)};this.aggregatorList=[];this.setAggregatorList=e=>{this.aggregatorList=e};this.aggregatorListPending=!0;this.setAggregatorListPending=e=>{this.aggregatorListPending=e};this.fetchAggregatorList=()=>(this.setAggregatorListPending(!0),C.get(Ei).then(e=>{this.setAggregatorList(e.data)}).catch(()=>{this.setAggregatorList([])}).finally(()=>{this.setAggregatorListPending(!1)}));this.compareVisible=!1;this.setCompareVisible=e=>{this.compareVisible=e};this.dialogGroupVisibleStatus=1;this.setDialogGroupVisibleStatus=e=>{this.dialogGroupVisibleStatus=e};ut(this),Object.assign(this,e),this.rootStore=e}fetchAggregatesQuote({params:e,signal:o}){return C.get(this.outerStore.aggregatorQuoteUrl(),{params:e,signal:o,isolate:!0}).then(r=>(this.aggregateFetchStatus===2&&this.setAggregateSelectId(vt),this.setAggregateFetchStatus(3),r))}};u();l();u();l();var Fu=a=>{if(!a)return[];let{solPrice:t,solTokenSymbol:e,solDecimals:o}=a;return Xa.map(r=>({type:r,fee:a[r],usd:a[`${r}Usd`],solPrice:t,solTokenSymbol:e,solDecimals:o}))};var kn=class{constructor(t){s(this,"visible",!1);s(this,"setVisible",t=>{this.visible=t});s(this,"feeType",Qs.MARKET);s(this,"setFeeType",t=>{this.feeType=t});s(this,"customFee",null);s(this,"setCustomFee",t=>{this.customFee=t});s(this,"jitoData",null);s(this,"setJitoData",t=>{this.jitoData=t});this.rootStore=t,ut(this)}get computedPriorityFeeList(){return Fu(this.jitoData)}get computedPriorityFeeAmount(){return this.jitoData?this.feeType===Qs.CUSTOM?this.customFee:this.computedPriorityFeeList.find(e=>e.type===this.feeType)?.fee:null}get computedPriorityFeeOfUsd(){if(!this.jitoData)return null;let{solPrice:t}=this.jitoData;return I.mul(this.computedPriorityFeeAmount,t,{returnString:!0})}},Bu=kn;var mo=class extends _e{constructor(){super();s(this,"reset",()=>{this.receiveAddressStore=new Zr(this),this.outerStore=new us(this),this.fromToStore=new xe(this),this.approveStore=new Ee(this),this.quoteStore=new ps(this),this.tokenModalStore=new ms(this),this.safeMoonStore=new Be(this),this.walletContractStore=new zr(this),this.sendTransactionStore=new co(this),this.intentSwapStore=new Jr(this),this.swapCheckStore=new ds(this),this.swapStore=new De(this),this.swapBtnStore=new Ne(this),this.solanaPriorityFeeStore=new Bu(this),this.mevStore=new cs(this),this.recentTransactionStore=new Or(this),this.facetStore=new ns(this),this.liquidityChooseStore=new Fe(this),this.swapDappStore=new Ve(this),this.smartRouterStore=new br(this),this.slippageStore=new qe(this),this.oneMoreOrderStore=new is(this)});this.reset()}},Yo=mo;s(Yo,"instance",null),s(Yo,"getInstance",()=>(mo.instance||(mo.instance=new mo),mo.instance));var Uu=Yo;u();l();var le=R(x());u();l();var Dt=R(x());u();l();var qu=R(x());F();var Od=(a,t)=>(0,qu.useCallback)(Wn(a,t),[a]),Vu=Od;u();l();P();F();u();l();async function Iw(a){return await C.post("/priapi/v1/dx/trade/multi/meme/callData",a)}async function Wu(a){return await C.get("/priapi/v1/dx/trade/multi/tokens/meme/search",{params:a})}async function Gu(a){return await C.post("/priapi/v1/dx/trade/multi/order/meme/broadcast",a)}async function Qu(a){return await C.get("/priapi/v1/dx/trade/multi/tokens/meme/supportTokenInfo",{params:a})}var vw=async({inputContent:a,accountId:t,userUniqueId:e,walletId:o})=>{let[r,n]=await _(Wu({inputContent:a,accountId:t,userUniqueId:e,walletId:o,includeMarketInfo:!0}));return r?null:_s(S(n,"data.tokenInfo",{}),S(n,"data.marketTokenInfo",{}))},Lw=async({chainId:a,accountId:t,userUniqueId:e,walletId:o})=>{let[r,n]=await _(Qu({chainId:a,accountId:t,userUniqueId:e,walletId:o,includeMarketInfo:!0}));return r?null:_s(S(n,"data",{}),S(n,"data.marketTokenInfo",{}))},Hu=async(a,t)=>{let[e,o]=await _(C.get(Tr,{params:a,signal:t}));return e?null:S(o,"data",{})};var ju=()=>{let{memeBuyStore:a,memeSellStore:t}=G(),{isSellRoute:e}=qt(),o=(0,Dt.useCallback)(c=>{let d=c.coinAmountOriginalDec||c.amountNum,m={...c,amountNum:d};e?t.onSocketUpdateFromTokenBalance(m):a.onSocketUpdateFromTokenBalance(m)},[e,t,a]),r=t.fromToken?.tokenContractAddress,n=a.fromToken?.tokenContractAddress,i=(0,Dt.useMemo)(()=>e?r:n,[r,n,e]);return{updateTokenBalance:o,currentTokenAddress:i}},Pd=()=>{let a=(0,Dt.useRef)(null),t=(0,Dt.useRef)(null),{updateTokenBalance:e,currentTokenAddress:o}=ju(),r=cc(),{chainId:n,accountId:i,userUniqueId:c,walletId:d,userWalletAddress:m,businessType:p}=r,g=(0,Dt.useCallback)(()=>{t.current&&clearInterval(t.current),typeof a.current?.abort=="function"&&a.current.abort()},[]);return{pollingTokenBalance:(0,Dt.useCallback)(()=>{g(),t.current=setInterval(async()=>{if(o&&n&&i&&c&&d&&m){a.current=$();let y=await Hu({tokenAddress:o,chainId:n,accountId:i,userUniqueId:c,walletId:d,userWalletAddress:m,businessType:p},a.current.signal);y&&e(y)}},10*1e3)},[n,o,i,c,d,m,p,e,g]),cancelPolling:g}},xd=()=>{let{memeAccountStore:a,memePositionStore:t,memeConfigStore:e,memeCommonStore:o}=G(),{computedAccountId:r,computedAccountWalletAddresses:n}=a,{userUniqueId:i}=o,{config:c}=e,{nativeTokenConfig:d}=c||{},{chainId:m}=d||{},{fetchPositionList:p}=t,g=Vu(p,300),{updateTokenBalance:T}=ju(),{pollingTokenBalance:y,cancelPolling:w}=Pd();(0,Dt.useEffect)(()=>(n&&(at.addListen("error",()=>{y()}),at.addListen("connect",()=>{w()}),at.addListen(bo.WALLET_ASSET,M=>{M&&(g({chainId:m,accountId:r,userUniqueId:i}),T(M))}),at.init(n)),()=>{at.removeAll(),at.wsInstance&&n&&at.logout(n)}),[m,r,i,n,g,T,y,w])},Ku=xd;u();l();u();l();var Xu=R(x());u();l();function hs(){let{memeBuyStore:a,memeSellStore:t}=G(),{isSellRoute:e}=qt();return(e?t.fromToken:a.toToken)||{}}u();l();var Yu=(a,t)=>{let e={userUniqueId:a,tokenDetailList:[{chainId:t.chainId,contractAddress:t.tokenContractAddress,tokenSymbol:t.tokenSymbol,precision:t.decimals}]};return C.post(gr,e)},$u=a=>(Array.isArray(a)?a:[a]).map(e=>({channel:Ka,chainId:e?.chainId,tokenAddress:e?.tokenContractAddress}));var Nd=()=>{let a=hs(),{memeCommonStore:t}=G();(0,Xu.useEffect)(()=>{!a.tokenContractAddress||!a.chainId||!t.userUniqueId||Yu(t.userUniqueId,a)},[t.userUniqueId,a.tokenContractAddress,a.chainId])},zu=Nd;u();l();var _n=R(x());u();l();var tl=R(x());u();l();F();var Ju=async({tokenContractAddress:a,accountId:t,chainId:e})=>{let[o,r]=await _(C.get(ia,{params:{tokenContractAddress:a,accountId:t,chainId:e}}));return!o&&r?r.data:{error:o}};u();l();var Zu=R(x());var Dd=()=>{let{memeBuyStore:a,memeSellStore:t}=G(),{isSellRoute:e}=qt();return(0,Zu.useCallback)((o,r)=>{if(Ut(o,r)){let n={...o,chainId:Number(o.chainId)};e?t.onSocketUpdateFromToken(n):a.onSocketUpdateToToken(n)}},[e,t,a])},fs=Dd;var Md=()=>{let{memeAccountStore:a}=G(),{computedAccountId:t}=a,e=fs();return(0,tl.useCallback)(o=>{Ju({tokenContractAddress:o.tokenContractAddress,chainId:o.chainId,accountId:t}).then(r=>{if(r?.error)return;let n={...o,price:r.price,marketCap:r.marketCap};e(n,o)}).catch(()=>{})},[e,t])},el=Md;var Fd=()=>{let a=hs(),{memeCommonStore:t}=G(),{marketWsIsConnected:e}=t,o=fs(),r=el();(0,_n.useEffect)(()=>{Ya.connect(()=>{t.setMarketWsIsConnected(!0)})},[]),(0,_n.useEffect)(()=>{if(!a.tokenContractAddress||!a.chainId)return()=>{};if(!e)return()=>{};let n=$u(a),i=$a({subscribeParams:n,onListenData:c=>{o(c[0],a)},onListenError:()=>{r(a)},onListenReconnected:()=>{r(a)}});return()=>{i()}},[a.tokenContractAddress,a.chainId,e,o])},ol=Fd;var Bd=()=>{zu(),ol()},rl=Bd;u();l();var We=R(x()),sl=R(Ot());var Ud=({currency:a,currentWallet:t,walletInfo:e,keyringIdentityTypeEnum:o,addressBookList:r,walletList:n,t:i,dispatch:c,onBack:d})=>{let{memeCommonStore:m,memeAccountStore:p,reset:g}=G(),T=(0,sl.useHistory)();(0,We.useEffect)(()=>{b.setRuntimeContext({history:T,toLocale:i,dispatch:c,walletInfo:e,onBack:d})},[i,T,c,e,d]),(0,We.useEffect)(()=>{t&&p.setWalletConfig(t)},[t]),(0,We.useEffect)(()=>(m.getUserUnit(a),()=>{g()}),[]),(0,We.useEffect)(()=>{p.setAddressBookList(r)},[r]),(0,We.useEffect)(()=>{p.setWalletList(n)},[n]),(0,We.useEffect)(()=>{p.setKeyringIdentityTypeEnum(o)},[o])},nl=Ud;u();l();var Ct=R(x()),po=R(Ot());F();u();l();var ue=R(x()),Ss=R(Ot()),ll=R(Ba());u();l();var il=R(x());var $o=class extends il.PureComponent{constructor(t){super(t),this.state={hasError:!1,error:void 0,errorInfo:{}}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t,e){this.setState({error:t,errorInfo:e}),A.error(v.ERROR_BOUNDARY,{error:t,errorInfo:e}),this.props.onError&&this.props.onError(t,e)}render(){let{error:t,errorInfo:e,hasError:o}=this.state;return o?this.props.fallbackComponent({error:t,errorInfo:e}):this.props.children}};u();l();var En=R(x());F();var qd=()=>En.default.createElement("div",{className:"mt-50"},En.default.createElement($n,{pastDelay:!1,error:!0,delayTime:1e4,alt:"dexGenericError",retry:()=>{Hn(Qn().pathname,"_self")}})),al=qd;u();l();var gs=R(x());u();l();function cl(){let{memeBuyStore:a,memeSellStore:t}=G(),{isSellRoute:e}=qt(),o=(e?t.fromToken:a.fromToken)||{},r=(e?t.toToken:a.toToken)||{};return{fromToken:o,toToken:r}}var Vd=()=>{let{memeCommonStore:a}=G(),{fromToken:t}=cl(),{isSellRoute:e}=qt(),{chainId:o,isNativeToken:r,tokenContractAddress:n}=t,{visibleAddFunds:i,setAddFundsVisible:c}=a,d=Ar(),m=(0,gs.useMemo)(()=>d?!0:!!e,[d,e]);return gs.default.createElement(qr,{visible:i,params:{chainId:o,tokenContractAddress:r?"":n,receiveOnly:m},onBack:()=>{c(!1)}})},ul=rt(Vd);var Wd=[Ie,Je],Gd=({children:a,onBack:t})=>{let{showNavigator:e,title:o,closeable:r}=Vr(!1),n=(0,Ss.useLocation)(),i=(0,Ss.useHistory)(),{isTelegramMiniApp:c}=b.global,{Navigator:d}=b.components,{memeCommonStore:m}=G(),{setAddFundsVisible:p}=m;(0,ue.useEffect)(()=>{p(!1)},[]),tc();let g=()=>{t?t(i.goBack,Wd.includes(n.pathname)):i.goBack()};return ue.default.createElement($o,{fallbackComponent:al},ue.default.createElement("div",{className:(0,ll.default)("universe-swap background-base-primary",Vt.wrapper)},e?ue.default.createElement(d,{title:o,onBack:g,closeable:r}):null,ue.default.createElement("div",{id:"meme-swap-container",className:c?Vt.memeTelegramContainer:Vt.extensionContainer},a)),ue.default.createElement(ul,null))},dl=rt(Gd);var ml=(0,Ct.lazy)(()=>import("./Buy-DKWWJMD4.js")),Qd=(0,Ct.lazy)(()=>import("./Sell-K7SRUQJR.js")),Hd=(0,Ct.lazy)(()=>import("./Configure-7LRSBODX.js")),jd=(0,Ct.lazy)(()=>import("./TokenList-FFWQ54XO.js")),Kd=(0,Ct.lazy)(()=>import("./HighRisk-KRRTTB2S.js")),Yd=({onBack:a})=>Ct.default.createElement(dl,{onBack:a},Ct.default.createElement(Ct.Suspense,null,Ct.default.createElement(po.Switch,null,[{path:Ie,component:ml,exact:!0},{path:Je,component:Qd,exact:!0},{path:pr,component:Hd,exact:!0},{path:mr,component:jd,exact:!0},{path:hr,component:Kd,exact:!0}].map(e=>Ct.default.createElement(po.Route,{key:e.path,path:e.path,component:e.component,exact:e.exact})),Ct.default.createElement(po.Redirect,{from:Ie,to:{pathname:ml,search:new er().getAll()},strict:!0,exact:!0})))),pl=Yd;var $d=({currency:a,currentWallet:t,keyringIdentityTypeEnum:e,addressBookList:o,walletList:r,walletInfo:n,onBack:i,t:c,dispatch:d})=>{nl({currency:a,currentWallet:t,walletInfo:n,keyringIdentityTypeEnum:e,addressBookList:o,walletList:r,t:c,dispatch:d,onBack:i}),Ku(),rl();let{memeAccountStore:{address:m,setFromChainId:p},memeConfigStore:{fetchConfig:g,config:T}}=G();(0,le.useEffect)(()=>{A.setTags({address:m})},[m]),(0,le.useEffect)(()=>{g()},[]),(0,le.useEffect)(()=>{T&&p(T?.nativeTokenConfig?.chainId)},[T]);let{initialized:y}=Br();return y?le.default.createElement(pl,{onBack:i}):null},hl=(0,le.memo)(rt($d));u();l();u();l();P();F();var Ts=class{constructor(){this.loading=!0;this.setLoading=t=>{this.loading=t};this.fromToken=null;this.setFromToken=t=>{this.fromToken=t};this.toToken=null;this.setToToken=t=>{this.toToken=t};this.onSocketUpdateToToken=t=>{Ut(t,this.toToken)&&this.setToToken({...this.toToken,...t})};this.onSocketUpdateFromTokenBalance=t=>{Ut(t,this.fromToken)&&this.setFromToken({...this.fromToken,amountNum:t.amountNum})};this.selectBuyValue="0";this.setSelectBuyValue=t=>{this.selectBuyValue=t};this.inputBuyValue="";this.setInputBuyValue=t=>{this.inputBuyValue=t};L(this)}get computedBuyNumber(){try{return this.selectBuyValue===wo?this.inputBuyValue?parseFloat(this.inputBuyValue):"0":this.selectBuyValue||"0"}catch(t){return A.stuff(t),"0"}}get computedBuyTokenSymbol(){return S(this,"toToken.tokenSymbol")}get computedBuyNumberIsValid(){return new Gt.BigNumber(this.computedBuyNumber).gt(0)}};u();l();F();var Is=class{constructor(){this.config=null;this.setConfig=t=>{this.config=t};this.initLoading=!0;this.setInitLoading=t=>{this.initLoading=t};this.fetchConfig=async()=>{let[t,e]=await _(C.get(aa));t||e&&e.data&&(this.setConfig(e.data),this.setInitLoading(!1))};L(this)}};u();l();F();var Cs=class{constructor(){this.initState=!1;this.setInitState=t=>{this.initState=t};this.positionList=[];this.setPositionList=t=>{this.positionList=t};this.fetchPositionLoading=!0;this.setFetchPositionLoading=t=>{this.fetchPositionLoading=t};this.cancelFetchRef=null;this.fetchPositionList=async({accountId:t,userUniqueId:e,chainId:o})=>{if(!t||!e||!o)return;this.cancelFetchRef&&this.cancelFetchRef.abort(),this.setFetchPositionLoading(!0),this.cancelFetchRef=$();let[r,n]=await _(C.get(ca,{params:{accountId:t,userUniqueId:e,chainId:o},signal:this.cancelFetchRef?.signal}));r&&A.stuff(r),n&&n.data&&this.setPositionList(n?.data),this.setFetchPositionLoading(!1),this.setInitState(!0)};L(this)}isCancel(t){return Tt(t)}};u();l();P();F();var Rn=class{constructor(){this.quoteLoading=!1;this.quoteData=Rn.INIT_QUOTE_DATA;this.isAutoQuote=!0;this.cancelRef=null;this.cleanMemeQuoteTimer=()=>{this.cancelRef&&this.cancelRef.abort(),this.timerRef&&clearTimeout(this.timerRef),this.setQuoteLoading(!0)};this.initLoading=!0;this.slippage={value:"0.1",type:"low",config:{low:"0.1",medium:"0.15",high:"0.5"},min:"0.05",max:"0.5"};this.setSlippage=t=>{this.slippage=t};this.priorityFee={value:"",type:"market",config:{market:"",fast:"",turbo:""},max:"5"};this.setPriorityFee=t=>{this.priorityFee=t};this.isQuoteImmediate=t=>!!t.chainId&&!!t.fromTokenAddress&&!!t.toTokenAddress&&Number(t.amount)>0;this.timerRef=null;this.startingPoll=async t=>{if(this.timerRef&&clearTimeout(this.timerRef),!this.isQuoteImmediate(t)){this.setIsInitLoading(!1);return}await this.fetchQuoteData(t),this.timerRef=setTimeout(async()=>{await this.startingPoll({...t,isAuto:!0})},5e3)};this.fetchMemeQuote=Qe(this.startingPoll,lr);L(this,{},{autoBind:!0})}setQuoteLoading(t){this.quoteLoading=t}setQuoteData(t){this.quoteData=t}setIsAutoQuote(t){this.isAutoQuote=t}setIsInitLoading(t){this.initLoading=t}async fetchQuoteData({isAuto:t,...e}){this.setQuoteLoading(!0),this.setIsAutoQuote(t),this.cleanMemeQuoteTimer(),this.cancelRef=$();let[o,r]=await _(C.get(da,{params:e,signal:this.cancelRef.signal}));if(!Tt(o)&&o){let n={...r||{},...o};this.setQuoteData(n)}else this.setQuoteData(r||{});this.setIsInitLoading(!1),this.setQuoteLoading(!1),this.setIsAutoQuote(!1)}get computedPriorityFeeInfo(){return S(this.quoteData,"data.memeModeCommonDexInfo.priorityFeeInfo",{})}get computedSlippage(){return S(this.quoteData,"data.memeModeCommonDexInfo.slippage","--")}get computedFromTokenValue(){return S(this.quoteData,"data.memeModeCommonDexInfo.fromTokenPrice","0")}get computedToTokenAmount(){return S(this.quoteData,"data.memeModeSingleChainSwapInfo.receiveAmount","0")}get computedToTokenValue(){return S(this.quoteData,"data.memeModeSingleChainSwapInfo.toTokenPrice","0")}get computedQuoteErrorMsg(){return S(this.quoteData,"error_message","")}get computedQuoteErrorCode(){return S(this.quoteData,"error_code")}get computedQuoteIsError(){return this.computedQuoteErrorCode&&this.computedQuoteErrorCode!=="0"}get computedQuoteNetworkError(){return!this.computedQuoteErrorCode&&this.quoteData.err}get computedQuoteLiquidityError(){return this.computedQuoteErrorCode&&!S(this.quoteData,"data.memeModeSingleChainSwapInfo")}get computedQuoteIsHoneypot(){return this.computedQuoteErrorCode&&(S(this.quoteData,"data.memeModeCommonDexInfo.toToken.isHoneypot")||S(this.quoteData,"data.memeModeCommonDexInfo.fromToken.isHoneypot"))}get computedGetRouterList(){return S(this.quoteData,"data.memeModeSingleChainSwapInfo.dexRouterList")}get computedGetEstimateGasFee(){return S(this.quoteData,"data.memeModeSingleChainSwapInfo.estimateGasFee")}get computedGetQuoteFrom(){return S(this.quoteData,"data.memeModeCommonDexInfo.fromToken",{})}get computedGetQuoteTo(){return S(this.quoteData,"data.memeModeCommonDexInfo.toToken",{})}get computedGetQuoteFromAmount(){return S(this.quoteData,"data.memeModeCommonDexInfo.fromTokenAmount")}get computedGetQuoteToAmount(){return S(this.quoteData,"data.memeModeSingleChainSwapInfo.receiveAmount")}get computedQuoteTraceData(){return S(this.quoteData,"data.traceData")}get computedGetQuoteTokenTax(){return S(this.quoteData,"data.memeModeCommonDexInfo.tokenTax","")}get computedCustomQuoteLoading(){return!this.isAutoQuote&&this.quoteLoading}get computedQuoteIsInvalid(){return this.computedQuoteIsError||this.computedQuoteNetworkError||this.computedQuoteLiquidityError||this.computedQuoteIsHoneypot}},Xo=Rn;Xo.INIT_QUOTE_DATA={data:null,detailMsg:"",code:void 0,error_code:"",error_message:"",msg:"",err:null};u();l();P();F();var As=class{constructor(){this.loading=!0;this.setLoading=t=>{this.loading=t};this.fromToken=null;this.setFromToken=t=>{this.fromToken=t};this.onSocketUpdateFromToken=t=>{Ut(t,this.fromToken)&&this.setFromToken({...this.fromToken,...t})};this.onSocketUpdateFromTokenBalance=t=>{Ut(t,this.fromToken)&&this.setFromToken({...this.fromToken,amountNum:t.amountNum})};this.toToken=null;this.setToToken=t=>{this.toToken=t};this.selectSellValue="0";this.setSelectSellValue=t=>{this.selectSellValue=t};this.inputSellValue="";this.setInputSellValue=t=>{this.inputSellValue=t};this.isInputPercent=!0;this.setIsInputPercent=t=>{this.isInputPercent=t};L(this)}get computedSellNumber(){try{let t=Math.min(this.fromToken?.decimals||0,12),e=new Gt.BigNumber(this.inputSellValue||"0");if(this.selectSellValue===wo&&!this.isInputPercent)return this.inputSellValue?parseFloat(this.inputSellValue):"0";let o=new Gt.BigNumber(this.fromToken?.amountNum||"0");if(this.selectSellValue===wo&&this.isInputPercent){let i=e.multipliedBy(o).dividedBy(100);return parseFloat(i.toFixed(t,Gt.BigNumber.ROUND_DOWN)).toString()}let n=new Gt.BigNumber(this.selectSellValue).multipliedBy(o);return parseFloat(n.toFixed(t,Gt.BigNumber.ROUND_DOWN)).toString()}catch(t){return A.stuff(t),"0"}}get computedSellTokenSymbol(){return S(this,"fromToken.tokenSymbol")}get computedSellTokenBalanceLessAmount(){return S(this,"fromToken.computedSellNumber")>S(this,"fromToken.amountNum")}get computedSellNumberIsValid(){return new Gt.BigNumber(this.computedSellNumber).gt(0)}};u();l();F();var ys=class{constructor(){this.searchValue="";this.setSearchValue=t=>{this.searchValue=t};this.defaultSearchLoading=!0;this.setDefaultSearchLoading=t=>{this.defaultSearchLoading=t};this.searchLoading=!1;this.setSearchLoading=t=>{this.searchLoading=t};this.commonSearchState=!1;this.setCommonSearchState=t=>{this.commonSearchState=t};this.normalTokenList=[];this.unsupportedTokenList=[];this.fetchDefaultTokenList=async({chainId:t,computedAccountId:e,userUniqueId:o})=>{this.setDefaultSearchLoading(!0),this.setCommonSearchState(!1);let[r,n]=await _(C.get(ua,{params:{chainId:t,accountId:e,userUniqueId:o}}));if(this.searchValue){this.setDefaultSearchLoading(!1);return}r&&(A.stuff(r),this.normalTokenList=[],this.unsupportedTokenList=[]),n&&n.data&&(this.normalTokenList=n?.data||[],this.unsupportedTokenList=[]),this.setDefaultSearchLoading(!1)};this.cancelSearchRef=null;this.fetchSearchTokenList=async({chainId:t,computedAccountId:e,userUniqueId:o})=>{if(!this.searchValue)return;this.cancelSearchRef&&this.cancelSearchRef.abort(),this.setSearchLoading(!0),this.setCommonSearchState(!0),this.cancelSearchRef=$();let[r,n]=await _(C.get(la,{params:{chainId:t,accountId:e,userUniqueId:o,inputContent:this.searchValue},signal:this.cancelSearchRef?.signal}));if(!this.searchValue){this.setSearchLoading(!1);return}r&&!this.isCancel(r)&&(A.stuff(r),this.normalTokenList=[],this.unsupportedTokenList=[]),n&&n.data&&(this.normalTokenList=n?.data?.memeList,n?.data?.memeUnsupportList?this.unsupportedTokenList=n?.data?.memeUnsupportList.map(i=>{let c=i;return c.unSupportedMeme=!0,c}):this.unsupportedTokenList=[]),this.setSearchLoading(!1)};this.highRiskToken=null;this.setHighRiskToken=t=>{this.highRiskToken=t};this.highRiskCallBack=()=>{};this.setHighRiskCallBack=t=>{this.highRiskCallBack=t};L(this)}isCancel(t){return Tt(t)}};u();l();P();var ks=class{constructor(){this.isSwapLoading=!1;L(this,{},{autoBind:!0})}setIsSwapLoading(t){this.isSwapLoading=t}getSolanaUnsignedTx(t){let e=S(t,"calldataParams.enableJito"),o=t?.unsignedTx||"{}";try{return e?JSON.parse(o).array:[JSON.parse(o)]}catch(r){throw new Error(r)}}getJitoTxData(t){let e=new ve,o=this.getSolanaUnsignedTx(t);return Promise.all(o.map(e.txData))}async onSolanaSwap({data:t,signedTransactions:e,txArray:o}){try{let r=S(t,"calldataParams.enableJito"),n=await tn({walletId:t.walletId,swapParams:t.calldataParams,signedTransactions:e,txArray:o,enableJito:r,isMemeMode:!0});A.info(v.MEME_SWAP_BROADCAST_PARAMS,{data:{...t,solanaBroadcastParams:n,unsignedTxArray:o,signedTransactions:e}});let i=await Gu(n);return A.info(v.MEME_SWAP_BROADCAST_SUCCESS,{data:{...t,solanaBroadcastParams:n,unsignedTxArray:o,signedTransactions:e,broadcastRes:i}}),i}catch(r){throw A.error(v.MEME_SWAP_BROADCAST_ERROR,{data:{error:r,...t,unsignedTxArray:o,signedTransactions:e}}),this.broadcastErrorMessage(r),new Error(r?.error_message)}}broadcastErrorMessage(t){let e=null;try{e=JSON.parse(t?.error_message)}catch{e=""}Qt.error({title:e||f("swaptrade_home_toast_broadcast_failed")})}};var de=class{constructor(){this.reset=()=>{this.memeCommonStore=new ke(this),this.memeAccountStore=new Qr(this),this.sendTransactionStore=new co,this.memeConfigStore=new Is,this.memeBuyStore=new Ts,this.memeSellStore=new As,this.memePositionStore=new Cs,this.memeQuoteStore=new Xo,this.memeTokenListStore=new ys,this.memeSwapStore=new ks};this.reset()}static getInstance(){return de.instance||(de.instance=new de),de.instance}},fl=de;var zd=({localeData:a,...t})=>{Kc();let e=(0,gl.useLocation)(),o;return e.pathname.includes(gt)?o=E.BRIDGE:e.pathname.includes(ha)?o=E.LIMIT_ORDER:e.pathname.includes("/dex-swap/meme")?o=E.MEME_SWAP:e.pathname===mt&&(o=E.SWAP),o===E.MEME_SWAP?Ge.default.createElement(Dr,{localeData:a,isDev:!0,noRemoteData:!0,customRender:r=>r},Ge.default.createElement(fa.Provider,{value:fl.getInstance()},Ge.default.createElement(hl,{...t}))):Ge.default.createElement(Dr,{localeData:a,isDev:!0,noRemoteData:!0,customRender:r=>r},Ge.default.createElement(dc,{swapRootStore:Uu,bridgeRootStore:Du,initTab:o},Ge.default.createElement(Hc,{currentTab:o,...t})))};var wN=rt(zd);export{Vu as a,Iw as b,vw as c,Lw as d,Hu as e,cl as f,wN as g};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-T4G5BNXN.js.map
