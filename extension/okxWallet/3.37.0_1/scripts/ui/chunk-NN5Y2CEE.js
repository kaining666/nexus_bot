import{d as uo,e as _o}from"./chunk-YZ2KLN72.js";import{h as ho,k as Co}from"./chunk-4KH3NTXU.js";import{a as et,b as vo,c as To,d as go}from"./chunk-BQN2HM7G.js";import{a as yo,b as xo}from"./chunk-HWTJIJS5.js";import{a as Me}from"./chunk-ULXBFEFQ.js";import{a as fo}from"./chunk-AWJSICVW.js";import{a as wo}from"./chunk-M7EHI3O6.js";import{a as oo,b as Be,d as no,e as lo,g as mo,i as co,k as po,m as ge}from"./chunk-CZ3ZPSYV.js";import{b as to}from"./chunk-G3OZP6IX.js";import{a as so}from"./chunk-4O6B2TSW.js";import{c as $e,e as $t}from"./chunk-EUSYZW2R.js";import{a as Re,b as io,c as ro}from"./chunk-AFBCVKXE.js";import{a as Xt,f as Xe,t as eo}from"./chunk-3UTQU6PS.js";import{h as ao}from"./chunk-HN3RS7KM.js";import{b as Kt}from"./chunk-4JNVSGED.js";import{c as Rt}from"./chunk-ULBHEX2Q.js";import{d as Te}from"./chunk-77F6B6US.js";import{b as Jt}from"./chunk-TGE2FOSE.js";import{a as Ut}from"./chunk-TCSX4HQQ.js";import{a as Se,d as Gt}from"./chunk-LINATLLG.js";import{a as zt,b as Yt}from"./chunk-AUKWYF5J.js";import{c as Qt}from"./chunk-6IJDRLPZ.js";import{A as ht,la as Ct}from"./chunk-PNY3TA7V.js";import{h as jt}from"./chunk-4AVGLJGA.js";import{a as Zt,d as qt}from"./chunk-3QF6VHEM.js";import{a as Vt}from"./chunk-CE23KTLV.js";import{b as me}from"./chunk-O4AMPUEN.js";import{f as Dt,h as Ke,l as Ot,m as Ht,q as O}from"./chunk-AACZ2HW4.js";import{o as ve}from"./chunk-DD3BDKUM.js";import{Ca as Lt,H as It,K as Pt,Pa as kt,Ta as St,Ua as Je,bc as un,zb as Bt}from"./chunk-TYUTKD3A.js";import{D as At,V as j,_ as ke,b as Le,d as Et,k as Nt}from"./chunk-WOHVJ5VI.js";import{a as Y}from"./chunk-QBSBGD35.js";import{d as Mt}from"./chunk-GFKCYZVW.js";import{g as Wt}from"./chunk-JFKXAMRK.js";import{c as g}from"./chunk-FVQK2MNN.js";import{Ac as wt,Gb as Ve,Hb as pt,Ib as qe,Jb as Ie,Lb as ut,Nb as xe,Oc as mn,Rc as bt,V as ct,Vb as dt,Wc as cn,Xa as sn,Xc as Ft,Yc as pn,fc as Pe,lc as _t,oc as ln}from"./chunk-QWQGBYOY.js";import{A as vt,G as Tt,H as gt,b as yt,d as xt,o as K,q as je}from"./chunk-PLHFXPVU.js";import{K as Ye,e as lt,pa as mt}from"./chunk-5BQQ5BTM.js";import{N as oe,l as q,v as Ze,w as i}from"./chunk-4IQZG47E.js";import{H as Qe,T as ft,ca as A}from"./chunk-X62Q7VCJ.js";import{a as V}from"./chunk-WQYVBC56.js";import{f as I,m as r,o as s}from"./chunk-CS4SUKWE.js";r();s();r();s();oe();r();s();var be=I(V());r();s();r();s();var J=I(V()),bo=I(un());oe();Pe();r();s();var $={title:"_title_1xthp_1",subtitle:"_subtitle_1xthp_9",fee:"_fee_1xthp_15",feeTitle:"_feeTitle_1xthp_21",feeDetail:"_feeDetail_1xthp_26",speedDetail:"_speedDetail_1xthp_33",gasDetail:"_gasDetail_1xthp_36"};var dn=()=>{let e=Kt(),t=ao(),o=jt(),a=(0,bo.useSelector)(Bt),n=to(),_=uo(),l=async(m,y,d,w=0)=>{let{baseCoin:T}=await e(d,!0),b=o?.[T.coinId]||"0",F=Ve(m,y),E=Ht(qe(F,w),{symbol:T.symbol,decimals:T.decimals}),x=Ot(Ve(pt(qe(F,w),10**T.decimals),b),{symbol:a.symbol});return`${E} ${x}`},u=(m,y)=>{let d=n(m);return i("wallet_extension_transaction_confirmation_gas_detail",{gasPrice:q.thousandFormat(d),gasLimit:q.thousandFormat(y)})},c=async(m,y)=>{try{return await _({...m,coinId:y})}catch{return""}},p=({userGasInfo:m,updateGasInfo:y,fetchParams:d})=>{let{gasPrice:w,maxFeePerGas:T,maxPriorityFeePerGas:b}=y,{supportEip1559:F,gasLimit:E,gasPrice:x,maxFeePerGas:h,maxPriorityFeePerGas:M}=m;return F?(delete d.gasPrice,{...d,value:d?.amount,maxFeePerGas:T||h,maxPriorityFeePerGas:b||M,gasLimit:E}):{...d,value:d?.amount,gasPrice:w||x,gasLimit:E}};return async({coinId:m,baseCoinAmountUse:y,userGasInfo:d,updateGasInfo:w,serverSignInfo:T,fetchParams:b})=>{let{gasPrice:F,maxFeePerGas:E}=w,{supportEip1559:x,gasLimit:h,gasPrice:M,maxFeePerGas:P}=d,B=0;T?.needExtFee&&(B=await c(p({userGasInfo:d,updateGasInfo:w,fetchParams:b}),m));let G=x?P:M,Z=await l(G,h,m),H=u(G,h),U=x?E:F,z=await l(U,h,m,B),R=u(U,h);return new Promise((W,Q)=>{let re=K.prompt({hideCloseBtn:!1,alignBottom:!1,titleCenter:!1,infoType:null,confirmText:i("extension_toast_btn_confirmgasfee"),confirmBtnProps:{type:A.TYPE.highlight,size:A.SIZE.lg},onConfirm:async()=>{re.destroy();let{baseCoin:ee}=await e(m,!0),{coinAmountInt:te}=t(ee.coinId),ne=Ie(te,y);po({userGasInfo:d,updateGasInfo:w,baseCoinAmountAvailable:ne,L1FEE:B})?(Tt.error({title:i("extension_toast_text_insufficient_balance")}),Q(new Error(ge))):W(w)},onClose:()=>{re.destroy(),Q(new Error(ge))},renderContent:ee=>J.default.createElement(ee,null,J.default.createElement("div",{className:$.title},i("extension_toast_title_transaction_replace")),J.default.createElement("div",{className:$.subtitle},i("extension_toast_subtitle_gasincrease")),J.default.createElement("div",{className:$.feeTitle},i("extension_toast_title_current_transaction")),J.default.createElement("div",{className:$.fee},J.default.createElement("div",{className:$.feeDetail},Z),J.default.createElement("div",{className:$.gasDetail},H)),J.default.createElement("div",{className:$.feeTitle},i("extension_toast_title_gasprice")),J.default.createElement("div",{className:$.fee},J.default.createElement("div",{className:$.speedDetail},z),J.default.createElement("div",{className:$.gasDetail},R)))})})}},Fo=dn;var _n=()=>{let e=Fo();return async({coinId:o,baseCoinAmountUse:a,userGasInfo:n,serverGasInfo:_,serverSignInfo:l,originTxGasInfo:u,fetchParams:c})=>{let p=co({userGasInfo:n,serverGasInfo:_,originTxGasInfo:u});return p?.gasPrice||p?.maxFeePerGas?(await e({coinId:o,baseCoinAmountUse:a,userGasInfo:n,updateGasInfo:p,serverSignInfo:l,fetchParams:c}),Promise.resolve(p)):Promise.resolve()}},Eo=_n;r();s();var Ge={content:"_content_18w99_1",title:"_title_18w99_4",text:"_text_18w99_10"};var fn=()=>{let e=Eo();return async({coinId:o,baseCoinAmountUse:a="0",showSelectNonceDialog:n=!1,onChainNonce:_="0",newNonce:l="0",userGasInfo:u={},serverGasInfo:c={},serverSignInfo:p={},originTxGasInfo:f={},fetchParams:m={},title:y="",text:d="",confirmText:w="",cancelText:T=""})=>new Promise((b,F)=>{if(n){let E=K.prompt({hideCloseBtn:!0,alignBottom:!1,titleCenter:!1,infoType:null,cancelBtnProps:{category:A.CATEGORY.outline,size:A.SIZE.lg},confirmBtnProps:{type:A.TYPE.highlight,size:A.SIZE.lg},confirmText:w,cancelText:T,onConfirm:async()=>{E.destroy();try{let x=await e({coinId:o,baseCoinAmountUse:a,userGasInfo:u,serverGasInfo:c,serverSignInfo:p,originTxGasInfo:f,fetchParams:m});b(x?{nonce:_,updateGasInfo:x}:{nonce:_})}catch(x){F(x)}},onCancel:()=>{E.destroy(),b({nonce:l})},renderContent:x=>be.default.createElement(x,null,be.default.createElement("div",{className:Ge.content},be.default.createElement("div",{className:Ge.title},y),be.default.createElement("div",{className:Ge.text},d)))})}else b({nonce:l})})},De=fn;var yn=()=>{let e=De();return async({coinId:o,baseCoinAmountUse:a,hasFailedTx:n,onChainNonce:_,newNonce:l,userGasInfo:u,serverGasInfo:c,originTxGasInfo:p,serverSignInfo:f,fetchParams:m})=>e({coinId:o,baseCoinAmountUse:a,showSelectNonceDialog:n,onChainNonce:_,newNonce:l,userGasInfo:u,serverGasInfo:c,serverSignInfo:f,originTxGasInfo:p,fetchParams:m,title:i("wallet_extension_transaction_popup_failed_transaction"),text:i("wallet_extension_transaction_popup_replace_failed_transaction"),confirmText:i("wallet_extension_transaction_popup_btn_replace"),cancelText:i("wallet_extension_transaction_popup_btn_skip")})},No=yn;r();s();oe();var xn=()=>{let e=De();return async({coinId:o,baseCoinAmountUse:a,hasPendingTx:n,onChainNonce:_,newNonce:l,userGasInfo:u,serverGasInfo:c,originTxGasInfo:p,serverSignInfo:f,fetchParams:m})=>e({coinId:o,baseCoinAmountUse:a,showSelectNonceDialog:n,onChainNonce:_,newNonce:l,userGasInfo:u,serverGasInfo:c,serverSignInfo:f,fetchParams:m,originTxGasInfo:p,title:i("wallet_extension_transaction_popup_pending_transaction"),text:i("wallet_extension_transaction_popup_replace_pending_transaction"),confirmText:i("wallet_extension_transaction_popup_btn_replace"),cancelText:i("wallet_extension_transaction_popup_btn_continue_wait")})},Ao=xn;r();s();oe();mt();var vn=()=>async({isRepeat:t,onCancel:o})=>new Promise((a,n)=>{if(t){let _=K.prompt({alignBottom:!1,hideCloseBtn:!0,infoType:K.Prompt.INFO_TYPE.warn,confirmBtnProps:{type:A.TYPE.highlight,size:A.SIZE.lg},cancelBtnProps:{category:A.CATEGORY.outline,size:A.SIZE.lg},title:i("wallet_extension_popup_repeat_order"),confirmText:i("wallet_extension_popup_repeat_order_btn_continue"),cancelText:o?i("wallet_extension_popup_repeat_order_btn_viewhistory"):null,text:i("wallet_extension_popup_repeat_order_desc"),onConfirm:()=>{_.destroy(),a()},onCancel:()=>{_.destroy(),lt(o)&&o(),n(new Error(ge))}})}else a()}),Io=vn;var Po="FetchError";var Lo=()=>{let e=No(),t=Ao(),o=Io(),a=async({coinId:l,from:u,to:c,amount:p,gasPrice:f})=>{let[{data:m=[]},{data:y={}}]=await Promise.all([Pt({checkTypes:[ke.REPEAT,ke.OVERWRITTEN],coinId:l,from:u,to:c,amount:p,gasPrice:f}),It({coinId:l,address:u},{fromAddr:u,scenario:Nt.SCENARIO_SEND_COIN})]);return{txToastCheckData:m,signInfoData:y}},n=l=>{let{hasFailedTx:u,hasPendingTx:c,nonce:p,newNonce:f,originGasPrice:m,originPriorityFee:y}=mo(l),d=lo(l,ke.REPEAT);return{hasFailedTx:u,hasPendingTx:c,nonce:p,newNonce:f,originGasPrice:m,originPriorityFee:y,isRepeat:d}};return async({coinId:l,from:u,to:c,amount:p,gasPrice:f,baseCoinAmountUse:m,userGasInfo:y,whetherCheckRepeat:d,onRepeatCancel:w})=>{let T=[],b={};try{let z=await a({coinId:l,from:u,to:c,amount:p,gasPrice:f});if(!Array.isArray(z.txToastCheckData)||typeof z.signInfoData!="object")throw new Error(Po);T=z.txToastCheckData,b=z.signInfoData?.info||{}}catch{throw new Error(Po)}let F=n(T),{nonce:E,newNonce:x,originGasPrice:h,originPriorityFee:M,hasFailedTx:P,hasPendingTx:B,isRepeat:G}=F,Z={originGasPrice:h,originPriorityFee:M},H={coinId:l,baseCoinAmountUse:m,onChainNonce:E,newNonce:x,userGasInfo:y,serverGasInfo:b.gasPrice,serverSignInfo:b,originTxGasInfo:Z,fetchParams:{amount:p,coinId:l,from:u,gasPrice:f,to:c}},U={nonce:x};return P?U=await e({...H,hasFailedTx:P}):B&&(U=await t({...H,hasPendingTx:B})),d&&await o({isRepeat:G,onCancel:w}),U}};r();s();var Ho=I(V());r();s();var v=I(V()),Fe=I(ve()),tt=I(Qe());oe();r();s();var X=I(V()),ko=I(ve());r();s();var k={"mev-control-enter":"_mev-control-enter_1h6im_1",mevControlEnter:"_mev-control-enter_1h6im_1","mev-control-content":"_mev-control-content_1h6im_6",mevControlContent:"_mev-control-content_1h6im_6","mev-control-content-title":"_mev-control-content-title_1h6im_9",mevControlContentTitle:"_mev-control-content-title_1h6im_9","mev-control-content-desc":"_mev-control-content-desc_1h6im_14",mevControlContentDesc:"_mev-control-content-desc_1h6im_14","list-content":"_list-content_1h6im_18",listContent:"_list-content_1h6im_18","list-item":"_list-item_1h6im_21",listItem:"_list-item_1h6im_21","item-icon":"_item-icon_1h6im_24",itemIcon:"_item-icon_1h6im_24","list-item-text":"_list-item-text_1h6im_28",listItemText:"_list-item-text_1h6im_28","mev-control-title":"_mev-control-title_1h6im_32",mevControlTitle:"_mev-control-title_1h6im_32","mev-control-sub-title":"_mev-control-sub-title_1h6im_37",mevControlSubTitle:"_mev-control-sub-title_1h6im_37","mev-control-picture":"_mev-control-picture_1h6im_42",mevControlPicture:"_mev-control-picture_1h6im_42","mev-control-divider":"_mev-control-divider_1h6im_46",mevControlDivider:"_mev-control-divider_1h6im_46","mev-control-text-content":"_mev-control-text-content_1h6im_50",mevControlTextContent:"_mev-control-text-content_1h6im_50","mev-status":"_mev-status_1h6im_54",mevStatus:"_mev-status_1h6im_54","mev-status__text":"_mev-status__text_1h6im_58",mevStatusText:"_mev-status__text_1h6im_58","mev-status__text__active":"_mev-status__text__active_1h6im_63",mevStatusTextActive:"_mev-status__text__active_1h6im_63","mev-tooltip":"_mev-tooltip_1h6im_66",mevTooltip:"_mev-tooltip_1h6im_66"};var Tn=({mevList:e,mevChecked:t,setMevChecked:o,...a})=>{let n=(0,X.useRef)(null),_=(0,ko.useSize)(n),l=c=>{o(c)},u=c=>X.default.createElement(Zt,{icon:{size:me.SIZE.lg,src:c.vendorIcon||Mt,type:me.TYPE.image},className:k["list-item"],onClick:()=>{l(c)},...a},X.default.createElement(g.FlexBox,{direction:g.DIRECTION.vertical},X.default.createElement(g.FlexBox,{align:g.ALIGN.center},X.default.createElement(O.Text,{className:k["list-item-text"]},c.name))),c.name===t.name&&X.default.createElement(g.FlexBox,{className:k["item-icon"],justify:"flex-end"},X.default.createElement(me,{icon:"okds-success-circle-fill",size:me.SIZE.sm})));return e.length?X.default.createElement("div",{ref:n,className:k["list-content"]},X.default.createElement(qt,{itemKey:"id",height:_?.height??408,searchable:!1,dataSource:e,renderItem:u})):null},So=Tn;var Bo="mevOperated",gn=2e3,hn=({isMev:e,needTooltip:t=!0,isShowBlockSwapMevTooltip:o,onMevChange:a,mevChecked:n,mevList:_,setMevChecked:l,className:u="",children:c})=>{let[p,{setFalse:f,setTrue:m}]=(0,Fe.useBoolean)(!1),[y,{toggle:d}]=(0,Fe.useBoolean)(!1),[w,T]=(0,v.useState)(""),[b]=(0,v.useState)(e);(0,v.useEffect)(()=>{let h=!e&&o,M=!e&&Ze.get(Bo)===void 0,P=()=>{f()},B=()=>{Ze.set(Bo,1)};return h?(T("wallet_extension_trade_tooltip_enable_mev"),m(),document.addEventListener("click",P,!1)):M&&(T("wallet_extension_mev_pop_turnon_mev"),m(),document.addEventListener("click",P,!1),document.addEventListener("click",B,!1)),()=>{document.removeEventListener("click",P,!1),document.removeEventListener("click",B,!1)}},[]);let F=()=>{window.localStorage.setItem("mevCheckedName",n.name)};(0,v.useEffect)(()=>{b&&n&&(F(),a(b,n))},[b,n]);let E=(0,Fe.useMemoizedFn)(()=>{typeof a=="function"&&(F(),a(!e,n)),Ct({mev:!e}),T(e?"wallet_extension_mev_pop_mev_off":"wallet_extension_mev_pop_mev_on"),d(),m(),setTimeout(()=>{f()},gn)}),x=Wt({dark:"/cdn/assets/imgs/245/127CAD27DF691613.png",light:"/cdn/assets/imgs/2311/700F36AE20EC394E.png"});return n?v.default.createElement(v.default.Fragment,null,v.default.createElement("div",{className:(0,tt.default)(k["mev-status"],u),onClick:d},v.default.createElement(Dt,{show:p,title:t&&i(w),placement:vt.DIRECTION.bottomRight},c||v.default.createElement(io,{clickable:!0,title:i("wallet_extension_mev_subtitle_protection")},v.default.createElement(O.Text,{className:(0,tt.default)(k["mev-status__text"],{[k["mev-status__text__active"]]:e})},i(e?"wallet_extension_mev_desc_open":"wallet_extension_mev_desc_closed"))))),v.default.createElement(K.Action,{visible:y,onClose:d,onCancel:d,title:v.default.createElement(v.default.Fragment,null),isFull:!0,noContentPadding:!0,noMargin:!0,onConfirm:E,confirmBtnProps:e?{size:A.SIZE.lg,type:A.TYPE.primary,category:A.CATEGORY.outline}:{size:A.SIZE.lg,type:A.TYPE.highlight,category:A.CATEGORY.fill},confirmText:e?i("wallet_extension_mev_btn_disable_mev"):i("wallet_extension_mev_btn_activate_protection")},v.default.createElement(g.Box,{className:k["mev-control-content"]},v.default.createElement(g.FlexBox,{justify:"space-between",align:g.ALIGN.center},v.default.createElement(g.Space,{direction:g.DIRECTION.vertical,space:12},v.default.createElement(O.Text,{className:k["mev-control-title"]},i("wallet_extension_mev_grouptitle_mev_protection")),v.default.createElement(O.Text,{style:{color:e?"var(--okd-color-semantic-positive)":"var(--okd-color-content-primary)"},className:k["mev-control-sub-title"]},i(e?"wallet_extension_mev_label_enabled":"wallet_extension_mev_label_disabled"))),v.default.createElement(xt,{className:k["mev-control-picture"],src:x})),v.default.createElement(Ke,{className:k["mev-control-divider"],style:{marginTop:24}}),v.default.createElement(g.Space,{className:k["mev-control-text-content"],direction:g.DIRECTION.vertical,space:24},v.default.createElement(g.Box,null,v.default.createElement(O.Text,{className:k["mev-control-content-title"]},i("wallet_extension_mev_title_provider")),v.default.createElement(So,{mevList:_,mevChecked:n,setMevChecked:l})),v.default.createElement(Ke,{className:k["mev-control-divider"]}),v.default.createElement(g.Box,null,v.default.createElement(O.Text,{className:k["mev-control-content-title"]},i("wallet_extension_mev_title_mev_attack")),v.default.createElement(O.Text,{className:k["mev-control-content-desc"]},i("wallet_extension_mev_subtitle_mev_attack"))),v.default.createElement(g.Box,null,v.default.createElement(O.Text,{className:k["mev-control-content-title"]},i("wallet_extension_mev_title_prevent_attacks")),v.default.createElement(O.Text,{className:k["mev-control-content-desc"]},i("wallet_extension_mev_subtitle_prevent_attacks"))),v.default.createElement(g.Box,null,v.default.createElement(O.Text,{className:k["mev-control-content-desc"]},i("wallet_extension_mev_subtitle_mev_reset"))))))):null},Mo=hn;r();s();r();s();var Oe=I(V()),Go=I(ve());cn();pn();var Cn=()=>{let[e,{setFalse:t}]=(0,Go.useBoolean)(!0),[o,a]=(0,Oe.useState)([]),n=async()=>{try{let _=await bt(Ft.getMevList,{},{});return a(_.data),_.data}catch{return[]}finally{t()}};return(0,Oe.useEffect)(()=>{n()},[]),[e,o]},Do=Cn;var ue=I(V()),wn=e=>{let[t,o]=Do(),[a,n]=(0,ue.useState)(""),[_,l]=(0,ue.useState)([]);(0,ue.useEffect)(()=>{let c=o.find(m=>window.localStorage.getItem("mevCheckedName")===m.name&&m.chainIds.includes(Number(e))),p=o.find(m=>m.chainIds.includes(Number(e))),f=o.filter(m=>m.chainIds.includes(Number(e)));l(f),n(c||p)},[o,e]);let u=(0,ue.useMemo)(()=>a&&o.length>0&&!t,[a,o,t]);return[a,_,u,n]},Oo=wn;var bn=({isMev:e,chainId:t,className:o,needTooltip:a,isShowBlockSwapMevTooltip:n,onMevChange:_,children:l})=>{let[u,c,p,f]=Oo(t);return p&&Ho.default.createElement(Mo,{isMev:e,needTooltip:a,className:o,isShowBlockSwapMevTooltip:n,onMevChange:_,mevChecked:u,mevList:c,setMevChecked:f},l)},Wo=bn;r();s();var D=I(V()),_e=I(ve());mt();oe();r();s();var Ee=I(V()),de=I(Qe());oe();r();s();var ce={root:"_root_wpiv5_1",title:"_title_wpiv5_4",header:"_header_wpiv5_8",icon:"_icon_wpiv5_12",content:"_content_wpiv5_16",textarea:"_textarea_wpiv5_19",errorTip:"_errorTip_wpiv5_22",errorBordered:"_errorBordered_wpiv5_29"};function Fn({className:e,value:t,onChange:o,error:a,titleClass:n,errorTipClass:_,headerClassName:l,contentClassName:u,...c}){return Ee.default.createElement(yt,{defaultExpanded:!0,className:(0,de.default)(ce.root,e),titleClass:(0,de.default)(ce.title,n),headerClassName:(0,de.default)(ce.header,l),contentClassName:(0,de.default)(ce.content,u),customHeaderIcon:p=>Ee.default.createElement(me,{icon:"okds-arrow-chevron-down-md",size:me.SIZE.xs,className:(0,de.default)({"okui-accordion-header-icon-expanded":p},ce.icon)}),title:i("wallet_extension_inscription_text_hex_data_optional")},Ee.default.createElement(je.TextArea,{...c,inputClassName:ce.textarea,errorType:je.TIP_TYPE.always,error:!!a,value:t,onChange:p=>{let f=p.target.value||"";o?.(f.trim())}}),!!a&&Ee.default.createElement(O.Text,{className:(0,de.default)(ce.errorTip,_)},a))}var Uo=Fn;r();s();oe();function zo(e){return!!e&&(e.toLowerCase()==="0x"||!Gt(e)||e.length%2!==0)?i("wallet_extension_inscription_text_input_formatting_error"):null}r();s();var Yo=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"unpause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"account",type:"address"}],name:"isPauser",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"paused",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"renouncePauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"account",type:"address"}],name:"addPauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"pause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[{name:"name",type:"string"},{name:"symbol",type:"string"},{name:"decimals",type:"uint8"},{name:"totalSupply",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Unpaused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserRemoved",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"}];r();s();var C=I(V()),ie=I(ve()),Vo=I(Qe());oe();Pe();r();s();var S={root:"_root_4gxf5_1",icon:"_icon_4gxf5_1",editApproveAmountModal:"_editApproveAmountModal_4gxf5_10",content:"_content_4gxf5_22",txTypeInfo:"_txTypeInfo_4gxf5_25",editArea:"_editArea_4gxf5_28",unlimitedText:"_unlimitedText_4gxf5_33",unlimitedSymbol:"_unlimitedSymbol_4gxf5_43",symbolClassName:"_symbolClassName_4gxf5_60",quickHandler:"_quickHandler_4gxf5_63",balanceWrap:"_balanceWrap_4gxf5_70",balance:"_balance_4gxf5_70",maxBalance:"_maxBalance_4gxf5_92",unlimited:"_unlimited_4gxf5_33",text:"_text_4gxf5_105",authQuantityWarnTip:"_authQuantityWarnTip_4gxf5_112",danger:"_danger_4gxf5_119",info:"_info_4gxf5_122",approveTip:"_approveTip_4gxf5_125",footerActions:"_footerActions_4gxf5_133"};var Zo=q.toPlainString(10**40),En=e=>{typeof e!="string"&&(e=e.toString());let t=e?.length;return t<=9?36:t>=10&&t<12?32:t===12?30:t>=13&&t<=15?24:t>=16&&t<=18?20:t>=19&&t<=24?16:12},qo=({address:e,coins:t,baseCoinId:o})=>{if(Array.isArray(t))return t.find(a=>a?.baseCoinId===o&&Ut(a?.address,e,{baseCoinId:o})||qo({address:e,baseCoinId:o,coins:a?.childrenCoin}))},Nn=({txTypeInfo:e,walletAccount:t,approve:o,baseCoin:a,onAuthTokenAmountChange:n,updateApproveInfo:_})=>{let{walletId:l}=t,{tokenInfo:u,id:c,amount:p,authQuantity:f}=o||{},{autoEdit:m,defaultAmount:y,warnTip:d}=f||{},{address:w,decimals:T,symbol:b}=u,F=go(b,12),[E,x]=(0,C.useState)(!1),[h,M]=(0,C.useState)(!1),[P,B]=(0,C.useState)(0),G=(0,ie.useMemoizedFn)((L=p)=>{M(Je(L)),B(yo(L,T)),x(!0)}),Z=(0,ie.useMemoizedFn)(()=>{M(L=>!L),B(0)}),H=(0,ie.useMemoizedFn)(()=>{M(!0),B(0)}),U=(0,C.useMemo)(()=>d?{type:S.info,text:d}:h&&!Je(y)?{type:S.danger,text:i("wallet_extension_approve_alert_high_risk_unlimited")}:!h&&q.eq(P||0,0)?{type:S.info,text:i("wallet_extension_approve_cannot_zero")}:null,[d,h,y,P]),{chainId:z}=a||{},{coinId:R}=Te(void 0,void 0,{chainId:z,address:w})||{},W=Me(R,l)?.coinAmount,Q=q.thousandFormat(W),re=(0,ie.useMemoizedFn)(()=>{M(!1),B(W)}),ee=(0,C.useMemo)(()=>!(h||q.gt(`${P||0}`,0)),[h,P]),te=(0,ie.useMemoizedFn)(()=>{let L=h?St:xo(P,T);n(L),_(c,{amount:L}),x(!1)}),ne=wo(),ae=Jt({},l),se=(0,C.useMemo)(()=>ae?.find(L=>L.localType===a?.localType),[a?.localType,ae?.length]),pe=(0,ie.useMemoizedFn)(async(L=0)=>{if(!qo({address:w,coins:ne,baseCoinId:a?.coinId}))try{let we=await zt({contractAddress:w,chainInfo:se});await Yt(we)}catch(we){++L<3?pe(L):gt.error({title:we?.msg||i("wallet_home_toast_network_error")})}});return(0,ie.useMount)(()=>{m&&G(y),pe()}),C.default.createElement(g.Box,{className:S.root},C.default.createElement(g.Box,{className:S.icon,onClick:()=>{G()}},C.default.createElement(ft,{className:"okx-wallet-plugin-draw-20"})),C.default.createElement(K.Action,{hideCloseBtn:!0,noContentPadding:!0,visible:E},C.default.createElement(g.Box,{className:S.editApproveAmountModal},C.default.createElement(g.Box,{className:S.content},C.default.createElement(ho,{bordered:!1,txTypeInfo:e,className:S.txTypeInfo}),C.default.createElement(g.Box,{className:S.editArea},h?C.default.createElement(O.Text,{onClick:Z,className:S.unlimitedText},i("wallet_extension_transfer_title_unlimited_amount",{token:C.default.createElement(O.Text,{className:S.unlimitedSymbol},F)})):C.default.createElement(Rt,{symbol:F,autoSize:En,placeholder:"0",max:Zo,decimals:T,value:P,onChange:L=>{ut(L,Zo)&&B(L)},style:{fontWeight:700,height:"42px"},symbolClassName:S.symbolClassName})),C.default.createElement(g.Box,{className:S.quickHandler},!!Number(W)&&C.default.createElement(g.Box,{className:S.balanceWrap},C.default.createElement(O.Text,{className:S.balance,ellipsis:{tooltip:Q}},i("wallet_extension_approve_label_balance",{amount:Q})),C.default.createElement(g.Box,{className:S.maxBalance,onClick:re},i("commonall_enterfield_btn_max"))),C.default.createElement(g.Box,{onClick:H,className:S.unlimited},C.default.createElement(g.Box,{className:S.text},i("wallet_extension_transfer_dialog_checkbox_set_to_unlimited")))),!!U&&C.default.createElement(g.Box,{className:(0,Vo.default)(S.authQuantityWarnTip,U.type)},U.text)),C.default.createElement(g.Box,{className:S.approveTip},i("wallet_extension_approve_desc_dapp_right")),C.default.createElement(Vt,{affixStyle:{position:"none"},placeholder:!1,className:S.footerActions},C.default.createElement(A,{block:!0,disabled:ee,category:A.CATEGORY.fill,type:A.TYPE.primary,size:A.SIZE.lg,onClick:te},i("wallet_extension_approve_btn_amount_confirmation"))))))},Qo=Nn;r();s();var He=I(V()),jo=I(ve());mn();sn();var An=({coinId:e,txParams:t,networkFee:o,modifiedData:a,mevInfo:n,isMev:_,gasReturnActivity:l})=>({coinId:e,toAddr:t?.to,fromAddr:t?.from,txSource:wt.DAPP,coinAmount:(Se(t?.value)?Y(t?.value):t?.value)||0,serviceCharge:o,inputData:a,mev:_?n?.name:"",activityId:l?.activityId}),In=({mergedParams:e,gasType:t})=>JSON.stringify({to:e?.to,gasType:t,from:e?.from,value:Se(e?.value)?Y(e?.value):e?.value,nonce:Se(e?.nonce)?Y(e?.nonce):e?.nonce,data:e?.data,gas:e?.gasLimit,oldTxHash:"",gasPrice:e?.supportEip1559?e?.maxFeePerGas:e?.gasPrice,repeatTxType:Et.CONFIRMING,priorityFee:e?.supportEip1559?e.maxPriorityFeePerGas:0}),Pn=({loading:e,isBalanceLoading:t})=>e||t,Ln=({coinId:e,txType:t,txParams:o,isMev:a,mevInfo:n,localType:_,modifiedData:l,walletAccount:u,customGasInfo:c,gasReturnActivity:p,modifiedDataError:f,isSufficientGas:m,isSufficientBalance:y,reportGasReturnActivityDataInConfirm:d,canConfirm:w,silentLoading:T,onCancel:b,onConfirm:F,onConfirmReplace:E,isBalanceLoadError:x,isBalanceLoading:h})=>{let{walletId:M}=u||{},P=Lo(),{networkFee:B,gasType:G,gasPrice:Z}=c||{},H=_o({coinId:e,walletId:M,localType:_,fromAddr:o?.from}),U=eo(An({coinId:e,txParams:o,networkFee:B,modifiedData:l,mevInfo:n,isMev:a,gasReturnActivity:p})),z=(0,He.useMemo)(()=>c?.isNetworkFeeLoading||Be(c,t)||x||f||T||w===!1||!m||!y,[T,c,t,f,w,m,y,x]),R=(0,jo.useMemoizedFn)(async()=>{if(E&&typeof F=="function")return F({isMev:a,coinId:e,mevInfo:n,txParams:o,customGasInfo:c,modifiedData:l,gasReturnActivity:p,reportGasReturnActivityDataInConfirm:d});let{nonce:ae,updateGasInfo:se}=await P({to:o?.to,from:o?.from,coinId:e,gasPrice:Z,userGasInfo:c,amount:Y(o?.value)||0,baseCoinAmountUse:Y(o?.value||0)});d();let pe={...o,...c,...se||{},nonce:ae,data:l};try{let L=await H(pe),Ce=await Xt(ct,L);return await U(L,{txHash:Ce,extJson:In({mergedParams:pe,gasType:G})}),F?.({txHash:Ce})}catch(L){return F?.({error:L})}}),{loading:W,onClick:Q}=Re(R),re=(0,He.useMemo)(()=>({disabled:z,loading:Pn({loading:W,isBalanceLoading:h}),actionType:Xe.ACTION_TYPE.CONFIRM,onClick:Q}),[z,Q,W,h]),{loading:ee,onClick:te}=Re(b);return[(0,He.useMemo)(()=>({loading:ee,onClick:te,actionType:Xe.ACTION_TYPE.CANCEL}),[ee,te]),re]},Jo=Ln;r();s();var We=I(V());oe();var kn=e=>{let[t,o]=(0,We.useState)({isNetworkFeeLoading:!0,gasLimit:"0",gasPrice:"0",maxFeePerGas:"0",maxPriorityFeePerGas:"0",supportEip1559:!1,gasType:j.STANDARD}),{gasLimitInfo:a={},gasLimit:n,gasPrice:_,maxFeePerGas:l,gasType:u,supportEip1559:c,customConfirmed:p,isGasLimitLoading:f,isNetworkFeeLoading:m,networkFee:y,maxPriorityFeePerGas:d,gasPriceInfo:w,extFee:T}=t,{minGasFee:b}=oo({gasLimit:n,gasPrice:_,maxPriorityFeePerGas:d,maxFeePerGas:l,supportEip1559:c,extFee:T,gasPriceInfo:w,gasLimitInfo:a,gasType:u}),F=(0,We.useMemo)(()=>u===j.CUSTOM&&!p?i("extension_send_mid_text_dapps_suggested_fee"):u||j.STANDARD,[p,u]),E=Be(t,e),x=m&&f&&!a?.gasLimit;return{level:F,estimateFailed:E,customGasInfo:t,loading:m,networkFee:x?void 0:b,maxNetworkFee:x?void 0:y,onCustomGasInfoChange:o}},Ko=kn;r();s();var he=I(V());ln();Pe();var Sn=({txType:e,walletId:t,coinId:o,txParams:a,customGasInfo:n,preExecuteLoading:_})=>{let[l,u]=(0,he.useState)(""),c=Te(o),{from:p,to:f}=a||{},[m,y]=(0,he.useState)("");(0,he.useEffect)(()=>{_||(et(e)||vo(e)?(u($e.approval),y(et(e)?"approve":"revoke_approve")):(u($e.dapp),y("Contract interaction")))},[_,e]);let d=$t({walletId:t,coinId:o,fromAddress:p,toAddress:f,txType:l,fee:dt(n?.networkFee),disabled:!f,unavailable:n.gasType===j.CUSTOM&&n.customConfirmed}),{status:w,activity:T,activityId:b,tip:F,clear:E}=d,x=()=>{_t({activityId:b,activity:T,status:w,tip:F,walletId:t,address:p})},h=T?.errorCode;return(0,he.useEffect)(()=>{!m||h===0&&ht({wallet_address:p,interactive_address:f,chain_id:c?.chainId,transaction_type:m})},[h,m,p,f,c?.chainId]),{gasReturnActivity:d,clearGasReturnInfo:E,reportGasReturnActivityDataInConfirm:x}},$o=Sn;r();s();Pe();var Bn=e=>{let{txParams:t={}}=e,{gasPrice:o,maxFeePerGas:a,maxPriorityFeePerGas:n}=t,_=t.gas||t.gasLimit,l=j.STANDARD,u,c,p,f=Y(_),m=Y(o),y=Y(a),d=Y(n);return xe(m,0)&&(l=j.CUSTOM,u=m),xe(y,0)&&xe(d,0)&&xe(y,d)&&(l=j.CUSTOM,c=y,p=d),xe(f,0)&&(l=j.CUSTOM),!t.to&&t.data&&(l=j.CUSTOM),{initialGasType:l,initialCustomMaxPriorityFee:p,initialCustomGasLimit:f,initialCustomGasPrice:u,initialCustomMaxBaseFee:Ie(c,p)}},Xo=Bn;r();s();var Ue={"data-input":"_data-input_dry9a_1",dataInput:"_data-input_dry9a_1","data-input-error-tip":"_data-input-error-tip_dry9a_5",dataInputErrorTip:"_data-input-error-tip_dry9a_5","mev-status__wrap":"_mev-status__wrap_dry9a_10",mevStatusWrap:"_mev-status__wrap_dry9a_10"};var Mn=e=>Number(e)===Le.INCREASE_ALLOWANCE?Yo:[],Gn=e=>{let{txId:t,chainId:o,walletId:a,txParams:n,dappInfo:_={},needMev:l=!1,openMev:u=!1,coinId:c,isShowBlockSwapMevTooltip:p,onMevChange:f,onConfirm:m,onConfirmReplace:y,onCancel:d}=e||{},[w,T]=(0,_e.useSetState)({mevInfo:{},isMev:u}),[b,{toggle:F}]=(0,_e.useBoolean)(!1),{from:E,to:x,value:h="0x0",data:M}=n||{},[P,B]=(0,D.useState)(""),G=Te(c,void 0,{chainId:o}),Z=G?.coinId,[H,U]=(0,D.useState)({}),z=H.loading,R=(0,D.useMemo)(()=>!x&&M?Lt.DEPLOY_CONTRACT:H?.approveInfoList?.[0]?.spender?.approvalType||"",[x,M,H]),W=Qt(G?.localType,a),Q=Y(h),re=Xo({txParams:n}),ee=fo(W.walletId),te=(0,D.useMemo)(()=>zo(P),[P]),{isMev:ne,mevInfo:ae}=w,se=P||M||"",pe=(0,D.useMemo)(()=>({dappData:JSON.stringify({to:x,from:E,value:h,data:se}),from:E,dappInfo:_,chainIndex:G?.chainId,method:At.SIGN_TRANSACTION}),[G?.chainId,E,se,x,h]),L=(0,_e.useMemoizedFn)((le,ye)=>{T({isMev:le,mevInfo:ye}),f?.(le,ye)}),{level:Ce,networkFee:we,maxNetworkFee:Ne,customGasInfo:ot,estimateFailed:nt,loading:Ro,onCustomGasInfoChange:en}=Ko(R),{gasReturnActivity:at,reportGasReturnActivityDataInConfirm:tn}=$o({txType:R,coinId:Z,txParams:n,customGasInfo:ot,preExecuteLoading:z,walletId:W.walletId}),it=Me(Z,a),{coinAmountInt:fe,isBalanceLoadError:on,isBalanceLoading:nn}=it,rt=(0,D.useMemo)(()=>(Ye(fe)||q.gte(fe,Ne))&&H?.needFillUp!==!0,[fe,Ne,H?.needFillUp]),st=(0,D.useMemo)(()=>!q.eq(Q,0)&&!Ye(fe)?q.lte(Q,q.sub(fe,Ne)):!0,[fe,Ne,Q]),an=Jo({coinId:Z,txType:R,txParams:n,isMev:ne,mevInfo:ae,isBalanceLoadError:on,isBalanceLoading:nn,canConfirm:H?.canConfirm,silentLoading:H?.silentLoading,isSufficientGas:rt,isSufficientBalance:st,walletAccount:W,customGasInfo:ot,gasReturnActivity:at,modifiedDataError:te,localType:G?.localType,modifiedData:se,walletId:W?.walletId,reportGasReturnActivityDataInConfirm:tn,onCancel:d,onConfirm:m,onConfirmReplace:y}),rn=(0,_e.useMemoizedFn)(le=>{let ye=Mn(R),Ae=kt(n?.data,ye);if(Ae){let ze=To(n?.data,{approveAmount:le},Ae);B(ze)}});return D.default.createElement(D.default.Fragment,null,D.default.createElement(Co,{handleCancel:d,preExecParams:pe,walletAccount:W,buttonGroup:an,onUpdatePreExecInfo:U,txState:{txId:t,baseCoin:G,estimateFailed:nt,isSufficientBalance:st,isSufficientGas:rt,coinWithBalance:it},localType:G?.localType,slot:{mev:!!l&&D.default.createElement(Wo,{isMev:ne,needTooltip:!1,className:Ue["mev-status__wrap"],chainId:G?.chainId,onMevChange:L,isShowBlockSwapMevTooltip:p}),networkFeeEntry:D.default.createElement(so,{level:Ce,coinId:Z,networkFee:we,loading:Ro,estimateFailed:nt,onClick:()=>{F(),ee({trade:"contract_interaction",all_confirmation:"network_fee"})}}),interactWith:!!x&&D.default.createElement(ro,{address:x,title:i("wallet_extension_popup_text_interact_with")}),advancedEntry:!M&&D.default.createElement(Uo,{value:P,error:te,onChange:B,className:Ue["data-input"],errorTipClass:Ue["data-input-error-tip"]})},renderEditApproveAmount:(le,ye)=>{let Ae=le?.authQuantity?.canEdit,ze=le?.spender?.approvalType;return[Le.INCREASE_ALLOWANCE,Le.AUTHORIZATION].includes(ze)&&Ae?D.default.createElement(Qo,{txTypeInfo:H?.txTypeInfo,walletAccount:W,approve:le,baseCoin:G,onAuthTokenAmountChange:rn,updateApproveInfo:ye}):null}}),D.default.createElement(no,{visible:b,coinId:Z,address:E,inputData:se,tokenAddress:x,value:Y(h),onBack:F,onClose:null,initialGasData:re,onGasChange:en,minimumGasLimit:ne?ae.gas:0,isMev:ne,mevInfo:ae,gasReturn:at,gasLimitOptions:{disabled:te}}))},$s=Gn;export{Lo as a,Uo as b,zo as c,Wo as d,$s as e};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-NN5Y2CEE.js.map
