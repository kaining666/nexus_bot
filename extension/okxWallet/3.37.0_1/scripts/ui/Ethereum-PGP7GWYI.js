import{b as Ro,f as Wo,g as Ho,h as Uo}from"./chunk-NA43DI2M.js";import{a as Go,b as tt,c as W,d as Oo,e as Do}from"./chunk-OB6QXAAH.js";import{m as Lo}from"./chunk-GRVLDL73.js";import"./chunk-H3MCRLMA.js";import{a as vo}from"./chunk-5Z2ABC5X.js";import{a as Mo}from"./chunk-PWFZTOJ4.js";import{a as Bo}from"./chunk-6IJJWFGG.js";import"./chunk-XFEP6SZ2.js";import{a as So}from"./chunk-GGC5WHBZ.js";import{a as ct}from"./chunk-5ISFBE2I.js";import{a as bo}from"./chunk-GMPC5KEE.js";import"./chunk-AM3AESLS.js";import{a as ko}from"./chunk-2LMYPNN3.js";import{a as Fo}from"./chunk-HZ2WJBGI.js";import"./chunk-LVIROCAQ.js";import{a as Ao}from"./chunk-YPLQ6VWF.js";import{g as No}from"./chunk-PZK64BR5.js";import"./chunk-HL2M5U7N.js";import{a as Je}from"./chunk-U5Z4GNFS.js";import"./chunk-BKZ6VPJ3.js";import{a as _o,b as xo,c as go,e as Io}from"./chunk-NN5Y2CEE.js";import{a as te,e as fo}from"./chunk-YZ2KLN72.js";import{d as ho,e as Eo,h as Ie}from"./chunk-4KH3NTXU.js";import{d as ue}from"./chunk-BQN2HM7G.js";import{a as Co,b as yo}from"./chunk-HWTJIJS5.js";import"./chunk-TW325B3E.js";import{a as To}from"./chunk-ULXBFEFQ.js";import{a as ne}from"./chunk-AWJSICVW.js";import"./chunk-M7EHI3O6.js";import{a as lo,b as po,d as uo}from"./chunk-CZ3ZPSYV.js";import"./chunk-2OUKWBEW.js";import"./chunk-MKDBLDTZ.js";import"./chunk-P5M6XTEC.js";import"./chunk-G3OZP6IX.js";import"./chunk-3YQP66WR.js";import"./chunk-3R4FWQXC.js";import"./chunk-GFGBVWFC.js";import"./chunk-OUXYJKLM.js";import"./chunk-J7NZRERL.js";import"./chunk-AW2VCDDG.js";import{b as Po}from"./chunk-IYMY6LUU.js";import{a as wo}from"./chunk-QNX3UOA4.js";import"./chunk-2NGH2WBA.js";import{d as et}from"./chunk-XLNWZJIM.js";import{a as ee,d as Ee}from"./chunk-5J5HPJFS.js";import{a as $e}from"./chunk-4O6B2TSW.js";import"./chunk-EUSYZW2R.js";import{a as J,c as Me}from"./chunk-AFBCVKXE.js";import"./chunk-MQKFVWSP.js";import"./chunk-VLSOWDRD.js";import{a as so,f as P,s as co}from"./chunk-3UTQU6PS.js";import{a as he}from"./chunk-ZQTA27XU.js";import"./chunk-YIQCYGP3.js";import"./chunk-I4BRG34M.js";import"./chunk-HN3RS7KM.js";import"./chunk-4JNVSGED.js";import"./chunk-AR6XF3U7.js";import"./chunk-V5XRXBAE.js";import{c as mo}from"./chunk-ULBHEX2Q.js";import"./chunk-LYNGOC3B.js";import{a as mt}from"./chunk-XS7NMQVU.js";import"./chunk-L7FDIAMD.js";import"./chunk-TXEBE5YY.js";import"./chunk-77F6B6US.js";import"./chunk-LLMO6UHT.js";import{a as ao}from"./chunk-TGE2FOSE.js";import"./chunk-RCQMEJEP.js";import"./chunk-WTBIP24L.js";import"./chunk-HWYDZOOB.js";import"./chunk-V6KIMULE.js";import"./chunk-SKYCSHSI.js";import"./chunk-TCSX4HQQ.js";import"./chunk-6H3Y45OD.js";import"./chunk-KALOGAGR.js";import{a as oo}from"./chunk-NIXASQZU.js";import"./chunk-E5Q7T5U3.js";import"./chunk-GOUDWO5Q.js";import"./chunk-AMRX6BE6.js";import"./chunk-ONJJAECZ.js";import"./chunk-KGGAUHSE.js";import"./chunk-452U5DPK.js";import"./chunk-LINATLLG.js";import{b as ro}from"./chunk-AUKWYF5J.js";import"./chunk-Q4S2WO7F.js";import"./chunk-WLGBPOGB.js";import{b as no}from"./chunk-DXILVGXO.js";import{a as eo,b as to}from"./chunk-YHUQOYS5.js";import"./chunk-Z3AVDJYR.js";import"./chunk-DYCW5JBN.js";import"./chunk-OMBHHY6I.js";import"./chunk-CKRUHP35.js";import"./chunk-P6N6KWSS.js";import"./chunk-U65S63W6.js";import"./chunk-DKAHQZW7.js";import"./chunk-OB7EIG6I.js";import"./chunk-CBYWE4ZS.js";import{a as Ke,c as Vt,d as zt,g as it,h as Kt,i as Qt}from"./chunk-YNP5EQNA.js";import"./chunk-TGTCJHHS.js";import"./chunk-PQ3PMTLX.js";import{c as Zt,p as io}from"./chunk-AHWM6USP.js";import"./chunk-DFIMOBBJ.js";import"./chunk-RD5QD7MH.js";import"./chunk-6IJDRLPZ.js";import"./chunk-PO23PKFU.js";import"./chunk-HVTJXLNW.js";import"./chunk-ESXBSF3B.js";import{T as bt,ja as St}from"./chunk-PNY3TA7V.js";import"./chunk-4AVGLJGA.js";import"./chunk-TQ3GWPOH.js";import"./chunk-PYZXP3W4.js";import"./chunk-QDNQKTGP.js";import"./chunk-3QF6VHEM.js";import"./chunk-BDM2VHZE.js";import{a as Xe}from"./chunk-64SQYTOJ.js";import"./chunk-FYP53U2P.js";import"./chunk-Z4OLA6VU.js";import"./chunk-5O3SURTC.js";import{m as Qe}from"./chunk-NMBDO6HS.js";import"./chunk-55MCSU6E.js";import{l as Pt}from"./chunk-OHGMAD4C.js";import"./chunk-OPNT5XFL.js";import"./chunk-MDLQ46WE.js";import{a as Ze}from"./chunk-FQEN5BEF.js";import"./chunk-KRXFQR7K.js";import{a as ye}from"./chunk-CE23KTLV.js";import"./chunk-ZL32ASCM.js";import"./chunk-3TUBCZ6Z.js";import"./chunk-5RWJB7PM.js";import{a as Xt}from"./chunk-UOK5DCVS.js";import"./chunk-O4AMPUEN.js";import{o as Jt,q as st}from"./chunk-AACZ2HW4.js";import"./chunk-M2U4YLEL.js";import"./chunk-ZBGU2467.js";import{o as Ce}from"./chunk-DD3BDKUM.js";import{K as qt,Ta as jt,Ua as ze,bc as at}from"./chunk-TYUTKD3A.js";import"./chunk-ENPA2E7U.js";import{R as Ht,V as Ut,_ as nt,aa as Yt,d as Dt,m as Ve,y as Rt,z as Wt}from"./chunk-WOHVJ5VI.js";import"./chunk-HXEPH4TB.js";import{a as Dr}from"./chunk-F7IOPQEO.js";import{a as Y,b as pe}from"./chunk-QBSBGD35.js";import{e as $t,h as Le}from"./chunk-GFKCYZVW.js";import"./chunk-CHLBHCPL.js";import{La as ge,Pa as Ot,ra as Bt,sa as vr}from"./chunk-NC7RXVWZ.js";import{d as Gt,f as Or}from"./chunk-DM24NLHH.js";import"./chunk-PTVNLPKV.js";import"./chunk-JFKXAMRK.js";import"./chunk-V2SICOMY.js";import"./chunk-Z6Y7MSRE.js";import{c as I}from"./chunk-FVQK2MNN.js";import"./chunk-5Z5B37ND.js";import{Ac as vt,Gb as It,Ib as le,Jb as Ue,Lb as wt,Nb as Z,Ob as Ye,Oc as Lr,Pb as Be,Uc as Lt,V as Se,Vb as kt,Wc as Mr,Xa as Et,Xc as Mt,Ya as ot,Yc as Gr,fc as xe,jc as Nt,oc as Br,vb as Sr,w as re,y as br}from"./chunk-QWQGBYOY.js";import"./chunk-BUAMOL6H.js";import{H as U,c as $,o as Ft,q as rt,r as je}from"./chunk-PLHFXPVU.js";import{K as Pe,a as Ct,b as yt,o as ht,pa as He}from"./chunk-5BQQ5BTM.js";import{N as R,l as be,w as m}from"./chunk-4IQZG47E.js";import"./chunk-BKLQOL2X.js";import"./chunk-AJ3QZWYK.js";import"./chunk-4USCG7JU.js";import"./chunk-4LMFCZAJ.js";import"./chunk-GBWBODBO.js";import{H as At,T as qe,ca as ve}from"./chunk-X62Q7VCJ.js";import"./chunk-X7RY3AWM.js";import{a as M}from"./chunk-WQYVBC56.js";import"./chunk-MX777P4Z.js";import"./chunk-GW6IXZ75.js";import"./chunk-LSOIOGAP.js";import"./chunk-54ZU3WOZ.js";import"./chunk-E4IUBLG2.js";import"./chunk-GMY3CGN4.js";import"./chunk-J52BXABX.js";import"./chunk-FBMAZNAP.js";import"./chunk-H3AZE3V6.js";import"./chunk-7PMBWAQJ.js";import"./chunk-Z37CYTXG.js";import"./chunk-ADNFNM5R.js";import"./chunk-ZP73ZDSP.js";import"./chunk-W3TSI3ZZ.js";import"./chunk-JSF2EI74.js";import"./chunk-56JXL4SQ.js";import"./chunk-METSMHFB.js";import{f as y,m as c,o as l}from"./chunk-CS4SUKWE.js";c();l();var se=y(M());br();c();l();var Ge=y(M()),Vo=y(at()),zo=y(Dr()),Ko=y(Ce());c();l();He();var Rr=e=>{let t=W(e?.chainId),r=e?.image;return Ct(r)?e.image=r[0]:yt(r)&&(e.image=null),{token:e,baseCoin:t}},Yo=Rr;c();l();var qo=y(at()),lt=y(Ce());R();Ot();var Wr=(e={},t={},r=!0)=>{let o=(0,qo.useDispatch)(),i=e.address,s=Xe(),p=Go(),a=ne(),d=(0,lt.useMemoizedFn)(async()=>{a({all_confirmation:"cancel",trade:"add_token"}),await p(i,!1),await ge(o)}),{loading:n,onClick:u}=J(d),T={actionType:P.ACTION_TYPE.CANCEL,btnText:m("wallet_dapp_connection_btn_reject"),onClick:u,loading:n},f=(0,lt.useMemoizedFn)(async()=>{try{a({all_confirmation:"confirm",trade:"add_token"});let h=await Ke(t.localType,s),E={...e,contractAddress:i,blockChain:h.shortName,localType:t.localType};await ro(E),await p(i,!0),await ge(o)}catch(h){U.error(h?.data?.originalError?.msg||m("wallet_extenshion_toast_add_failed"))}}),{loading:_,onClick:x}=J(f),g={actionType:P.ACTION_TYPE.CONFIRM,disabled:!r,onClick:x,loading:_};return[T,g]},jo=Wr;var Hr=({unapproved:e})=>{let t=(0,Vo.useSelector)(to),{token:r,baseCoin:o}=Yo(e),[i,s]=(0,Ge.useState)(!0),p=Xe();(0,Ko.useMount)(async()=>{let d=await Ke(o.localType,p);s(!!d)});let a=jo(r,o,i);return!r||t!==eo.addToken?Ge.default.createElement(zo.Redirect,{to:Xt}):Ge.default.createElement(Mo,{token:r,supported:i,buttonGroup:a,networkName:o.chainName})},Qo=Hr;c();l();var b=y(M()),or=y(Ce());R();c();l();var Xo=y(M());He();xe();var Ur=({unapproved:e,walletAccount:t,customGasInfo:r={}})=>{let{params:o}=e,{walletId:i}=t,s=W(),{coinId:p}=s,a=To(p,i)?.coinAmountInt,{gasType:d,isNetworkFeeLoading:n,networkFee:u,getLimit:T}=r,{minGasFee:f}=lo(r),_=po(r),x=(0,Xo.useMemo)(()=>{if(Pe(a))return o;let A=a,N=[];return o.forEach(G=>{A=Ue(A,u),Z(A,0)&&N.push(G)}),N},[a,o,u]),g=n&&Be(T,0),h={level:d||Ut.STANDARD,loading:n,coinId:s?.coinId,networkFee:g?void 0:f,maxNetworkFee:g?void 0:u,estimateFailed:_},E=n||x.length&&x.length===o.length,k=Pe(a)||Ye(a,u);return{isNetworkFeeLoading:n,estimateFailed:_,networkFeeProps:h,canApproveTxs:x,isSufficientGas:k,canApproveAll:E}},Zo=Ur;c();l();var Jo=y(M());R();Br();Lr();Sr();Gr();Mr();xe();var $o=100,Yr=e=>e.msg||m("wallet_home_toast_network_error"),qr=({txParams:e,gasLimit:t,supportEip1559:r})=>({...e,value:Y(e.value),gas:t,gasPrice:Y(r?e.maxFeePerGas:e.gasPrice),priorityFee:Y(r?e.maxPriorityFeePerGas:0),nonce:Y(e.nonce),repeatTxType:Dt.CONFIRMING,oldTxHash:"",inscriptionType:1}),jr=({ext:e,signature:t,coinId:r,txParams:o,fromAdr:i,toAdr:s,networkFee:p,txHash:a,walletId:d,walletAccount:n})=>({extJson:JSON.stringify(e),signedTx:t,coinId:r,coinAmount:Y(o.value||0),fromAdr:i,toAdr:s,serviceCharge:p,txHash:a,txSource:vt.DAPP,inputData:o.data,accountId:d,txType:1,walletType:n?.serverWalletType}),Vr=({unapproved:e,walletAccount:t,isSufficientGas:r,canApproveTxs:o,customGasInfo:i,isNetworkFeeLoading:s})=>{let{id:p}=e,{walletId:a,address:d}=t,n=Qe(a),u=ne(a),{coinId:T}=W(),f=vo(),_=Bo(),x=(0,Jo.useCallback)(async()=>{u({trade:"sendEvmInscriptions",all_confirmation:"cancel"}),await f({id:p})},[f,u,p]),{loading:g,onClick:h}=J(x),E={loading:g,onClick:h,actionType:P.ACTION_TYPE.CANCEL,btnText:m("wallet_dapp_connection_btn_reject")},k=n||s,{gasPrice:A,supportEip1559:N,gasLimitInfo:G={},gasLimit:O,maxFeePerGas:D,maxPriorityFeePerGas:q,networkFee:L}=i,V=co({fromAddr:o[0]?.txParams?.from,walletId:a,localType:ot}),me=async()=>{try{let Q=o.length,de=o[0],{from:Ne,to:_e,value:Ae}=de.txParams;if(u({trade:"sendEvmInscriptions",all_confirmation:"confirm"}),!await he({callback:x,walletId:a}))return;let{data:j}=await qt({checkTypes:[nt.OVERWRITTEN],coinId:T,from:Ne,to:_e,amount:Y(Ae||0),gasPrice:A}),Fe=j.find(({checkType:Te})=>Te===nt.OVERWRITTEN)||{},{newNonce:Er,toastType:Ir,pendingNum:wr}=Fe;if(Ir===Yt.FAILED){U.error(m("wallet_extension_function_toast_failed_single")),await mt(1500),await f({id:p});return}let dt=le(wr,Q);if(Z(dt,$o)){U.error(m("wallet_extension_function_toast_pending",{TotalNum:dt,ExceededNum:$o}));return}let _t=[],Tt=[];for(let Te=0;Te<o.length;Te++){let We=o[Te],{txParams:v}=We,{from:kr,to:Nr}=v;v.nonce=Nt(pe(le(Er,Te))),N?(delete We.gasPrice,v.maxFeePerGas=pe(D),v.maxPriorityFeePerGas=pe(q),v.type=Ve.FEE_MARKET):(delete v.maxFeePerGas,delete v.maxPriorityFeePerGas,delete v.type,v.gasPrice=pe(A)),v.gas=pe(O),v.gasLimit=pe(O),v.gasLimitInfo=G,v.gasType=i.gasType;let Ar=oo(We.txParams),xt=await V({params:Ar}),gt=await so(ot,xt),Fr=qr({txParams:v,gasLimit:O,supportEip1559:N}),Pr=jr({ext:Fr,signature:xt,coinId:T,txParams:v,fromAdr:kr,toAdr:Nr,networkFee:L,txHash:gt,walletId:a,walletAccount:t});Tt.push(Pr),_t.push({id:We.id,txHash:gt})}await Lt(Mt.postSendEvmInscriptions,{txList:Tt}),await _({id:p,result:_t})}catch(Q){U.error(Yr(Q)),await mt(1500),await _({id:p,error:"Failed"})}},{loading:ce,onClick:z}=J(me),K={loading:ce,disabled:k,actionType:P.ACTION_TYPE.CONFIRM,onClick:z};return k?[E,K]:(r||(K={actionType:P.ACTION_TYPE.FILL_UP,txId:p,coinId:T,walletId:a,address:d,receiveOnly:r}),[E,K])},er=Vr;c();l();R();var zr=e=>{for(let t=0;t<e.length;t++){let r=e[t],o=r();if(o)return o}return null},Kr=({walletAccount:e,canApproveTxs:t,canApproveAll:r,isSufficientGas:o})=>{let i=Qe(e.walletId),s=()=>i?{type:$.TYPE.error,message:m("wallet_extension_function_alert_wallet_unsupported")}:null,p=W(),a=No({baseCoin:p,isSufficientGas:o});return zr([s,a,()=>r?null:{type:$.TYPE.warn,message:m("wallet_extension_function_alert_available_balance",{gasToken:p.symbol,num:t.length})}])},tr=Kr;var Qr=({unapproved:e})=>{let{coinId:t}=W(),{txParams:r={}}=e?.params?.[0],{from:o,to:i,data:s,value:p}=r,{walletId:a}=e,d=wo(e),n=ne(a),u=Je(e),[T,f]=(0,b.useState)({}),_=(0,b.useCallback)(q=>{f(q)},[]),{networkFeeProps:x,canApproveTxs:g,canApproveAll:h,isSufficientGas:E,isNetworkFeeLoading:k}=Zo({unapproved:e,walletAccount:d,customGasInfo:T}),A=er({unapproved:e,walletAccount:d,canApproveTxs:g,customGasInfo:T,isSufficientGas:E,isNetworkFeeLoading:k}),N=tr({walletAccount:d,canApproveTxs:g,canApproveAll:h,isSufficientGas:E}),[G,{setTrue:O,setFalse:D}]=(0,or.useBoolean)(!1);return b.default.createElement(I.Container,null,b.default.createElement(Ze,{title:m("wallet_extension_function_title_bulk_signing"),closeable:!1,backable:!1}),b.default.createElement(ee,null,b.default.createElement(Ao,{...u})),b.default.createElement(ee,null,b.default.createElement($e,{onClick:O,...x})),b.default.createElement(ee,{bordered:!1},b.default.createElement(Me,{title:m("wallet_extension_network_address_title_walletused"),address:d.address,walletId:d.walletId,onCopyCallback:()=>{n({trade:"sendEvmInscriptions",all_confirmation:"wallet_used_address"})}})),b.default.createElement(ye,{placeholder:!0,offsetBottom:0,borderTop:!0},b.default.createElement(Ee,{...N}),b.default.createElement(P,{buttonGroup:A})),b.default.createElement(uo,{visible:G,coinId:t,address:o,inputData:s,tokenAddress:i,value:Y(p),onBack:D,onClose:null,onGasChange:_}))},rr=Qr;c();l();var oe=y(M());Et();xe();c();l();var pr=y(M()),De=y(at()),Oe=y(Ce());R();Ot();vr();c();l();var H=y(M());c();l();Or();var we=()=>(0,H.useCallback)(async(t,r)=>{await Gt().updateReportTimestamp(t,r)},[]);var Xr=()=>{let e=we();return(0,H.useCallback)(async r=>{await e(r,"CAN_CONFIRM")},[e])},nr=(e,t)=>{let r=Xr(),o=(0,H.useRef)(!1);(0,H.useEffect)(()=>{!t&&!o.current&&(o.current=!0,r(e))},[e,t,r])},ir=()=>{let e=we();return(0,H.useCallback)(async r=>{await e(r,"CLICK_CONFIRM")},[e])},ar=()=>{let e=we();return(0,H.useCallback)(async t=>{await e(t,"SIGN")},[e])},sr=()=>{let e=we();return(0,H.useCallback)(async t=>{await e(t,"START_PUBLISH")},[e])},mr=()=>{let e=we();return(0,H.useCallback)(async t=>{await e(t,"FINISH_PUBLISH")},[e])},cr=()=>{let e=we();return(0,H.useCallback)(async t=>{await e(t,"END_REQUEST")},[e])};c();l();He();var lr=({isMev:e,mevInfo:t,unapproved:r,modifiedData:o,customGasInfo:i,updateData:s,gasReturnActivity:p})=>{let{nonce:a,updateGasInfo:d}=s,n=ht(r);n.txParams=n.params,delete n.params;let{supportEip1559:u,gasLimitInfo:T={},gasLimit:f,maxFeePerGas:_,gasPrice:x,maxPriorityFeePerGas:g}=i;if(o&&n.txParams&&(n.txParams.data=o),n.txParams.supportEip1559=u,u?(delete n?.txParams.gasPrice,n.txParams.maxFeePerGas=te(_),n.txParams.maxPriorityFeePerGas=te(g),n.txParams.type=Ve.FEE_MARKET):(delete n?.txParams.maxFeePerGas,delete n?.txParams.maxPriorityFeePerGas,delete n?.txParams.type,n.txParams.gasPrice=te(x)),d){let h=Object.entries(d).reduce((E,[k,A])=>(E[k]=te(A),E),{});n.txParams={...n.txParams,...h}}return n.txParams.gas=te(f),n.txParams.gasLimit=te(f),n.txParams.nonce=te(a),n.txParams.chainId=te(n.chainId),n.gasLimitInfo=T||{},n.mev=e?t.name:"",n.activityId=p?.activityId,n.gasType=i.gasType,n?.txParams?.data||(n.isBaseCoinTransfer=!0),n};var Zr=(e,t)=>{let r=(0,De.useSelector)(i=>zt(i,e)),o=(0,De.useSelector)(i=>Vt(i,e)??t??!1);return{mevInfo:r,isMev:o}},$r=({extParams:e,walletId:t,from:r,to:o})=>(0,Oe.useMemoizedFn)(i=>{if(e.targetConnectType===Po.OKX_CONNECT){let s=i;i===Rt&&(s="sdk-error"),Bt(`evm_tx_failed-${s}`,{to:o},{tags:{walletId:t,from:r}})}}),Jr=({unapproved:e})=>{let{id:t,params:r={},extParams:o={},chainId:i}=e,s=(0,De.useDispatch)(),p=W(i),a=Je(e),{from:d,to:n,value:u}=r,{coinId:T,chainName:f}=p,{walletId:_}=tt(e.origin,d)||{},{isMev:x,mevInfo:g}=Zr(t,o?.isMev),h=ir(),E=ar(),k=sr(),A=mr(),N=cr(),G=(0,Oe.useMemoizedFn)((ce,z)=>{s(it.setIsMev({isMev:ce,id:t})),s(it.setMevInfo({mevInfo:z,id:t}))});nr();let O=ne(_),D=fo({walletId:_,fromAddr:d,coinId:T}),q=(0,Oe.useMemoizedFn)(async()=>{O({trade:"contract_interaction",all_confirmation:"cancel",network:f,dapp_url:e.origin}),bt(),await s(Kt(t)),await ge(s)}),L=_o(),V=$r({extParams:o,walletId:_,from:d,to:n}),me=(0,Oe.useMemoizedFn)(async({modifiedData:ce,customGasInfo:z,gasReturnActivity:K,reportGasReturnActivityDataInConfirm:Q})=>{let{gasPrice:de}=z;if(h(t),await he({callback:q,walletId:_})){O({all_confirmation:"confirm",trade:"contract_interaction",network:f,dapp_url:e.origin});let _e=Y(u||0),Ae=await L({to:n,from:d,coinId:T,gasPrice:de,userGasInfo:z,amount:_e,baseCoinAmountUse:_e});Q();try{let X=lr({isMev:x,mevInfo:g,unapproved:e,updateData:Ae,modifiedData:ce,customGasInfo:z,gasReturnActivity:K});E(t);let j=await D(X.txParams);k(t);let Fe=await s(Qt(t,{...X,signedTx:j,walletId:_,coinId:T},{failTxWhenError:!1}));A(t),ct(Fe?.code)?(K?.clear(),U.error({title:Fe?.msg||m("wallet_home_toast_network_error"),duration:3})):(Pt({tx_id:Fe?.serverTxId}),N(t))}catch(X){let j=X?.data?.originalError;ct(j?.code)?(K?.clear(),U.error({title:j?.msg||m("wallet_home_toast_network_error"),duration:3})):X?.message===Wt?U.error(m("wallet_extension_tg_error_network")):U.error(m("wallet_home_toast_network_error")),V(X?.message)}await ge(s)}});return pr.default.createElement(Io,{needMev:!0,coinId:T,openMev:x,onConfirmReplace:!0,dappInfo:a,txParams:r,txType:e?.type,walletId:_,isShowBlockSwapMevTooltip:o?.isShowBlockSwapMevTooltip,onMevChange:G,onCancel:q,onConfirm:me})},pt=Jr;c();l();var F=y(M());R();xe();c();l();var fe=y(M()),ut=y(At());He();R();xe();c();l();var ke={RpcEvmSendEditNonce:"_RpcEvmSendEditNonce_1jypd_1",rpcEvmSendEditNonce:"_RpcEvmSendEditNonce_1jypd_1",content:"_content_1jypd_1",inner:"_inner_1jypd_5","rpc-evm-send-edit-nonce__warning-input":"_rpc-evm-send-edit-nonce__warning-input_1jypd_5",rpcEvmSendEditNonceWarningInput:"_rpc-evm-send-edit-nonce__warning-input_1jypd_5",warningText:"_warningText_1jypd_9",icon:"_icon_1jypd_13"};function en({nonce:e,suggestedNonce:t,setNonce:r}){let o=s=>{r(s)},i;return e&&(Z(e,t)?i=m("developer_mode_send_tooltip_higher",{num:t}):wt(e,t)&&(i=m("developer_mode_send_tooltip_lower",{num:t}))),fe.default.createElement(So.Row,{className:ke.RpcEvmSendEditNonce,noMargin:!0,noPadding:!0},fe.default.createElement("div",{className:ke.content},fe.default.createElement("div",{className:ke.inner},fe.default.createElement(rt.Number,{innerClassName:(0,ut.default)({"rpc-evm-send-edit-nonce__warning-input":!!i}),withOperation:!0,alwaysOperation:!0,enableMinus:!1,title:m("developer_mode_send_maintitle_nonce"),placeholder:`${Pe(t)?"":be.thousandFormat(t)}`,size:rt.SIZE.xl,value:e,onAdd:()=>!e&&t!==null?(o(le(t,1)),!1):!0,onSub:()=>!e&&Z(t,0)?(o(Ue(t-1)),!1):!0,onChange:o})),i&&fe.default.createElement("div",{className:ke.warningText},fe.default.createElement(qe,{className:(0,ut.default)(ke.icon,"okx-wallet-plugin-warning-circle")}),i)))}var ur=en;c();l();var ie=y(M());R();c();l();var C=y(M()),Re=y(Ce()),fr=y(At());R();c();l();var S={root:"_root_424m3_1",icon:"_icon_424m3_1",editApproveAmountModal:"_editApproveAmountModal_424m3_10",content:"_content_424m3_22",editArea:"_editArea_424m3_25",unlimitedText:"_unlimitedText_424m3_30",unlimitedSymbol:"_unlimitedSymbol_424m3_39",symbolClassName:"_symbolClassName_424m3_45",quickHandler:"_quickHandler_424m3_48",balanceWrap:"_balanceWrap_424m3_55",balance:"_balance_424m3_55",maxBalance:"_maxBalance_424m3_68",maxDisabled:"_maxDisabled_424m3_76",unlimited:"_unlimited_424m3_30",text:"_text_424m3_84",authQuantityWarnTip:"_authQuantityWarnTip_424m3_91",danger:"_danger_424m3_98",info:"_info_424m3_101",approveTip:"_approveTip_424m3_104",footerActions:"_footerActions_424m3_112"};var tn=e=>{typeof e!="string"&&(e=e.toString());let t=e?.length;return t<=9?36:t>=10&&t<12?32:t===12?30:t>=13&&t<=15?24:t>=16&&t<=18?20:t>=19&&t<=24?16:12},on=({txTypeInfo:e,approve:t,onUpdateAuthAmount:r})=>{let{tokenInfo:o,amount:i}=t||{},{decimals:s,symbol:p}=o,a=ue(p,12),[d,n]=(0,C.useState)(!1),[u,{toggle:T,setFalse:f,setTrue:_}]=(0,Re.useBoolean)(!1),[x,g]=(0,C.useState)(0),h=(0,C.useMemo)(()=>u?{type:S.danger,text:m("wallet_extension_approve_alert_high_risk_unlimited")}:!u&&be.eq(x||0,0)?{type:S.info,text:m("wallet_extension_approve_cannot_zero")}:null,[u,x]),E=(0,Re.useMemoizedFn)((N=i)=>{ze(N)?(g(0),_()):(g(Co(N,s)),f()),n(!0)}),k=(0,C.useMemo)(()=>u?!1:!be.gt(`${x||0}`,0),[u,x]),A=(0,Re.useMemoizedFn)(()=>{n(!1);let N=u?jt:yo(x,s);r(N)});return C.default.createElement(I.Box,{className:S.root},C.default.createElement(I.Box,{className:S.icon,onClick:()=>{E()}},C.default.createElement(qe,{className:"okx-wallet-plugin-draw-20"})),C.default.createElement(Ft.Action,{hideCloseBtn:!0,noContentPadding:!0,visible:d},C.default.createElement(I.Box,{className:S.editApproveAmountModal},C.default.createElement(I.Box,{className:S.content},C.default.createElement(Ie,{txTypeInfo:e,bordered:!1}),C.default.createElement(I.Box,{className:S.editArea},u?C.default.createElement(st.Text,{className:S.unlimitedText},m("wallet_extension_transfer_title_unlimited_amount",{token:C.default.createElement(st.Text,{className:S.unlimitedSymbol},a)})):C.default.createElement(mo,{symbol:a,autoSize:tn,placeholder:"0",decimals:s,value:x,onChange:g,style:{fontWeight:700,height:"42px"},symbolClassName:S.symbolClassName})),C.default.createElement(I.Box,{className:S.quickHandler},C.default.createElement(I.Box,{onClick:T,className:S.unlimited},C.default.createElement(I.Box,{className:S.text},m("wallet_extension_transfer_dialog_checkbox_set_to_unlimited")),C.default.createElement(je,{checked:u}))),!!h&&C.default.createElement(I.Box,{className:(0,fr.default)(S.authQuantityWarnTip,h.type)},h.text)),C.default.createElement(I.Box,{className:S.approveTip},m("wallet_extension_approve_desc_dapp_right")),C.default.createElement(ye,{affixStyle:{position:"none"},placeholder:!1,className:S.footerActions},C.default.createElement(ve,{block:!0,disabled:k,category:ve.CATEGORY.fill,type:ve.TYPE.primary,size:ve.SIZE.lg,onClick:A},m("wallet_extension_approve_btn_amount_confirmation"))))))},dr=on;var rn=({onUpdateAuthAmount:e,dappInfo:t,loading:r,approveToken:o,title:i})=>{let{isApprove:s,isRevoke:p,address:a,customApproveAmount:d=0,symbol:n=Le,decimals:u=0,icon:T=$t}=o,f=ue(n,12);if(r)return ie.default.createElement(Fo,null);if(s){let _={title:{text:i},subTitle:t.host};if(p){let g={image:{light:"/cdn/assets/imgs/2411/55679A63BA670217.png",dark:"/cdn/assets/imgs/2411/E42714B599040ADC.png"},..._};return ie.default.createElement(Ie,{txTypeInfo:{baseInfo:g}},ie.default.createElement(ho,{imageUrl:T,text:f}))}let x={image:{light:"/cdn/assets/imgs/2411/EF6FBB80F8021B76.png",dark:"/cdn/assets/imgs/2411/E457296ACFFE1EA9.png"},..._};return ie.default.createElement(Ie,{txTypeInfo:{baseInfo:x}},ie.default.createElement(Eo,{approveInfoList:[{amount:d,canEditAmount:!0,autoOpen:!1,tokenInfo:{address:a,decimals:u,symbol:n}}],renderEditApproveAmount:g=>ie.default.createElement(dr,{txTypeInfo:{baseInfo:x},approve:g,onUpdateAuthAmount:e})}))}return ie.default.createElement(Ie,{txTypeInfo:{baseInfo:{image:{light:"/cdn/assets/imgs/2411/E917E86725EBEB35.png",dark:"/cdn/assets/imgs/2411/3B767A859A18470E.png"},title:{text:m("wallet_extension_transaction_page_title_unknown_transaction")},subTitle:t.host}}})},_r=rn;c();l();R();var nn=({chainGasLoadFailed:e,isSufficientBalance:t,transaction:r,actions:o,modifiedDataError:i,walletInfo:s,params:p,rpcInfo:a})=>{let{chain:d,nonce:n,loading:u,gas:T}=r,{sign:f,cancel:_}=o,{chainGasLoading:x}=T,{loading:g,onClick:h}=J(_),E={actionType:P.ACTION_TYPE.CANCEL,onClick:h,loading:g},k=async()=>{try{if(!await he({walletId:s?.walletId,callback:_}))return}catch(L){console.error(L)}let q=L=>{let V=Zt[s?.keyringIdentityType];St({tx_source:"dapp",from_addr:p.from,to_addr:p.to,main_token_symbol:a?.symbol,token_symbol:L?.extraParams?.coinSymbol||"",contract_address:p?.to,volume_token:p?.value,volume_usdt:"",tx_hash_unique:L?.txHash,wallet_type:V,chain_id:parseInt(d.chainId,16)})};f(s?.walletId,q,a)},A=()=>{globalThis.open(a.faucetUrl)},N=x||e||!t&&!a?.faucetUrl||n.pending||u.sign||u.token||i,{loading:G,onClick:O}=J(k),D={disabled:N,actionType:P.ACTION_TYPE.CONFIRM,onClick:O,loading:G};return!t&&a?.faucetUrl&&(D.actionType=P.ACTION_TYPE.FILL_UP,D.onClick=A,D.btnText=m("wallet_extension_transfer_btn_via_faucet")),[E,D]},Tr=nn;c();l();R();xe();var an=({customGasInfo:e})=>()=>e?.baseFeePerGas==="0"?{type:$.TYPE.warn,message:m("wallet_extension_transaction_error_base_zero")}:null,sn=({modifiedDataError:e})=>()=>e?{}:null,mn=({isSufficientBalance:e,chain:t})=>()=>e?null:{type:$.TYPE.warn,message:m("wallet_extension_popup_insufficient_network_fee",{token:t.symbol})},cn=({chainGasLoadFailed:e})=>()=>e?{type:Ee.TIP_TYPE.FEE_ERROR}:null,ln=({auth:e,contract:t,asset:r})=>()=>ze(e.customApproveAmount)?{type:$.TYPE.warn,message:m("wallet_extension_popup_unlimited_transfer",{contract:t,asset:r})}:Z(e.customApproveAmount,0)?{type:$.TYPE.warn,message:m("extension_approve_alert_authorized_tips",{contract:t,asset:r})}:null,pn=({customGasInfo:e,chainGasLoadFailed:t,modifiedDataError:r,isSufficientBalance:o,isRevokeTx:i,transaction:s,loading:p})=>{let{auth:a,chain:d}=s,n=ue(a.name||Le),u=ue(a.symbol||Le),T=an({customGasInfo:e}),f=sn({modifiedDataError:r}),_=mn({isSufficientBalance:o,chain:d}),x=cn({chainGasLoadFailed:t}),g=()=>i?{type:$.TYPE.info,message:m("extension_revoke_approval_alert_evoke_authorization",{contract:n,asset:u})}:null,h=ln({auth:a,contract:n,asset:u});if(p)return null;let E=[f,_,g,h,x,T];for(let k=0;k<E.length;k++){let A=E[k],N=A();if(N)return N}return null},xr=pn;var ft=({unapproved:e,rpcInfo:t})=>{let{origin:r,params:o}=e,{from:i,value:s,to:p}=o,[a,d]=(0,F.useState)(""),[n,u]=(0,F.useState)(!1),T=go(a),f=tt(r,i),[_,x]=Lo({...o,...e,walletId:f?.walletId},t),{title:g,auth:h,meta:E,nonce:k,gas:A,loading:N,data:G}=_,{setNonce:O,setAuthAmount:D}=x,{chainGasInfo:q,customGasInfo:L,chainGasLoading:V,chainGasLoadFailed:me,stopPollingGasPrice:ce,updateCustomGasInfo:z,chainGasLimitLoadFailed:K}=A,Q=io(void 0,void 0,t),de=Ro(L);bo(t),Wo(i,t),Uo();let Ne=Ye(Q?.balance,le(de,kt(s||0))),_e=xr({customGasInfo:L,chainGasLoadFailed:me,isSufficientBalance:Ne,isRevokeTx:h.isRevoke,modifiedDataError:T,transaction:_,loading:V}),Ae=Tr({chainGasLoadFailed:me,isSufficientBalance:Ne,transaction:_,actions:x,modifiedDataError:T,walletInfo:f,params:o,rpcInfo:t}),X=j=>{z(j),u(!1)};return F.default.createElement(I.Container,null,F.default.createElement(_r,{title:g,confirmBuryPointFn:()=>{},onUpdateAuthAmount:j=>{D(j)},dappInfo:E.originInfo,loading:N.token,approveToken:h}),F.default.createElement(ee,null,F.default.createElement($e,{onClick:()=>{u(!0)},injectCoin:Q,loading:V,estimateFailed:me,networkFee:V?void 0:It(de,10**Q?.decimals)})),F.default.createElement(ee,null,F.default.createElement(Me,{title:m("wallet_extension_network_address_title_walletused"),address:f.address,walletId:f.walletId}),!!p&&F.default.createElement(Me,{title:m("wallet_extension_popup_text_interact_with"),address:p})),F.default.createElement(ur,{nonce:k.custom,suggestedNonce:k.suggested,setNonce:O}),G?F.default.createElement(ee,{bordered:!1},F.default.createElement(ko,{data:G,copyable:{hideDesc:!0}})):F.default.createElement(ee,{bordered:!1},F.default.createElement(xo,{value:a,error:T,onChange:d})),F.default.createElement(ye,{placeholder:!0,offsetBottom:0,borderTop:!0},!T&&F.default.createElement(Ee,{..._e}),F.default.createElement(P,{buttonGroup:Ae})),n?F.default.createElement(Ho,{onBack:()=>{u(!1)},rpcInfo:t,chainGasInfo:q,customGasInfo:L,updateCustomGasInfo:X,stopPollingGasPrice:ce,chainGasLimitLoadFailed:K}):null)};c();l();var B=y(M()),Cr=y(Ce());R();Et();c();l();var ae={root:"_root_184nf_1",main:"_main_184nf_5",tips:"_tips_184nf_10",list:"_list_184nf_16",item:"_item_184nf_16",title:"_title_184nf_22",footer:"_footer_184nf_29"};var gr={uniqueId:Se,rpcUrl:m("wallet_extension_rpc_title_official")},un=({targetRpcChain:e,targetMainChain:t,handleSelect:r})=>{let[o,i]=(0,B.useState)({}),s=[...e],p=!!t.length;p&&s.unshift(gr);let[a,d]=(0,B.useState)(!1),{updateRpcNetwork:n}=et(),u=(0,B.useCallback)(async()=>{try{d(!0);let f=e.find(_=>!!_.isDefaultRpc);if(o.isDefaultRpc||o.uniqueId===Se&&!f)return;f&&await n({...f,isDefaultRpc:!1}),await n({...o,isDefaultRpc:!0})}catch(f){console.log(f)}finally{d(!1)}},[o,e,n]),T=(0,B.useCallback)(async()=>{await u(),r(o)},[o,r,u]);return(0,Cr.useMount)(()=>{let f=e.find(_=>_.isDefaultRpc);f?i(f):p&&i(gr)}),B.default.createElement(I.FlexBox,{className:ae.root,direction:I.DIRECTION.vertical},B.default.createElement(Ze,{backable:!1,closeable:!1,title:m("wallet_extension_rpc_title_select_rpc")}),B.default.createElement(I.Box,{className:ae.main},B.default.createElement(I.Box,{className:ae.tips},m("wallet_extension_rpc_desc_select_rpc_current")),B.default.createElement(I.Box,{className:ae.list},s.map(f=>B.default.createElement(I.Box,{className:ae.item,onClick:()=>{i(f)}},B.default.createElement(Jt,{ellipsis:!0,className:ae.title},f.rpcUrl),B.default.createElement(je.Circle,{checked:f.uniqueId===o.uniqueId}))))),B.default.createElement(I.Box,{className:ae.footer},B.default.createElement(P,{buttonGroup:[{loading:a,disabled:!o.uniqueId,actionType:P.ACTION_TYPE.CONFIRM,onClick:T}]})))},yr=un;var fn=e=>{let{unapproved:t}=e,{rpcNetworks:r,status:o}=et(),i=ao({appBaseChain:"ethereum"})||[],s=i.filter(n=>Be(n.realChainIdHex,t.chainId)),p=r.filter(n=>Be(n.chainId,t.chainId)),[a,d]=(0,oe.useState)(null);return o==="loading"||!i?.length?oe.default.createElement(no,null):s.length+p.length>1?a?a.uniqueId===Se?oe.default.createElement(pt,{...e}):oe.default.createElement(ft,{...e,rpcInfo:a}):oe.default.createElement(yr,{networkType:t.networkType,targetRpcChain:p,targetMainChain:s,handleSelect:d}):s.length?oe.default.createElement(pt,{...e}):oe.default.createElement(ft,{...e,rpcInfo:p[0]})},hr=fn;var ac=(0,se.memo)(({unapproved:e})=>{switch(e.method){case Ht.SEND_EVM_INSCRIPTIONS:return se.default.createElement(rr,{unapproved:e});default:break}switch(e.type){case re.ETH_SIGN:case re.PERSONAL_SIGN:case re.ETH_SIGN_TYPED_DATA:case re.ETH_GET_ENCRYPTION_PUBLIC_KEY:case re.ETH_DECRYPT:return se.default.createElement(Oo,{unapproved:e});case re.WATCH_ASSET:return se.default.createElement(Qo,{unapproved:e});case re.ADD_ETHEREUM_CHAIN:return se.default.createElement(Do,{unapproved:e});default:return se.default.createElement(hr,{unapproved:e})}});export{ac as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=Ethereum-PGP7GWYI.js.map
